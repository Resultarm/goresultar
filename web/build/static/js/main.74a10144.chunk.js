(this["webpackJsonpgerenciador-react-app"]=this["webpackJsonpgerenciador-react-app"]||[]).push([[0],{387:function(e,t,a){e.exports={logoWrapper:"styles_logoWrapper__2ifFw"}},458:function(e,t,a){},460:function(e,t,a){},636:function(e,t,a){},652:function(e,t,a){},748:function(e,t,a){},754:function(e,t,a){},765:function(e,t,a){},770:function(e,t,a){},771:function(e,t,a){},772:function(e,t,a){},781:function(e,t,a){},782:function(e,t,a){},784:function(e,t,a){},790:function(e,t,a){},791:function(e,t,a){},800:function(e,t,a){},801:function(e,t,a){},802:function(e,t,a){},803:function(e,t,a){},804:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),l=a(35),c=a.n(l),o=(a(458),a(459),a(460),a(136)),i=a(383),u=a(385),s=a(187);o.a.use(i.a).use(u.a).use(s.e).init({fallbackLng:"en",debug:!1,interpolation:{escapeValue:!1},react:{wait:!0},initImmediate:!1}),window.__=o.a.t.bind(o.a);var m=a(5),d=a(3),p=a(39),E=a(838),f=a(442),v=a(387),g=a.n(v),b=function(){return r.a.createElement(E.a,{as:"h2",color:"grey",className:g.a.logoWrapper},r.a.createElement(f.a,{circular:!0,src:"http://s1.iconbird.com/ico/2013/9/440/w128h1281380212086box.png"})," ","Gerenciador")},h=a(833),y=a(8),C=a.n(y),O=a(17),j=a(398),S=a.n(j),I=a(825),w=a(841),x=a(303),k=function(e){var t=e.onSubmit,a=Object(n.useState)(""),l=Object(d.a)(a,2),c=l[0],o=l[1],i=Object(n.useState)(""),u=Object(d.a)(i,2),s=u[0],m=u[1],p=Object(n.useState)(!0),E=Object(d.a)(p,2),f=E[0],v=E[1],g=Object(n.useState)(!0),b=Object(d.a)(g,2),h=b[0],y=b[1],j=function(){var e=Object(O.a)(C.a.mark((function e(){return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(f&&h){e.next=3;break}return e.abrupt("return");case 3:t({email:c,password:s});case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return r.a.createElement(I.a,{name:"loginForm",size:"large",onSubmit:j},r.a.createElement(w.a,null,r.a.createElement(I.a.Input,{fluid:!0,icon:"at",iconPosition:"left",placeholder:"Email",type:"email",error:!f,onChange:function(e){return t=e.target.value,o(t),void v(!0);var t},onBlur:function(){return v(S.a.isEmail(c))}}),r.a.createElement(I.a.Input,{fluid:!0,icon:"lock",iconPosition:"left",placeholder:"Password",type:"password",error:!h,onChange:function(e){return t=e.target.value,m(t),void y(!0);var t},onBlur:function(){return y(Boolean(s))}}),r.a.createElement(x.a,{type:"submit",color:"teal",fluid:!0,size:"large",primary:!0},"Login")))},N=r.a.createContext(void 0),T=r.a.createContext(void 0),P=a(19),D=a(20),R=function(){function e(t,a){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,l=arguments.length>4?arguments[4]:void 0,c=arguments.length>5&&void 0!==arguments[5]&&arguments[5],o=arguments.length>6&&void 0!==arguments[6]&&arguments[6],i=arguments.length>7?arguments[7]:void 0,u=arguments.length>8&&void 0!==arguments[8]&&arguments[8];Object(P.a)(this,e),this.code=t,this.message=a,this.statusCode=n,this.hasData=o,this.responseTime=r,this.requestId=l,this.cached=c,this.token=i,this.errorCaught=u}return Object(D.a)(e,[{key:"isInit",get:function(){return"INIT"===this.code}},{key:"isLoading",get:function(){return"LOADING"===this.code}},{key:"isError",get:function(){return this.errorCaught=!0,"ERROR"===this.code}},{key:"isSuccess",get:function(){return"SUCCESS"===this.code}},{key:"clone",value:function(t,a,n,r,l,c,o,i,u){return new e(void 0===t?this.code:t,void 0===a?this.message:a,void 0===n?this.statusCode:n,void 0===o?this.hasData:o,void 0===r?this.responseTime:r,void 0===l?this.requestId:l,void 0===c?this.cached:c,void 0===i?this.token:i,void 0===u?this.errorCaught:u)}},{key:"toString",value:function(){return this.code}}]),e}(),A="\n",F="\t";function L(){return([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,(function(e){return(e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16)}))}var V={headers:{Accept:"application/json","Content-Type":"application/json"}};function z(e,t){var a=Object(n.useContext)(N),r=Object(n.useState)((function(){return["",!1]})),l=Object(d.a)(r,2),c=Object(d.a)(l[0],2),o=c[0],i=c[1],u=l[1],s=Object(n.useState)([void 0,new R("INIT")]),p=Object(d.a)(s,2),E=p[0],f=p[1],v=Object(n.useCallback)((function(){return u([L(),!0])}),[]);return Object(n.useEffect)((function(){e&&u([L(),!1])}),[e,t]),Object(n.useEffect)((function(){if(e&&o){var n=new AbortController;f((function(e){return[void 0,Object(d.a)(e,2)[1].clone("LOADING")]}));var r=performance.now(),l=Object(m.a)(Object(m.a)(Object(m.a)({},V),t),{},{headers:Object(m.a)(Object(m.a)(Object(m.a)(Object(m.a)({Authorization:"Bearer "+localStorage.getItem("token")},V.headers),null===t||void 0===t?void 0:t.headers),i&&{"X-Clear-Cache":!0}),{},{"X-Request-ID":o},a&&{OrganizationID:a})});return null===l.headers["Content-Type"]&&delete l.headers["Content-Type"],fetch(e,l).then(function(){var t=Object(O.a)(C.a.mark((function t(a){var l,c,i,u,s,m,p,E;return C.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!n.signal.aborted){t.next=2;break}return t.abrupt("return");case 2:return l=performance.now()-r,c=!!a.headers.get("X-Browser-Cache"),i=a.headers.get("X-Token"),t.prev=5,t.next=8,a.json();case 8:u=t.sent,t.next=17;break;case 11:return t.prev=11,t.t0=t.catch(5),s="Invalid JSON response from API",console.error("".concat(A,"API Error:").concat(A).concat(F,"URL: ").concat(e).concat(A).concat(F,"Msg: ").concat(s).concat(A).concat(F,"Code: ").concat(a.status)),f((function(e){return[void 0,Object(d.a)(e,2)[1].clone("ERROR",s,a.status,l,o,c)]})),t.abrupt("return");case 17:if(!(a.status>=400)){t.next=22;break}return m=u.error||u.message||"",console.log("message :>> ",m),f((function(e){var t=Object(d.a)(e,2)[1];console.log("s :>> ",t);var n=t.clone("ERROR",m,a.status,l,o,c,!1,i);return console.log("cloned :>> ",n),[void 0,t.clone("ERROR",m,a.status,l,o,c,!1,i)]})),t.abrupt("return");case 22:p=null===(v=u)?"Null":void 0===v?"Undefined":"string"===typeof v?"String":"number"!==typeof v||Number.isNaN(v)?Number.isNaN(v)?"NaN":"boolean"===typeof v?"Boolean":v instanceof Array?"Array":v instanceof Object?"Object":"":"Number",E="Null"!==p&&("Array"!==p||u.length>0),f((function(e){var t=Object(d.a)(e,2)[1];return[u,t.clone("SUCCESS","",a.status,l,o,c,E,i)]}));case 25:case"end":return t.stop()}var v}),t,null,[[5,11]])})));return function(e){return t.apply(this,arguments)}}()).catch((function(t){if(!n.signal.aborted){var a=performance.now()-r;console.error("".concat(A,"API Error:").concat(A).concat(F,"URL: ").concat(e).concat(A).concat(F,"Msg: ").concat(t.message).concat(A).concat(F,"Code: 0")),f((function(e){return[void 0,Object(d.a)(e,2)[1].clone("ERROR","",0,a,o)]}))}})),function(){return n.abort()}}}),[o]),[E[0],E[1],v]}function M(e,t){var a=Object(n.useContext)(N);return z(e,Object(n.useMemo)((function(){return Object(m.a)(Object(m.a)({},t),{},{headers:Object(m.a)({OrganizationID:a||""},null===t||void 0===t?void 0:t.headers)})}),[t,a]))}var B=a(10),H=a(0),_=H.useMemo,U=H.useState,q={SUCCESS:function(e,t){return"".concat(e," ").concat(t).concat(t.endsWith("e")?"":"e","d successfully!")},ERROR:function(e,t){return"failed to ".concat(t," ").concat(e)}};var Y=function(){var e=U([]),t=Object(d.a)(e,2),a=Object(d.a)(t[0],3),n=a[0],r=a[1],l=a[2],c=t[1],o=_((function(){return"add"===l&&r?["/api/products",{method:"POST",body:JSON.stringify(r)}]:"update"===l&&n&&r?["/api/products/".concat(n),{method:"PUT",body:JSON.stringify(r)}]:"delete"===l&&n?["/api/products/".concat(n),{method:"DELETE"}]:"status change"===l&&r&&n?["/api/v2/products/".concat(n,"/status"),{method:"POST",body:JSON.stringify(r)}]:[void 0,void 0]}),[r,l,n]),i=M.apply(void 0,Object(B.a)(o)),u=Object(d.a)(i,2)[1];return l&&(u.action=l,u.message=q[u.code]?q[u.code]("product",l)+": ".concat(u.message):""),{add:function(e){return c([void 0,e,"add"])},edit:function(e,t){return c([e,t,"update"])},save:function(e,t){return c([t,e,t?"update":"add"])},del:function(e){return c([e,void 0,"delete"])},reset:function(){return c([])},changeStatus:function(e,t){return c([e,t,"status change"])},status:u}},J=a(6),G=a(24),W=a.n(G);function K(e,t,a){return"undefined"===typeof e||null===e?a:0===t.length?e:K(e[t.shift()],t,a)}var X={string:"",number:0,date:""};function Q(e,t){if(void 0===e||null===e)return!1;var a=t.trim();return!a||("string"===typeof e?e:JSON.stringify(e)).toLowerCase().includes(a.toLowerCase().toString())}function $(e,t,a){return a?"*"===t?e.filter((function(e){return Q(e,a)})):e.filter((function(e){return t.some((function(t){return Q(K(e,t.split("."),""),a)}))})):e}var Z=10,ee={searchText:"",currentPage:1,sort:{by:void 0,direction:void 0},predicate:void 0,values:{}},te=function(e,t){return function(a,n){var r=function(e,t){var a="function"===typeof e?e:function(a){return K(a,e.split("."),X[t])};switch(t){case"string":return function(e,t){return a(e).localeCompare(a(t))};case"number":return function(e,t){return a(e)-a(t)};case"date":return function(e,t){return W()(a(e)).diff(W()(a(t)))};default:return function(e,t){return 0}}}(e,typeof a[e]);return"descending"===t?r(n,a):r(a,n)}},ae={data:[],pageCount:0,total:0};var ne=function(e,t,a){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},l=arguments.length>4?arguments[4]:void 0,c=Object(n.useState)(l?Object(m.a)(Object(m.a)({},ee),{},{values:r,filterer:l}):ee),o=Object(d.a)(c,2),i=o[0],u=o[1],s=M(e),p=Object(d.a)(s,3),E=p[0],f=(E=void 0===E?ae:E).data,v=E.total,g=p[1],b=p[2],h=function(e){return u((function(t){return Object(m.a)(Object(m.a)({},t),{},{searchText:e,currentPage:1,sort:{by:void 0,direction:void 0}})}))},y=function(e){return u((function(t){return Object(m.a)(Object(m.a)({},t),{},{currentPage:e})}))},C=function(e,t){return u((function(a){return Object(m.a)(Object(m.a)({},a),{},{currentPage:1,sort:{by:e,direction:t}})}))},O=function(e){return u((function(t){return Object(m.a)(Object(m.a)({},t),{},{predicate:e})}))},j=Object(n.useMemo)((function(){var e={},t=function(t){Object.prototype.hasOwnProperty.call(i.values,t)&&(e[t]=function(e){return u((function(a){return Object(m.a)(Object(m.a)({},a),{},{values:Object(m.a)(Object(m.a)({},a.values),{},Object(J.a)({},t,e))})}))})};for(var a in i.values)t(a);return e}),[i.values]),S=Object(n.useMemo)((function(){return a?f.map(a):f}),[a,f]),I=Object(n.useMemo)((function(){return i.filterer?S.filter(i.filterer(i.values)):i.predicate?S.filter(i.predicate):S}),[S,i]),w=Object(n.useMemo)((function(){return $(I,t,i.searchText)}),[I,t,i.searchText]),x=Object(n.useMemo)((function(){return i.sort.by?Object(B.a)(w.sort(te(i.sort.by,i.sort.direction))):w}),[w,i.sort.by,i.sort.direction]),k=Object(n.useMemo)((function(){return x.slice((i.currentPage-1)*Z,i.currentPage*Z)}),[x,i.currentPage]);return Object(n.useEffect)((function(){f.length>0&&u(l?Object(m.a)(Object(m.a)({},ee),{},{filterer:l,values:r}):ee)}),[f,l]),[k,{total:v,pages:Math.ceil(w.length/Z),all:x},h,y,C,Object(m.a)(Object(m.a)({},i),{},{setPredicate:O,handlers:j}),g,b]};var re=function(e,t,a,n,r){var l=ne(e,t,a,n,r),c=Object(d.a)(l,8),o=c[0],i=c[1];return{data:o,total:i.total,pages:i.pages,all:i.all,search:c[2],goto:c[3],sort:c[4],filters:c[5],status:c[6],refresh:c[7]}};var le=function(e,t,a){var n=new URLSearchParams(e);return n.append("showAll","true"),re("/api/v2/products?".concat(n.toString()),"*",void 0,t,a)};var ce=function(){var e=M("/api/clients"),t=Object(d.a)(e,3),a=t[0],n=(a=void 0===a?{data:[]}:a).data,r=t[1],l=t[2];return{options:n.map((function(e){var t=e._id,a=e.firstName,n=e.lastName;return{value:t,label:"".concat(a," ").concat(n)}})),status:r,refresh:l}},oe=a(0),ie=oe.useMemo,ue=oe.useState,se={SUCCESS:function(e,t){return"".concat(e," ").concat(t).concat(t.endsWith("e")?"":"e","d successfully!")},ERROR:function(e,t){return"failed to ".concat(t," ").concat(e)}};var me=function(){var e=ue([]),t=Object(d.a)(e,2),a=Object(d.a)(t[0],3),n=a[0],r=a[1],l=a[2],c=t[1],o=ie((function(){return"create"===l&&r?["/api/orders",{method:"POST",body:JSON.stringify(r)}]:"update"===l&&n&&r?["/api/v2/orders/".concat(n),{method:"PUT",body:JSON.stringify(r)}]:"delete"===l&&n?["/api/orders/".concat(n),{method:"DELETE"}]:"status change"===l&&r&&n?["/api/orders/".concat(n,"/status"),{method:"POST",body:JSON.stringify(r)}]:[void 0,void 0]}),[r,l,n]),i=M.apply(void 0,Object(B.a)(o)),u=Object(d.a)(i,2)[1];return l&&(u.action=l,u.message=se[u.code]?se[u.code]("order",l)+": ".concat(u.message):""),{add:function(e){return c([void 0,e,"create"])},edit:function(e,t){return c([e,t,"update"])},save:function(e,t){return c([e,t,e?"update":"create"])},del:function(e){return c([e,void 0,"delete"])},reset:function(){return c([])},changeStatus:function(e,t){return c([e,t,"status change"])},status:u}};var de=function(e){var t=new URLSearchParams(e);return t.append("showAll","true"),re("/api/v2/tasks?".concat(t.toString()),"*")},pe=a(399),Ee=["None","New","Preparation","Production","Quality","Finishing","Completed","Delivered | Returned","Concluded","Canceled"],fe=["None","Open","Partial","Closed","Quotation"],ve={1:"Open",2:"Partial",3:"Closed",4:"Quotation"};var ge=function(e){var t=Object(pe.a)(["translation"]).t,a=Object(n.useCallback)((function(e){return Object(m.a)(Object(m.a)({},e),{},{_processStatus:t(Ee[e.processStatus]),_status:t(ve[e.status])})}),[t]),r=new URLSearchParams(e);return r.append("showAll","true"),re("/api/orders?".concat(r.toString()),"*",a)};var be=function(e){var t=new URLSearchParams(e);return t.append("showAll","true"),re("/api/expenses?".concat(t.toString()),"*")},he=a(0),ye=he.useMemo,Ce=he.useState,Oe={SUCCESS:function(e,t){return"".concat(e," ").concat(t).concat(t.endsWith("e")?"":"e","d successfully!")},ERROR:function(e,t){return"failed to ".concat(t," ").concat(e)}};var je=function(e){var t=Ce([]),a=Object(d.a)(t,2),n=Object(d.a)(a[0],3),r=n[0],l=n[1],c=n[2],o=a[1],i=ye((function(){return"create"===c&&l?["/api/v2/tasks",{method:"POST",body:JSON.stringify(l)}]:"update"===c&&r&&l?["/api/v2/tasks/".concat(r),{method:"PUT",body:JSON.stringify(l)}]:"delete"===c&&r?["/api/v2/tasks/".concat(r),{method:"DELETE"}]:"status change"===c&&l&&r?["/api/v2/tasks/".concat(r,"/status"),{method:"POST",body:JSON.stringify(l)}]:[void 0,void 0]}),[l,c,r]),u=M(e?"/api/v2/tasks/".concat(e):void 0),s=Object(d.a)(u,2),m=s[0],p=(m=void 0===m?{}:m).data,E=s[1],f=M.apply(void 0,Object(B.a)(i)),v=Object(d.a)(f,2)[1];return c&&(v.action=c,v.message=Oe[v.code]?Oe[v.code]("task",c)+": ".concat(v.message):""),{data:p,add:function(e){return o([void 0,e,"create"])},edit:function(e,t){return o([e,t,"update"])},save:function(e,t){return o([e,t,e?"update":"create"])},del:function(e){return o([e,void 0,"delete"])},reset:function(){return o([])},changeStatus:function(e,t){return o([e,t,"status change"])},status:v,getStatus:E}},Se=a(0),Ie=Se.useMemo,we=Se.useState,xe={SUCCESS:function(e,t){return"".concat(e," ").concat(t).concat(t.endsWith("e")?"":"e","d successfully!")},ERROR:function(e,t){return"failed to ".concat(t," ").concat(e)}};var ke=function(){var e=we([]),t=Object(d.a)(e,2),a=Object(d.a)(t[0],3),n=a[0],r=a[1],l=a[2],c=t[1],o=Ie((function(){return"create"===l&&r?["/api/orgs",{method:"POST",body:JSON.stringify(r)}]:"update"===l&&n&&r?["/api/orgs/".concat(n),{method:"PUT",body:JSON.stringify(r)}]:"delete"===l&&n?["/api/orgs/".concat(n),{method:"DELETE"}]:[void 0,void 0]}),[r,l,n]),i=M.apply(void 0,Object(B.a)(o)),u=Object(d.a)(i,2)[1];return l&&(u.action=l,u.message=xe[u.code]?xe[u.code]("task",l)+": ".concat(u.message):""),{add:function(e){return c([void 0,e,"create"])},edit:function(e,t){return c([e,t,"update"])},save:function(e,t){return c([e,t,e?"update":"create"])},del:function(e){return c([e,void 0,"delete"])},reset:function(){return c([])},status:u}};var Ne=function(e){var t=M("/api/admins"),a=Object(d.a)(t,2),n=a[0],r=(n=void 0===n?{data:[]}:n).data,l=a[1];return{data:r.filter((function(t){var a=t.organizationIds,n=t.roleNumber;return(!e||a.includes(e))&&3===n})).map((function(e){var t=e._id,a=e.firstName,n=e.lastName;return{value:t,label:"".concat(a," ").concat(n)}})),status:l}};var Te=function(){return re("/api/categories?showAll=true","*")};var Pe=function(){var e=Object(pe.a)(["translation"]).t,t=M("/api/v2/products/statuses"),a=Object(d.a)(t,2),n=a[0],r=a[1];return{data:(n||[]).map((function(t){return{value:t,text:e(t)}})),status:r}};var De=function(){return re("/api/departments?showAll=true","*")};var Re=function(){return re("/api/brands?showAll=true","*")};var Ae=function(){return re("/api/subcategories?showAll=true","*")},Fe={SUCCESS:function(e,t){return"".concat(e," ").concat(t).concat(t.endsWith("e")?"":"e","d successfully!")},ERROR:function(e,t){return"failed to ".concat(t," ").concat(e)}};var Le=function(e){var t=Object(n.useState)([]),a=Object(d.a)(t,2),r=Object(d.a)(a[0],3),l=r[0],c=r[1],o=r[2],i=a[1],u=Object(n.useMemo)((function(){return"create"===o&&c?["/api/v2/brands",{method:"POST",body:JSON.stringify(c)}]:"update"===o&&l&&c?["/api/brands/".concat(l),{method:"PUT",body:JSON.stringify(c)}]:"delete"===o&&l?["/api/brands/".concat(l),{method:"DELETE"}]:[void 0,void 0]}),[c,o,l]),s=M(e?"/api/brands/".concat(e):void 0),m=Object(d.a)(s,2),p=m[0],E=(p=void 0===p?{}:p).data,f=m[1];console.log("opts :>> ",u);var v=M.apply(void 0,Object(B.a)(u)),g=Object(d.a)(v,2)[1];return o&&(g.action=o,g.message=Fe[g.code]?Fe[g.code]("brand",o)+": ".concat(g.message):""),{data:E,add:function(e){return i([void 0,e,"create"])},edit:function(e,t){return i([e,t,"update"])},save:function(e,t){return i([e,t,e?"update":"create"])},del:function(e){return i([e,void 0,"delete"])},reset:function(){return i([])},status:g,getStatus:f}};var Ve=function(){var e=De(),t=e.all,a=e.status;return{options:t.map((function(e){var t=e._id,a=e.title;return{value:t,text:a,label:a,organizationId:e.organizationId}})),status:a}};var ze=function(){return re("/api/models?showAll=true","*")},Me={SUCCESS:function(e,t){return"".concat(e," ").concat(t).concat(t.endsWith("e")?"":"e","d successfully!")},ERROR:function(e,t){return"failed to ".concat(t," ").concat(e)}};var Be=function(e){var t=Object(n.useState)([]),a=Object(d.a)(t,2),r=Object(d.a)(a[0],3),l=r[0],c=r[1],o=r[2],i=a[1],u=Object(n.useMemo)((function(){return"create"===o&&c?["/api/v2/departments",{method:"POST",body:JSON.stringify(c)}]:"update"===o&&l&&c?["/api/v2/departments/".concat(l),{method:"PUT",body:JSON.stringify(c)}]:"delete"===o&&l?["/api/departments/".concat(l),{method:"DELETE"}]:[void 0,void 0]}),[c,o,l]),s=M(e?"/api/tasks/".concat(e):void 0),m=Object(d.a)(s,2),p=m[0],E=(p=void 0===p?{}:p).data,f=m[1],v=M.apply(void 0,Object(B.a)(u)),g=Object(d.a)(v,2)[1];return o&&(g.action=o,g.message=Me[g.code]?Me[g.code]("department",o)+": ".concat(g.message):""),{data:E,add:function(e){return i([void 0,e,"create"])},edit:function(e,t){return i([e,t,"update"])},save:function(e,t){return i([t,e,t?"update":"create"])},del:function(e){return i([e,void 0,"delete"])},reset:function(){return i([])},status:g,getStatus:f}};var He=function(){var e=Object(n.useState)(),t=Object(d.a)(e,2),a=t[0],r=t[1],l=Object(n.useMemo)((function(){return[a?"/api/v2/auth/login":void 0,a?{method:"POST",body:JSON.stringify(a)}:void 0]}),[a]),c=M.apply(void 0,Object(B.a)(l)),o=Object(d.a)(c,2);return{data:o[0],login:r,status:o[1]}};var _e=function(){return re("/api/clients?showAll=true","*")},Ue={SUCCESS:function(e,t){return"".concat(e," ").concat(t).concat(t.endsWith("e")?"":"e","d successfully!")},ERROR:function(e,t){return"failed to ".concat(t," ").concat(e)}};var qe=function(e){var t=Object(n.useState)([]),a=Object(d.a)(t,2),r=Object(d.a)(a[0],3),l=r[0],c=r[1],o=r[2],i=a[1],u=Object(n.useMemo)((function(){return"create"===o&&c?["/api/v2/clients",{method:"POST",body:JSON.stringify(c)}]:"update"===o&&l&&c?["/api/clients/".concat(l),{method:"PUT",body:JSON.stringify(c)}]:"delete"===o&&l?["/api/clients/".concat(l),{method:"DELETE"}]:[void 0,void 0]}),[c,o,l]),s=M(e?"/api/clients/".concat(e):void 0),m=Object(d.a)(s,2),p=m[0],E=(p=void 0===p?{}:p).data,f=m[1],v=M.apply(void 0,Object(B.a)(u)),g=Object(d.a)(v,2),b=g[0],h=(b=void 0===b?{}:b)._id,y=g[1];return o&&(y.action=o,y.message=Ue[y.code]?Ue[y.code]("client",o)+": ".concat(y.message):""),{insertedId:h,data:E,add:function(e){return i([void 0,e,"create"])},edit:function(e,t){return i([e,t,"update"])},save:function(e,t){return i([t,e,t?"update":"create"])},del:function(e){return i([e,void 0,"delete"])},reset:function(){return i([])},status:y,getStatus:f}};var Ye=function(){return M("/api/v2/roles")},Je=a(0),Ge=Je.useMemo,We=Je.useState,Ke={SUCCESS:function(e,t){return"".concat(e," ").concat(t).concat(t.endsWith("e")?"":"e","d successfully!")},ERROR:function(e,t){return"failed to ".concat(t," ").concat(e)}};var Xe=function(){var e=We([]),t=Object(d.a)(e,2),a=Object(d.a)(t[0],3),n=a[0],r=a[1],l=a[2],c=t[1],o=Ge((function(){return"add"===l&&r?["/api/v2/products",{method:"POST",body:JSON.stringify(r)}]:"update"===l&&n&&r?["/api/v2/products/".concat(n),{method:"PUT",body:JSON.stringify(r)}]:"delete"===l&&n?["/api/products/".concat(n),{method:"DELETE"}]:"status change"===l&&r&&n?["/api/v2/products/".concat(n,"/status"),{method:"POST",body:JSON.stringify(r)}]:[void 0,void 0]}),[r,l,n]),i=M.apply(void 0,Object(B.a)(o)),u=Object(d.a)(i,2)[1];return l&&(u.action=l,u.message=Ke[u.code]?Ke[u.code]("product",l)+": ".concat(u.message):""),{add:function(e){return c([void 0,e,"add"])},edit:function(e,t){return c([e,t,"update"])},save:function(e,t){return c([t,e,t?"update":"add"])},del:function(e){return c([e,void 0,"delete"])},reset:function(){return c([])},changeStatus:function(e,t){return c([e,t,"status change"])},status:u}},Qe=a(0),$e=Qe.useMemo,Ze=Qe.useState;var et=function(){var e=Ze(),t=Object(d.a)(e,2),a=t[0],n=t[1],r=$e((function(){return a?["/api/v2/orders/".concat(a,"/to-order"),{method:"POST"}]:[void 0,void 0]}),[a]),l=M.apply(void 0,Object(B.a)(r));return{status:Object(d.a)(l,2)[1],convert:n}};var tt={headers:{OrganizationID:""}};function at(e){var t=function(){var e=M("/api/cheques"),t=Object(d.a)(e,3),a=t[0];return[(a=void 0===a?{data:[]}:a).data,t[1],t[2]]}(),a=Object(d.a)(t,3),n=a[0],r=a[1],l=a[2];return[n.filter((function(t){return"new"===t.status&&(!e||t.organizationId===e)})),r,l]}function nt(e){var t=M("/api/categories"),a=Object(d.a)(t,3),n=a[0],r=(n=void 0===n?{data:[]}:n).data,l=a[1],c=a[2];return[r.filter((function(t){return!e||t.organizationId===e})).map((function(e){return{value:e._id,text:e.title,departmentId:e.departmentId}})),l,c]}function rt(e){var t=M("/api/subcategories"),a=Object(d.a)(t,3),n=a[0],r=(n=void 0===n?{data:[]}:n).data,l=a[1],c=a[2];return[r.filter((function(t){return!e||t.organizationId===e})).map((function(e){return{value:e._id,text:e.title,categoryId:e.categoryId}})),l,c]}function lt(){var e=M("/api/admins"),t=Object(d.a)(e,3),a=t[0],n=(a=void 0===a?{data:[]}:a).data,r=t[1],l=t[2];return{options:n.filter((function(e){return 5===e.roleNumber})).map((function(e){var t=e._id,a=e.name;return{value:t,text:a,label:a}})),status:r,refresh:l}}a(636);var ct=a(441),ot=function(e){var t=e.onLogin,a=Object(n.useContext)(T).token,l=He(),c=l.data,o=(c=void 0===c?{}:c).token,i=l.login,u=l.status;return Object(n.useEffect)((function(){u.isSuccess?t(o):u.isError&&ct.b.error(u.message||"failed to login")}),[u,o,t]),Object(n.useEffect)((function(){a&&Object(p.d)("/")}),[a]),r.a.createElement("div",{style:{height:"100%"}},r.a.createElement("div",{className:"login-container"},r.a.createElement("div",{style:{maxWidth:"90%",margin:"10% auto auto auto",width:400}},r.a.createElement(b,null),r.a.createElement(E.a,{as:"h2",color:"teal",textAlign:"center"},"Acessar Sua Conta"),r.a.createElement(k,{onSubmit:i}),r.a.createElement(h.a,null,"Encontrou algum problema?"," ",r.a.createElement(p.a,{exact:!0,to:"/registration"},"Fale com o suporte"))),r.a.createElement("div",{className:"aside"},r.a.createElement("div",{style:{backgroundImage:'url("/login-cover-bg.jpg")',backgroundRepeat:"no-repeat",backgroundSize:"cover",height:"100%"}},r.a.createElement("div",{class:"text-right",style:{padding:16}},r.a.createElement("h2",null,"GR")),r.a.createElement("div",{class:"ant-row ant-row-center"},r.a.createElement("div",{class:"ant-col ant-col-xs-0 ant-col-sm-0 ant-col-md-0 ant-col-lg-20"},r.a.createElement("img",{class:"img-fluid mb-5",style:{maxWidth:"100%",marginBottom:32},src:"/login-cover.png",alt:""}),r.a.createElement("h1",{class:"text-white",style:{fontWeight:"bold"}},"Bem vindo ao GR"))),r.a.createElement("div",{style:{display:"flex",justifyContent:"flex-end",padding:32}},r.a.createElement("a",{class:"text-white",href:"/#"},"Termo & Condi\xe7\xf5es"),r.a.createElement("span",{class:"text-white",style:{margin:"0 8px"}}," ","|"," "),r.a.createElement("a",{class:"text-white",href:"/#"},"Privacidade & Pol\xedtica"))))))},it=a(839),ut=a(815),st=function(){return r.a.createElement(it.a,{active:!0,inverted:!0},r.a.createElement(ut.a,{size:"massive",inverted:!0}))},mt=(a(652),a(814)),dt=a(829),pt=a(97),Et=a(845),ft=a(251),vt=a(400);function gt(e){return e.endpoint+(e.query?"?".concat(vt.stringify(e.query)):"")}function bt(e){var t={};e.attachment||(t["Content-Type"]="application/json",t.Accept="application/json"),(null===e||void 0===e?void 0:e.organizationId)&&(t.OrganizationID=e.organizationId||"");var a,n=localStorage.getItem("token");if(n&&!e.skipAuthorization&&(t.Authorization="Bearer ".concat(n)),e.attachment){if("GET"===e.type)throw new Error("GET request does not support attachments.");var r=new FormData;r.append("file",e.attachment),a=r}else if(e.request){if("GET"===e.type)throw new Error("GET request does not support request body.");a=JSON.stringify(e.request)}return Object(m.a)({method:e.type,headers:t,signal:e.ct},"GET"===e.request?{}:{body:a})}function ht(e){return yt.apply(this,arguments)}function yt(){return(yt=Object(O.a)(C.a.mark((function e(t){var a;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.ok){e.next=12;break}return 401===t.status&&localStorage.removeItem("token"),a="Something went wrong with request!",e.prev=3,e.next=6,t.json();case 6:a=e.sent,e.next=11;break;case 9:e.prev=9,e.t0=e.catch(3);case 11:throw a;case 12:case"end":return e.stop()}}),e,null,[[3,9]])})))).apply(this,arguments)}function Ct(e){return Ot.apply(this,arguments)}function Ot(){return(Ot=Object(O.a)(C.a.mark((function e(t){var a;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(gt(t),bt(t));case 2:return a=e.sent,e.next=5,ht(a);case 5:return e.abrupt("return",a);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var jt=function(){var e=Object(O.a)(C.a.mark((function e(t){var a;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ct({endpoint:"/api/products/".concat(t),type:"GET"});case 2:return a=e.sent,e.abrupt("return",a.json());case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),St=function(){var e=Object(O.a)(C.a.mark((function e(t){var a;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ct({endpoint:"/api/products/".concat(t),type:"DELETE"});case 2:return a=e.sent,e.abrupt("return",a.json());case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),It=function(){var e=Object(O.a)(C.a.mark((function e(t,a){var n;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ct({endpoint:"/api/products/".concat(t,"/images/").concat(a),type:"DELETE"});case 2:return n=e.sent,e.abrupt("return",n.json());case 4:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),wt=function(e){var t=e.title,a=e.id,l=e.addToast,c=e.loadProducts,o=Object(n.useState)(!1),i=Object(d.a)(o,2),u=i[0],s=i[1],m=function(){s(!u)};return r.a.createElement(ft.a,{trigger:r.a.createElement(x.a,{className:"table-action-btn",onClick:m},r.a.createElement(pt.a,{name:"trash"})),open:u,closeIcon:!0},r.a.createElement(ft.a.Header,null,"Delete a product"),r.a.createElement(ft.a.Content,null,r.a.createElement("h4",null,"Are you sure you want to delete product ",'"'.concat(t,'"'),"?"),r.a.createElement(x.a,{color:"red",inverted:!0,onClick:function(){St(a).then((function(e){l("Produto deleted successfully",{appearance:"success"})})).catch((function(e){""!==e.message?l("Could not delete product: "+e.message,{appearance:"error"}):l("Something went wrong",{appearance:"error"})})).finally((function(){m(),c()}))}},r.a.createElement(pt.a,{name:"remove"})," Delete"),r.a.createElement(x.a,{color:"blue",inverted:!0,onClick:m},r.a.createElement(pt.a,{name:"checkmark"})," Cancel")))},xt=function(e){return Number(e).toLocaleString("pt-BR")},kt=function(e){return e?W()(1e3*e).format("DD/MM/YYYY"):"-"};function Nt(e){var t=e.style,a=e.alert,n=e.children;return r.a.createElement("span",{style:Object(m.a)(Object(m.a)({},a&&{backgroundColor:a?"yellow":"none",fontWeight:"bold",padding:4}),t)},a?"\u26a0\ufe0f  ":"",n)}var Tt=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];switch(t){case 1:return r.a.createElement(Nt,{alert:a,style:{color:"green"}},e("Open"));case 2:return r.a.createElement(Nt,{alert:a,style:{color:"orange"}},e("Partial"));case 3:return r.a.createElement(Nt,{alert:a,style:{color:"blue"}},e("Closed"));case 4:return r.a.createElement(Nt,{alert:a,style:{color:"violet"}},e("Quotation"));default:return r.a.createElement("p",null,e("Unknown"))}},Pt=new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}),Dt=a(828),Rt=a(816);var At=function(e){var t=e.onChange,a=e.options,l=e.defaultValue,c=e.children,o=e.color,i=e.size,u=e.basic,s=Object(pe.a)(["translation"]).t,m=Object(n.useRef)(),p=Object(n.useState)(void 0),E=Object(d.a)(p,2),f=E[0],v=E[1],g=Object(n.useState)({value:l}),b=Object(d.a)(g,2),h=b[0],y=h.value,C=h.comment,O=b[1];return Object(n.useEffect)((function(){m.current?t(void 0,{value:y,comment:C}):m.current=!0}),[y]),r.a.createElement(r.a.Fragment,null,r.a.createElement(Dt.a,{options:a,onChange:function(e,t){var a=t.options.find((function(e){return e.value===t.value}));a.confirm||a.confirmWithComment?v(a):O({value:t.value})},value:y,icon:"",trigger:r.a.createElement(x.a.Group,{color:o,size:i,basic:u},r.a.createElement(x.a,{style:{width:80}},c),r.a.createElement(x.a,{icon:"dropdown"}))}),(null===f||void 0===f?void 0:f.confirm)&&r.a.createElement(Rt.a,{open:!0,content:"".concat(s("Are you sure you want to")," ").concat(f.text," ?"),onCancel:function(){return v(void 0)},onConfirm:function(){t(void 0,{value:f.value,comment:C}),v(void 0)},cancelButton:s("No"),confirmButton:s("Yes")}),(null===f||void 0===f?void 0:f.confirmWithComment)&&r.a.createElement(ft.a,{closeIcon:!0,open:!0,onClose:function(){return v(void 0)}},r.a.createElement(ft.a.Header,null,s("Comment")),r.a.createElement(ft.a.Content,null,r.a.createElement(I.a,{onSubmit:function(e,t){O({value:f.value,comment:e.target.elements.comment.value})}},r.a.createElement(I.a.TextArea,{name:"comment",label:s("Comment"),maxLength:50,required:!0}),r.a.createElement("div",{style:{display:"flex",justifyContent:"flex-end"}},r.a.createElement(x.a,{type:"submit",primary:!0},s("Submit")))))))},Ft={Available:"teal","Not Available":void 0,"On Hold":"blue"},Lt=function(e){return!!e},Vt=function(e){var t=e.products,a=e.addToast,n=e.showKitModal,l=e.loadProducts,c=e.setProductToEdit,o=e.onPageChange,i=e.pages,u=e.changeStatus,s=e.filters,m=Object(pe.a)(["translation"]).t,d=Pe().data;return r.a.createElement(dt.a,{celled:!0,style:{marginBottom:30}},r.a.createElement(dt.a.Header,null,r.a.createElement(dt.a.Row,null,r.a.createElement(dt.a.HeaderCell,{colspan:3},m("Actions")),r.a.createElement(dt.a.HeaderCell,null,m("Title")),r.a.createElement(dt.a.HeaderCell,null,m("Description")),r.a.createElement(dt.a.HeaderCell,null,m("Total Units")),r.a.createElement(dt.a.HeaderCell,null,m("Department")),r.a.createElement(dt.a.HeaderCell,null,m("Brand")),r.a.createElement(dt.a.HeaderCell,null,m("Cost")),r.a.createElement(dt.a.HeaderCell,null,m("Price")),r.a.createElement(dt.a.HeaderCell,null,m("Status")))),r.a.createElement(dt.a.Body,null,t.map((function(e){var t,o,i,s;return r.a.createElement(dt.a.Row,{key:e._id},r.a.createElement(dt.a.Cell,null,e.kitProducts.length>0?r.a.createElement(x.a,{className:"table-action-btn",onClick:function(){return n(e)}},r.a.createElement(pt.a,{name:"pencil alternate"})):r.a.createElement(x.a,{className:"table-action-btn",onClick:function(){return c(e)}},r.a.createElement(pt.a,{name:"pencil alternate"}))),r.a.createElement(dt.a.Cell,null,r.a.createElement("a",{href:"/products/view/".concat(e._id)},r.a.createElement(pt.a,{name:"eye "}))),r.a.createElement(dt.a.Cell,null,r.a.createElement(wt,{title:e.title,id:e._id,addToast:a,loadProducts:l})),r.a.createElement(dt.a.Cell,null,e.title),r.a.createElement(dt.a.Cell,null,e.description),e.isService?r.a.createElement(dt.a.Cell,null):r.a.createElement(dt.a.Cell,null,e.totalUnits<=(e.minStockThreshold||0)&&r.a.createElement("span",{style:{fontFamily:"Segoe UI Emoji"}},"\u26a0\ufe0f "),xt(e.totalUnits)),r.a.createElement(dt.a.Cell,null,[e.department.title,null===(t=e.category)||void 0===t?void 0:t.title,null===(o=e.subcategory)||void 0===o?void 0:o.title].filter(Lt).join("/")),r.a.createElement(dt.a.Cell,null,[e.brand.title,null===(i=e.model)||void 0===i?void 0:i.title].filter(Lt).join("/")),r.a.createElement(dt.a.Cell,null,Pt.format(e.cost)),r.a.createElement(dt.a.Cell,null,Pt.format(e.price)),r.a.createElement(dt.a.Cell,null,r.a.createElement(At,{options:d,onChange:(s=e._id,function(e,t){u(s,{status:t.value})}),defaultValue:e.status,color:Ft[e.status],size:"mini",basic:!0},m(e.status))))}))),r.a.createElement(dt.a.Footer,null,r.a.createElement(dt.a.Row,null,r.a.createElement(dt.a.HeaderCell,{colSpan:"20",style:{textAlign:"right"}},r.a.createElement(Et.a,{activePage:s.currentPage,totalPages:i,onPageChange:function(e,t){var a=t.activePage;return o(a)}})))))};Vt.defaultProps={products:[],isLoading:!0};var zt=Vt,Mt=a(827),Bt=a(824),Ht=a(436),_t=a(164),Ut=a(95),qt=a(176),Yt=a(121),Jt=a(836),Gt=a(49),Wt={required:!0},Kt={name:[Wt],status:[Wt],price:[Wt],departmentId:[Wt],categoryId:[Wt],subcategoryId:[Wt],chargeDuration:[Wt]};var Xt=function(e){var t=e.onClose,a=e.okText,l=e.okButtonProps,c=e.afterSave,o=e.initialValue,i=Object(pe.a)(["translation"]).t,u=Y(null===o||void 0===o?void 0:o._id),s=u.save,p=u.status,E=Object(n.useContext)(N),f=Ve(E).options,v=function(e){var t=nt(e),a=Object(d.a)(t,3),n=a[0],r=a[1],l=a[2];return{options:n.map((function(e){return Object(m.a)(Object(m.a)({},e),{},{label:e.text})})),status:r,refresh:l}}(E).options,g=function(e){var t=rt(e),a=Object(d.a)(t,3),n=a[0],r=a[1],l=a[2];return{options:n.map((function(e){return Object(m.a)(Object(m.a)({},e),{},{label:e.text})})),status:r,refresh:l}}(E).options;return Object(n.useEffect)((function(){p.isSuccess&&(t(),c())}),[p,c]),r.a.createElement(Mt.a,{visible:!0,onCancel:t,title:a,onClose:t,okText:a,okButtonProps:Object(m.a)({form:"service-add-modal",htmlType:"submit"},l),width:800},r.a.createElement(Bt.a,{layout:"vertical",id:"service-add-modal",initialValues:o,onFinish:function(e){var t=Object(m.a)({isService:!0},e);s(t,null===o||void 0===o?void 0:o._id)}},r.a.createElement(Bt.a.Item,{label:i("Name"),name:"title",rules:Kt.name},r.a.createElement(Ht.a,null)),r.a.createElement(_t.a,{gutter:16},r.a.createElement(Ut.a,{span:8},r.a.createElement(Bt.a.Item,{label:i("Price"),name:"price",trigger:"onValueChange",getValueFromEvent:function(e){return e.floatValue},rules:Kt.price},r.a.createElement(Gt.a,{customInput:Ht.a,thousandSeparator:".",decimalSeparator:","}))),r.a.createElement(Ut.a,{span:8},r.a.createElement(Bt.a.Item,{label:i("Cost"),name:"cost",trigger:"onValueChange",getValueFromEvent:function(e){return e.floatValue},rules:Kt.cost},r.a.createElement(Gt.a,{customInput:Ht.a,thousandSeparator:".",decimalSeparator:","}))),r.a.createElement(Ut.a,null,r.a.createElement(Bt.a.Item,{name:"chargeDuration",label:"\u2800",rules:Kt.chargeDuration},r.a.createElement(qt.a.Group,null,r.a.createElement(qt.a.Button,{value:"day"},i("Per day")),r.a.createElement(qt.a.Button,{value:"hour"},i("Per hour")),r.a.createElement(qt.a.Button,{value:"fixed"},i("Fixed")))))),r.a.createElement(_t.a,{gutter:16},r.a.createElement(Ut.a,{span:8},r.a.createElement(Bt.a.Item,{label:i("Department"),name:"departmentId",rules:Kt.departmentId},r.a.createElement(Yt.a,{options:f}))),r.a.createElement(Ut.a,{span:8},r.a.createElement(Bt.a.Item,{dependencies:["departmentId"],noStyle:!0},(function(e){var t=e.getFieldValue;return r.a.createElement(Bt.a.Item,{label:i("Category"),name:"categoryId"},r.a.createElement(Yt.a,{options:v.filter((function(e){return e.departmentId===t("departmentId")}))}))}))),r.a.createElement(Ut.a,{span:8},r.a.createElement(Bt.a.Item,{dependencies:["categoryId"],noStyle:!0},(function(e){var t=e.getFieldValue;return r.a.createElement(Bt.a.Item,{label:i("Sub Category"),name:"subcategoryId"},r.a.createElement(Yt.a,{options:g.filter((function(e){var a=e.categoryId;return t("categoryId")===a}))}))})))),r.a.createElement(Bt.a.Item,{label:i("Description"),name:"description",rules:Kt.description},r.a.createElement(Ht.a.TextArea,{rows:4}))),p.isError&&r.a.createElement(Jt.a,{message:p.message,type:"error"}))},Qt=a(61),$t=a(822),Zt=a(843),ea=a(846),ta=a(848),aa=function(){var e=new URLSearchParams(window.location.search);return{from:e.get("from"),to:e.get("to")}},na=function(e,t){var a={};for(var n in t)t.hasOwnProperty(n)&&(a[n]=t[n].map((function(t){return Object(m.a)(Object(m.a)({},t),{},{message:t.message?e(t.message):void 0})})));return a},ra=a(847),la=function(e,t){return function(a){return r.a.createElement(r.a.Fragment,null,r.a.createElement(Qt.a,{className:"margin-right",icon:r.a.createElement(ea.a,null),type:"danger",onClick:function(){return t(a._id)},size:"small",ghost:!0}),r.a.createElement(Qt.a,{className:"margin-right",icon:r.a.createElement(ra.a,null),onClick:function(){return e(a)},size:"small"}))}},ca=Pt.format,oa={required:!0},ia=a(23),ua=function(e){var t=e.onChange,a=e.valuePropName,n=Object(ia.a)(e,["onChange","valuePropName"]);return r.a.createElement(Gt.a,Object.assign({customInput:Ht.a,thousandSeparator:".",decimalSeparator:","},n,{onValueChange:t?function(e){t(e[a||"floatValue"])}:void 0}))},sa=a(159);var ma=function(e){var t=e.disabled,a=Object(ia.a)(e,["disabled"]),l=Object(n.useContext)(N),c=Object(pe.a)("translation").t,o=l?r.a.Fragment:function(e){var t=e.children;return r.a.createElement(sa.a,{title:c("Org not selected")},t)};return r.a.createElement(o,null,r.a.createElement(Qt.a,Object.assign({disabled:!l||t},a)))};var da=function(e){var t=e.okText,a=e.onClose,l=e.formID,c=e.submitButtonProps,o=e.width,i=e.style,u=e.children,s=e.organizationId,d=Object(n.useContext)(N);return r.a.createElement(Mt.a,{title:t,onClose:a,visible:!0,okText:t,okButtonProps:Object(m.a)({form:l,htmlType:"submit"},c),onCancel:a,width:o||800,maskClosable:!1,keyboard:!1,style:i,bodyStyle:{maxHeight:"calc(100vh - 144px)"},destroyOnClose:!0},r.a.createElement(N.Provider,{value:s||d},u))};function pa(e){var t=e.children,a=e.style;return r.a.createElement("div",{style:Object(m.a)({display:"flex",height:"100%",justifyContent:"center",alignItems:"center",color:"inherit",padding:16},a)},t)}function Ea(e){var t=e.status,a=e.children,n=e.style,l=e.noDataMessage;return t.isInit?null:t.isSuccess?!t.hasData&&l?r.a.createElement(pa,{style:n},l):a():t.isLoading||t.isError?r.a.createElement(pa,{style:n},t.isLoading&&r.a.createElement(ut.a,{active:!0,inline:!0}),t.isError&&"Oops! Something went wrong.",t.isSuccess&&!t.hasData&&l):null}var fa=a(849),va={type:"link",icon:r.a.createElement(ta.a,null)};var ga=function(e){var t=e.name,a=e.label,l=e.children,c=e.addText,o=e.min,i=void 0===o?0:o,u=e.addBtnProps,s=Object(n.useMemo)((function(){return Object(m.a)(Object(m.a)({},va),{},{addBtnPropsFromProps:u})}),[u]);return r.a.createElement(r.a.Fragment,null,a&&r.a.createElement("div",{style:{paddingBottom:8}},a),r.a.createElement(Bt.a.List,{name:t},(function(e,t){var a=t.add,n=t.remove;return r.a.createElement(r.a.Fragment,null,e.map((function(e,t){return r.a.createElement("div",{key:e.key,style:{width:"100%",display:"grid",gridTemplateColumns:"minmax(min-content,max-content) minmax(min-content,max-content) min-content",columnGap:8,alignItems:"baseline"}},l(e),r.a.createElement(Qt.a,{style:{visibility:t>i-1?"visible":"hidden"},type:"danger",ghost:!0,icon:r.a.createElement(fa.a,null),onClick:function(){return n(e.name)}}))})),r.a.createElement(Qt.a,Object.assign({},s,{onClick:function(){return a()}}),c))})))},ba=function(e){var t=e.organization;return t?r.a.createElement("div",null,r.a.createElement("div",{style:{width:60}},r.a.createElement("img",{style:{maxWidth:"100%",maxHeight:"100%"},src:t.logoUrl})),r.a.createElement("div",null,r.a.createElement("strong",null,t.title)),r.a.createElement("div",null,t.description),r.a.createElement("div",null,t.phoneNumber)):null},ha=a(238),ya=function(e){var t=e.component,a=Object(ia.a)(e,["component"]),l=Object(n.useContext)(N),c=Object(n.useContext)(T).token,o=Object(ha.useToasts)().addToast;return c?r.a.createElement(t,Object.assign({},a,{addToast:function(e,t){o(e,Object(m.a)(Object(m.a)({},t),{},{autoDismiss:!0}))},organizationId:l})):r.a.createElement(p.b,{from:"",to:"login",noThrow:!0})},Ca=a(831);var Oa=function(e){var t=e.onChange,a=e.value,n=function(){var e=De().all,t=Te().all,a=Ae().all;return{options:e.map((function(e){return{value:e._id,label:e.title,children:t.filter((function(t){return t.departmentId===e._id})).map((function(e){return{value:e._id,label:e.title,children:a.filter((function(t){return t.categoryId===e._id})).map((function(e){return{value:e._id,label:e.title}}))}}))}}))}}().options;return r.a.createElement(Ca.a,{options:n,onChange:t,changeOnSelect:!0,value:a})},ja=(a(748),function(e){var t=e.kitProducts;return function(e){return!!t||0===(e.kitProducts||[]).length}});var Sa=function(e){var t=e.className,a=e.onAdd,l=e.showServices,c=void 0===l||l,o=e.showKits,i=void 0===o||o,u=Object(pe.a)("translation").t,s=Object(n.useMemo)((function(){return Object(m.a)(Object(m.a)({},c?void 0:{isService:!1}),i?void 0:{kitProducts:!1})}),[c,i]),d=le(void 0,s,ja),p=d.all,E=d.status,f=d.search,v=function(e){return a(e)};return r.a.createElement("div",{className:"product-select ".concat(t)},r.a.createElement(Ht.a.Search,{onChange:function(e){e.preventDefault(),f(e.target.value)},allowClear:!0}),r.a.createElement(Zt.b,{className:"product-list-form",itemLayout:"horizontal",dataSource:p,loading:E.isLoading,renderItem:function(e){var t;return r.a.createElement(Zt.b.Item,{className:0!==e.totalUnits||e.isService?void 0:"disabled",actions:[r.a.createElement(Qt.a,{onClick:v(e),size:"small",disabled:0===e.totalUnits&&!e.isService},"+ ",u("Add"))]},r.a.createElement(Zt.b.Item.Meta,{avatar:r.a.createElement("img",{src:"/assets/".concat(null===(t=(e.images||[])[0])||void 0===t?void 0:t.link)}),title:r.a.createElement(r.a.Fragment,null,r.a.createElement("div",null,e.title),!e.isService&&r.a.createElement("span",null,u("In Stock"),": ",e.totalUnits))}))}}))};var Ia=function(e){var t=e.onChange,a=e.value,n=function(){var e=Re().all,t=ze().all;return{options:e.map((function(e){var a=t.filter((function(t){return t.brandId===e._id})).map((function(e){return{value:e._id,label:e.title}}));return{value:e._id,label:e.title,children:a,disabled:0===a.length}}))}}().options;return r.a.createElement(Ca.a,{options:n,onChange:t,changeOnSelect:!0,value:a})},wa=function(e){var t=e.value;return r.a.createElement("span",null,t)},xa=(a(754),function(e){return Array.isArray(e)?e:e&&e.fileList}),ka={title:[oa],categoryInfo:[oa],brandInfo:[oa],price:[oa],products:[oa]},Na={products:{},discount:0,images:[]},Ta=function(e){var t=0;for(var a in e){var n=e[a];t+=(n.quantity||0)*n.price}return Number(t.toFixed(2))};var Pa=function(e){var t=e.onClose,a=e.afterSave,l=e.initialValue,c=e.okText,o=Object(pe.a)(["translation"]).t,i=Xe(),u=i.save,s=i.status,p=le(),E=p.all,f=p.status,v=Bt.a.useForm(),g=Object(d.a)(v,1)[0],b=function(e){e||g.setFieldsValue({products:void 0,price:0,cost:0});var t=0,a=0;for(var n in e){var r=e[n];r.quantity&&(a+=r.cost*r.quantity,t+=r.price*r.quantity)}g.setFieldsValue({products:e,price:t,cost:a})},h=function(e){return function(){var t,a=g.getFieldValue("products"),n=((null===(t=a[e._id])||void 0===t?void 0:t.quantity)||0)+1;if(e.isService||e.totalUnits>=n){var r={_id:e._id,title:e.title,price:e.price,cost:e.cost,quantity:n};console.log("t :>> ",r),b(Object(m.a)(Object(m.a)({},a),{},Object(J.a)({},e._id,r)))}}},y=function(e){return function(){var t=g.getFieldValue("products"),a=Object(m.a)({},t);delete a[e],b(void 0),b(a)}};Object(n.useEffect)((function(){s.isSuccess&&(ct.b.success(s.message),a())}),[s,a]),Object(n.useEffect)((function(){var e="",t=!1,a=function(a){if("Enter"===a.key){if(e.length>=13){var n=E.find((function(t){var a=t.ISBN;return e===a}));e="",n&&h(n)()}}else e+=a.key;t||(t=!0,setTimeout((function(){e="",t=!1}),200))};return document.addEventListener("keydown",a),function(){document.removeEventListener("keydown",a)}}),[E]);var C=Object(n.useMemo)((function(){return l?Object(m.a)(Object(m.a)(Object(m.a)({},Na),l),{},{categoryInfo:[l.departmentId,l.categoryId,l.subcategoryId].filter(Boolean),brandInfo:[l.brandId,l.modelId].filter(Boolean),images:(l.imageUrls||[]).map((function(e){return{url:e,uid:e}})),products:Object.fromEntries(l.kitProducts.map((function(e){return[e._id,e]})))}):Na}),[l]);return r.a.createElement(da,{className:"kit-form-modal",formID:"kit-form-modal",okText:c,onClose:t,submitButtonProps:{loading:s.isLoading},width:"100%",style:{top:16},organizationId:null===C||void 0===C?void 0:C.organizationId},r.a.createElement(Bt.a,{id:"kit-form-modal",layout:"vertical",form:g,onFinish:function(e){var t=[],a=g.getFieldValue("products");if(0!==a.length){for(var n in a){var r=a[n];r.quantity&&t.push({_id:n,quantity:r.quantity,title:r.title,price:r.price,cost:r.cost})}u(Object(m.a)(Object(m.a)(Object(m.a)({},l),e),{},{departmentId:e.categoryInfo[0],categoryId:e.categoryInfo[1],subcategoryId:e.categoryInfo[2],brandId:e.brandInfo[0],modelId:e.brandInfo[1],kitProducts:t,imageUrls:e.images.map((function(e){var t=e.response;return null===t||void 0===t?void 0:t.message}))}),null===l||void 0===l?void 0:l._id)}},initialValues:C,preserve:!1},r.a.createElement("div",{className:"products-wrapper"},r.a.createElement(Sa,{className:"product-list",onAdd:h,showKits:!1}),r.a.createElement("div",{style:{width:"50%",display:"inline-block",height:"100%"}},r.a.createElement(Bt.a.Item,{className:"products-form-item",wrapperCol:{span:24},shouldUpdate:!0},(function(e){var t=e.getFieldValue;return r.a.createElement(Ea,{status:f},(function(){return r.a.createElement(Zt.b,{className:"product-list-form",itemLayout:"horizontal",dataSource:Object.entries(t("products")),renderItem:function(e){var t,a,n=Object(d.a)(e,2),l=n[0],c=n[1],o=E.find((function(e){return c._id===e._id})),i=(null===o||void 0===o?void 0:o.images)||[],u=c.quantity,s=(null===o||void 0===o?void 0:o.chargeDuration)||"";return r.a.createElement(Zt.b.Item,{style:{display:"block"}},r.a.createElement(Zt.b.Item.Meta,{className:"selected-product-meta",avatar:r.a.createElement("img",{src:"/assets/".concat(null===(t=i[0])||void 0===t?void 0:t.link)}),title:c.title+(s?" (per ".concat(s,")"):"")}),r.a.createElement("div",{className:"sel-product"},r.a.createElement(ua,{value:u,onChange:(a=l,function(e){var t=g.getFieldValue("products");b(Object(m.a)(Object(m.a)({},t),{},Object(J.a)({},a,Object(m.a)(Object(m.a)({},t[a]),{},{quantity:e}))))}),size:"small",step:.01}),r.a.createElement(Qt.a,{icon:r.a.createElement(ea.a,null),onClick:y(l),size:"small",danger:!0}),r.a.createElement("div",{className:"price"},Pt.format(c.price*u)),r.a.createElement("div",{className:"action-group"})))}})}))})),r.a.createElement(Bt.a.Item,{className:"product-total",wrapperCol:{span:24},shouldUpdate:!0},(function(e){var t=e.getFieldValue;return r.a.createElement("div",{style:{textAlign:"right",fontSize:"1.2em"}},o("Total"),": ",Pt.format(Ta(t("products"))))})))),r.a.createElement("div",{className:"grid-50-50"},r.a.createElement("div",null,r.a.createElement(_t.a,{gutter:16},r.a.createElement(Ut.a,{span:8},r.a.createElement(Bt.a.Item,{label:o("Title"),name:"title",rules:ka.title},r.a.createElement(Ht.a,null))),r.a.createElement(Ut.a,{span:8},r.a.createElement(Bt.a.Item,{name:"categoryInfo",label:["Department","Category","Sub Category"].map(o).join("/"),rules:ka.categoryInfo},r.a.createElement(Oa,null))),r.a.createElement(Ut.a,{span:8},r.a.createElement(Bt.a.Item,{name:"brandInfo",label:["Brand","Model"].map(o).join("/"),rules:ka.brandInfo},r.a.createElement(Ia,null)))),r.a.createElement(_t.a,{gutter:16},r.a.createElement(Ut.a,{span:8},r.a.createElement(Bt.a.Item,{name:"cost",label:o("Cost"),rules:ka.cost},r.a.createElement(ua,null))),r.a.createElement(Ut.a,{span:8},r.a.createElement(Bt.a.Item,{name:"price",label:o("Price"),rules:ka.price},r.a.createElement(ua,null))),r.a.createElement(Ut.a,{span:8},r.a.createElement(Bt.a.Item,{dependencies:["price","products"],noStyle:!0},(function(e){var t=e.getFieldValue;return r.a.createElement("div",{style:{paddingTop:32}},"-",ca(Ta(t("products"))-t("price")))})))),r.a.createElement(Bt.a.Item,{label:o("Description"),name:"description",rules:ka.description},r.a.createElement(Ht.a.TextArea,{rows:4})),r.a.createElement(Bt.a.Item,{labelCol:{span:4},label:o("Comment"),name:"comment",rules:ka.comment},r.a.createElement(Ht.a.TextArea,{placeholder:o("Comment"),style:{width:"100%"},rows:1}))),r.a.createElement(Bt.a.Item,{name:"images",valuePropName:"fileList",label:o("Images"),getValueFromEvent:xa,rules:ka.images},r.a.createElement($t.a,{multiple:!0,action:"/assets/upload?entity=product",accept:".jpg, .jpeg",name:"file",listType:"picture-card"},r.a.createElement("div",null,r.a.createElement(ta.a,null),r.a.createElement("div",{style:{marginLeft:8}},"Upload")))))),s.isError&&r.a.createElement(Jt.a,{message:s.message,type:"error"}))},Da=a(817),Ra=a(823),Aa=a(850),Fa=(a(765),{title:[oa],totalUnits:[oa],departmentTree:[oa],brandTree:[oa],minStockThreshold:[oa],costContributionValue:[oa],price:[oa],unitType:[oa],measurementType:[oa],metricValue:[oa]});function La(e){return new Promise((function(t,a){var n=new FileReader;n.readAsDataURL(e),n.onload=function(){return t(n.result)},n.onerror=function(e){return a(e)}}))}var Va=function(e){return Array.isArray(e)?e:e&&e.fileList};var za="unit",Ma=[{label:__("Unit"),value:za},{label:__("Linear Meter"),value:"linearMeter"},{label:__("Square Meter"),value:"squareMeter"},{label:__("Cubic Meter"),value:"cubicMeter"}];console.log("MEASUREMENT_TYPES :>> ",Ma);var Ba={costContribution:[{name:"",value:0}],profitInPercentage:!1,images:[],measurementType:za};var Ha=function(e){var t,a,l=e.onClose,c=e.afterSave,o=e.okText,i=e.initialValue,u=Object(pe.a)(["translation"]).t,s=na(u,Fa),p=Object(n.useState)(),E=Object(d.a)(p,2),f=E[0],v=E[1],g=function(){var e=De().all,t=Te().all,a=Ae().all;return{options:e.map((function(e){return{value:e._id,label:e.title,children:t.filter((function(t){return t.departmentId===e._id})).map((function(e){return{value:e._id,label:e.title,children:a.filter((function(t){return t.categoryId===e._id})).map((function(e){return{value:e._id,label:e.title}}))}}))}}))}}().options,b=function(){var e=Re().all,t=ze().all;return{options:e.map((function(e){var a=t.filter((function(t){return t.brandId===e._id})).map((function(e){return{value:e._id,label:e.title}}));return{value:e._id,label:e.title,children:a,disabled:0===a.length}}))}}().options,h=lt().options,y=Y(),j=y.save,S=y.status,I=Bt.a.useForm(),w=Object(d.a)(I,1)[0],x=function(){var e=Object(O.a)(C.a.mark((function e(t){var a;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.url||t.preview)){e.next=5;break}v(t.url),e.next=9;break;case 5:return e.next=7,La(t.originFileObj);case 7:a=e.sent,v(a);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();Object(n.useEffect)((function(){S.isSuccess&&(ct.b.success(S.message),c())}),[S,c]);var k=i?Object(m.a)(Object(m.a)(Object(m.a)({},Ba),i),{},{departmentTree:[i.departmentId,i.categoryId,i.subcategoryId],brandTree:[i.brandId,i.modelId],images:(i.imageUrls||[]).map((function(e){return{url:e,uid:e}})),profit:i.price-i.cost,metricType:null===(t=i.unit[i.unitType])||void 0===t?void 0:t.unit,metricValue:null===(a=i.unit[i.unitType])||void 0===a?void 0:a.value,costContribution:i.costContribution||[{name:"",value:i.cost}]}):Ba;return r.a.createElement(da,{formID:"product-add-modal",onClose:l,okText:o,submitButtonProps:{loading:S.isLoading},width:"100%",style:{top:16},organizationId:null===k||void 0===k?void 0:k.organizationId},r.a.createElement(Bt.a,{form:w,layout:"vertical",id:"product-add-modal",onValuesChange:function(e){var t=w.getFieldValue("costContribution").reduce((function(e,t){return e+((null===t||void 0===t?void 0:t.value)||0)}),0),a=w.getFieldValue("profit")||0,n=t+(w.getFieldValue("profitInPercentage")?a*t/100:a);if(e.costContribution)w.setFieldsValue({price:Number(n.toFixed(2)),profit:Number(a.toFixed(2))});else if(void 0!==e.profitInPercentage)w.setFieldsValue({price:Number(n.toFixed(2))});else if(e.profit)w.setFieldsValue({price:Number(n.toFixed(2))});else if(e.price){var r=w.getFieldValue("profitInPercentage")?100*(e.price-t)/t:e.price-t;w.setFieldsValue({profit:Number(r.toFixed(2))})}},initialValues:k,onFinish:function(e){var t=Object(m.a)(Object(m.a)({},e),{},{departmentId:e.departmentTree[0],categoryId:e.departmentTree[1]||void 0,subcategoryId:e.departmentTree[2]||void 0,brandId:e.brandTree[0],modelId:e.brandTree[1],cost:e.costContribution.reduce((function(e,t){return e+((null===t||void 0===t?void 0:t.value)||0)}),0),imageUrls:e.images.map((function(e){var t=e.response;return null===t||void 0===t?void 0:t.message})),revenue:e.profit,providerId:e.providerId||void 0,unit:Object(J.a)({},e.unitType,{unit:e.metricType,value:e.metricValue})});j(t,null===i||void 0===i?void 0:i._id)}},r.a.createElement(_t.a,{gutter:16},r.a.createElement(Ut.a,{span:16},r.a.createElement(_t.a,{gutter:16},r.a.createElement(Ut.a,{span:12},r.a.createElement(Bt.a.Item,{name:"title",label:u("Title"),rules:s.title},r.a.createElement(Ht.a,null))),r.a.createElement(Ut.a,{span:6},r.a.createElement(Bt.a.Item,{name:"totalUnits",label:u("Total Units"),rules:s.totalUnits},r.a.createElement(ua,null))),r.a.createElement(Ut.a,{span:6},r.a.createElement(Bt.a.Item,{name:"minStockThreshold",label:u("Min Stock Threshold"),rules:s.minStockThreshold},r.a.createElement(ua,null)))),r.a.createElement(_t.a,{gutter:16},r.a.createElement(Ut.a,{span:12},r.a.createElement(Bt.a.Item,{label:["Department","Category","Sub Category"].map(u).join("/"),name:"departmentTree",rules:s.departmentTree},r.a.createElement(Ca.a,{options:g,changeOnSelect:!0}))),r.a.createElement(Ut.a,{span:12},r.a.createElement(Bt.a.Item,{label:["Brand","Model"].map(u).join("/"),name:"brandTree",rules:s.brandTree},r.a.createElement(Ca.a,{options:b})))),r.a.createElement(_t.a,{gutter:16},r.a.createElement(Ut.a,{span:6},r.a.createElement(Bt.a.Item,{name:"ISBN",label:u("BCode"),rules:s.ISBN},r.a.createElement(Ht.a,null))),r.a.createElement(Ut.a,{span:6},r.a.createElement(Bt.a.Item,{name:"providerId",label:u("Provider"),rules:s.providerId},r.a.createElement(Yt.a,{options:h}))),r.a.createElement(Ut.a,{span:4},r.a.createElement(Bt.a.Item,{name:"measurementType",label:u("Metric"),rules:s.measurementType},r.a.createElement(Yt.a,{options:Ma}))),r.a.createElement(Ut.a,{span:5},r.a.createElement(Bt.a.Item,{dependencies:["unitType"],noStyle:!0},(function(e){var t=e.getFieldValue;return r.a.createElement(Bt.a.Item,{name:"metricValue",label:u("Value"),rules:"size"===t("unitType")?s.metricValue:void 0},r.a.createElement(ua,{disabled:"unit"===t("unitType")}))})))),r.a.createElement(Da.a,{style:{margin:"8px 0"}}),r.a.createElement(_t.a,{gutter:16},r.a.createElement(Ut.a,{span:8},r.a.createElement(ga,{label:u("Cost"),name:"costContribution"},(function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement(Bt.a.Item,{name:[e.name,"name"],fieldKey:[e.fieldKey,"name"],rules:s.costContributionName},r.a.createElement(Ht.a,{placeholder:u("Cost Name")})),r.a.createElement(Bt.a.Item,{name:[e.name,"value"],fieldKey:[e.fieldKey,"value"],rules:s.costContributionValue},r.a.createElement(ua,null)))})),r.a.createElement(Bt.a.Item,{shouldUpdate:!0,noStyle:!0},(function(e){var t=e.getFieldValue;return r.a.createElement(r.a.Fragment,null,"Total: ",ca(t("costContribution").reduce((function(e,t){return e+((null===t||void 0===t?void 0:t.value)||0)}),0)))}))),r.a.createElement(Ut.a,{span:8},r.a.createElement("div",{style:{display:"grid",gridTemplateColumns:"auto max-content"}},r.a.createElement(Bt.a.Item,{label:u("Profit"),name:"profit"},r.a.createElement(ua,null)),r.a.createElement(Bt.a.Item,{name:"profitInPercentage",label:"\u2800"},r.a.createElement(qt.a.Group,null,r.a.createElement(qt.a.Button,{value:!1},"#"),r.a.createElement(qt.a.Button,{value:!0},"%"))))),r.a.createElement(Ut.a,{span:8},r.a.createElement(Bt.a.Item,{name:"price",label:u("Price"),rules:s.price},r.a.createElement(ua,null)))),r.a.createElement(Da.a,{style:{margin:"8px 0"}}),r.a.createElement(_t.a,{gutter:16},r.a.createElement(Ut.a,{span:12},r.a.createElement(Bt.a.Item,{name:"description",label:u("Description"),rules:s.description},r.a.createElement(Ht.a.TextArea,{rows:5}))),r.a.createElement(Ut.a,{span:12},r.a.createElement(Bt.a.Item,{name:"comment",label:u("Comment"),rules:s.comment},r.a.createElement(Ht.a.TextArea,{rows:5}))))),r.a.createElement(Ut.a,{span:8},r.a.createElement(Ra.a,{title:u("Product Images"),className:"image-upload-container",size:"small"},r.a.createElement("div",{className:"preview-image-container"},f?r.a.createElement("img",{src:f,alt:"preview"}):r.a.createElement("span",null,"click on ",r.a.createElement(Aa.a,null)," in thumbline to preview")),r.a.createElement(Bt.a.Item,{name:"images",valuePropName:"fileList",getValueFromEvent:Va},r.a.createElement($t.a,{multiple:!0,action:"/assets/upload?entity=product",accept:".jpg, .jpeg",name:"file",listType:"picture-card",onPreview:x},r.a.createElement("div",null,r.a.createElement(ta.a,null),r.a.createElement("div",{style:{marginLeft:8}},"Upload")))))))),S.isError&&r.a.createElement(Jt.a,{message:S.message,type:"error"}))},_a={departmentId:void 0,brandId:void 0},Ua=function(e){var t=e.departmentId,a=e.brandId;return function(e){return(!t||e.departmentId===t)&&(!a||e.brandId===a)}};var qa=function(e){var t=e.location,a=e.addToast,l=Object(pe.a)(["translation"]).t,c=Object(n.useMemo)((function(){return Object(m.a)(Object(m.a)({},_a),Object.fromEntries(new URLSearchParams(t.search)))}),[]),o=le(void 0,c,Ua),i=o.data,u=o.total,s=o.pages,E=o.search,f=o.goto,v=o.filters,g=o.status,b=o.refresh,h=Y(),y=h.changeStatus,C=h.status,O=Object(n.useState)(!1),j=Object(d.a)(O,2),S=j[0],I=j[1],w=Object(n.useState)(void 0),x=Object(d.a)(w,2),k=x[0],N=x[1],T=Object(n.useState)(!1),P=Object(d.a)(T,2),D=P[0],R=P[1],A=Object(n.useState)(!1),F=Object(d.a)(A,2),L=F[0],V=F[1],z=Object(n.useState)(void 0),B=Object(d.a)(z,2),H=B[0],_=B[1],U=Object(n.useState)(!1),q=Object(d.a)(U,2),J=q[0],G=q[1],W=Ve(null===H||void 0===H?void 0:H.organizationId).options,K=function(e){var t=M("/api/brands"),a=Object(d.a)(t,3),n=a[0],r=(n=void 0===n?{data:[]}:n).data,l=a[1],c=a[2];return[r.filter((function(t){return!e||t.organizationId===e})).map((function(e){var t=e._id,a=e.title;return{value:t,text:a,label:a,departmentId:e.departmentId}})),l,c]}(null===H||void 0===H?void 0:H.organizationId),X=Object(d.a)(K,1)[0],Q=function(e){var t=M("/api/models"),a=Object(d.a)(t,3),n=a[0],r=(n=void 0===n?{data:[]}:n).data,l=a[1],c=a[2];return[r.filter((function(t){return!e||t.organizationId===e})).map((function(e){return{value:e._id,text:e.title,brandId:e.brandId}})),l,c]}(null===H||void 0===H?void 0:H.organizationId),$=Object(d.a)(Q,1)[0],Z=nt(null===H||void 0===H?void 0:H.organizationId),ee=Object(d.a)(Z,1)[0],te=rt(null===H||void 0===H?void 0:H.organizationId),ae={departmentOptions:W,brandOptions:X,modelOptions:$,categoryOptions:ee,subCategoryOptions:Object(d.a)(te,1)[0],providerOptions:lt(null===H||void 0===H||H.organizationId).options},ne=function(){return V(!1)},re=function(){return _(void 0)};Object(n.useEffect)((function(){J||(i||[]).some((function(e){return!e.isService&&e.totalUnits<=(e.minStockThreshold||0)}))&&(a(l("You have few product with low stock"),{appearance:"warning",autoDismissTimeout:1e4}),G(!0))}),[J,i]);var ce=function(){I(!1),N(void 0)},oe=function(){R(!1),_(void 0)};return Object(n.useEffect)((function(){C.isSuccess&&b()}),[C]),Object(n.useEffect)((function(){Object(p.d)("/products",{replace:!0})}),[]),g.isLoading?r.a.createElement(st,null):r.a.createElement("div",{className:"container"},r.a.createElement("h2",{style:{display:"inline"}},"Produtos"),r.a.createElement("span",{style:{marginLeft:16,marginRight:16}},l("Total"),": ",u),r.a.createElement("div",{class:"ui action input",style:{marginLeft:16,marginRight:16}},r.a.createElement(mt.a,{type:"text",placeholder:"Search...",onChange:function(e){E(e.target.value)},value:v.searchText}),r.a.createElement("button",{class:"ui icon button",onClick:function(){E("")}},r.a.createElement("i",{class:"delete icon"}))),r.a.createElement(Yt.a,{defaultValue:v.values.departmentId,onChange:v.handlers.departmentId,style:{width:200,marginRight:16},placeholder:l("Department"),options:W.map((function(e){return{value:e.value,label:e.label}})),allowClear:!0,showSearch:!0}),r.a.createElement(Yt.a,{defaultValue:v.values.brandId,onChange:v.handlers.brandId,style:{width:200,marginRight:16},placeholder:l("Brand"),options:X.map((function(e){return{value:e.value,label:e.label}})),allowClear:!0,showSearch:!0}),r.a.createElement(ma,{type:"primary",className:"generic-create-btn",onClick:function(){return V(!0)}},l("Add")," ",l("Product")),r.a.createElement(ma,{type:"primary",className:"generic-create-btn",onClick:function(){I(!0)}},l("Create")," ",l("Kit")),r.a.createElement(ma,{type:"primary",className:"generic-create-btn",onClick:function(){return R(!0)}},l("Add")," ",l("Service")),r.a.createElement(zt,{options:ae,loadProducts:b,filters:v,addToast:a,products:i,showKitModal:N,setProductToEdit:_,pages:s,onPageChange:f,changeStatus:y}),(S||k)&&r.a.createElement(Pa,{onClose:ce,afterSave:function(){ce(),b()},okText:"".concat(l(k?"Update":"Add")," ").concat(l("Kit")),initialValue:k}),(L||H&&!H.isService)&&r.a.createElement(Ha,{onClose:function(){ne(),re()},okText:"".concat(l(H?"Update":"Add")," ").concat(l("Product")),afterSave:function(){ne(),re(),b()},initialValue:H}),((null===H||void 0===H?void 0:H.isService)||D)&&r.a.createElement(Xt,{okText:H?l("Update")+" "+l("Service"):l("Add")+" "+l("Service"),afterSave:function(){oe(),b()},initialValue:H,onClose:oe}))},Ya=function(e,t,a){return e&&e.length>=t&&(e.length<=a||0===a)},Ja=function(e){var t=e.category,a=void 0===t?{}:t,l=e.categoryOptions,c=e.submit,o=e.addToast,i=e.componentName,u=e.loadSubcategories,s=Object(n.useState)(!1),m=Object(d.a)(s,2),p=m[0],E=m[1],f=Object(n.useState)(a.title),v=Object(d.a)(f,2),g=v[0],b=v[1],h=Object(n.useState)(!0),y=Object(d.a)(h,2),j=y[0],S=y[1],w=Object(n.useState)(a.description),k=Object(d.a)(w,2),N=k[0],T=k[1],P=Object(n.useState)(""),D=Object(d.a)(P,2),R=D[0],A=D[1],F=Object(n.useState)(!0),L=Object(d.a)(F,2),V=L[0],z=L[1],M=Object(n.useState)(!1),B=Object(d.a)(M,2),H=B[0],_=B[1],U=function(){var e=Object(O.a)(C.a.mark((function e(){return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(V&&j&&""!==R&&!H){e.next=3;break}return e.abrupt("return");case 3:return _(!0),e.next=6,c({title:g,description:N,categoryId:R}).then((function(e){o("Subcategory ".concat(a.title?"updated":"created"," successfully"),{appearance:"success"}),b(""),T(""),A(""),Y()})).catch((function(e){o(e.message,{appearance:"error"})}));case 6:_(!1);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),q=function(){E(!p)},Y=function(){u(),q()};return r.a.createElement(ft.a,{trigger:r.a.createElement(x.a,{className:"Edit"===i?"table-action-btn":"generic-create-btn",onClick:q},"Edit"===i?r.a.createElement(pt.a,{name:"pencil"}):r.a.createElement("span",null,i)),closeIcon:!0,open:p,onClose:Y},r.a.createElement(ft.a.Header,null,i," Subcategory"),r.a.createElement(ft.a.Content,null,r.a.createElement(I.a,{name:"createDepForm",size:"large",onSubmit:U},r.a.createElement(I.a.Input,{fluid:!0,placeholder:"Titulo",value:g,error:!j,onChange:function(e){return b(e.target.value)},onBlur:function(){return S(Ya(g,3,0))}}),r.a.createElement(I.a.TextArea,{fluid:!0,placeholder:"Descri\xe7\xe3o",value:N,error:!V,onChange:function(e){return T(e.target.value)},onBlur:function(){return z(Ya(N,5,0))}}),r.a.createElement(I.a.Select,{fluid:!0,label:"Category",options:l,placeholder:"Category",onChange:function(e,t){var a=t.value;return A(a)},search:!0}),r.a.createElement(x.a,{type:"submit",color:"teal",fluid:!0,size:"small",loading:H,primary:!0},"Submit"))))};Ja.defaultProps={category:{}};var Ga=Ja,Wa=a(29),Ka=a(22),Xa=a(30),Qa=function(){var e=Object(O.a)(C.a.mark((function e(t,a){var n;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ct({endpoint:"/api/subcategories",type:"POST",request:t,organizationId:a});case 2:return n=e.sent,e.abrupt("return",n.json());case 4:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),$a=function(){var e=Object(O.a)(C.a.mark((function e(t,a){var n;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ct({endpoint:"/api/subcategories/".concat(t),type:"PUT",request:a});case 2:return n=e.sent,e.abrupt("return",n.json());case 4:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),Za=function(){var e=Object(O.a)(C.a.mark((function e(t){var a;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ct({endpoint:"/api/subcategories/".concat(t),type:"DELETE"});case 2:return a=e.sent,e.abrupt("return",a.json());case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),en=function(e){var t=e.title,a=e.id,l=e.addToast,c=e.loadSubcategories,o=Object(n.useState)(!1),i=Object(d.a)(o,2),u=i[0],s=i[1],m=function(){s(!u)};return r.a.createElement(ft.a,{trigger:r.a.createElement(x.a,{className:"table-action-btn",onClick:m},r.a.createElement(pt.a,{name:"trash"})),open:u,closeIcon:!0},r.a.createElement(ft.a.Header,null,"Delete a category"),r.a.createElement(ft.a.Content,null,r.a.createElement("h4",null,"Are you sure you want to delete category ",'"'.concat(t,'"'),"?"),r.a.createElement(x.a,{color:"red",inverted:!0,onClick:function(){Za(a).then((function(e){l("Subcategory deleted successfully",{appearance:"success"})})).catch((function(e){""!==e.message?l("Could not delete subcategory: "+e.message,{appearance:"error"}):l("Something went wrong",{appearance:"error"})})).finally((function(){m(),c()}))}},r.a.createElement(pt.a,{name:"remove"})," Delete"),r.a.createElement(x.a,{color:"blue",inverted:!0,onClick:m},r.a.createElement(pt.a,{name:"checkmark"})," Cancel")))},tn=function(e){Object(Ka.a)(a,e);var t=Object(Xa.a)(a);function a(e){var n;return Object(P.a)(this,a),(n=t.call(this,e)).createSubcategoryRow=function(e){return r.a.createElement(dt.a.Row,{key:e._id},r.a.createElement(dt.a.Cell,null,r.a.createElement(Ga,{category:e,componentName:"Edit",addToast:n.props.addToast,categoryOptions:n.props.categoryOptions,loadSubcategories:n.props.loadSubcategories,submit:function(t){return $a(e._id,t)}})),r.a.createElement(dt.a.Cell,null,r.a.createElement(en,{addToast:n.props.addToast,id:e._id,title:e.title,loadSubcategories:n.props.loadSubcategories})),r.a.createElement(dt.a.Cell,null,e._id),r.a.createElement(dt.a.Cell,null,e.title),r.a.createElement(dt.a.Cell,null,e.category.title),r.a.createElement(dt.a.Cell,null,e.description))},n.handlePaginationClick=function(e){n.props.updatePageFilter({page:e})},n.createSubcategoryRow=n.createSubcategoryRow.bind(Object(Wa.a)(n)),n.handlePaginationClick=n.handlePaginationClick.bind(Object(Wa.a)(n)),n}return Object(D.a)(a,[{key:"render",value:function(){var e=this,t=this.props,a=t.pages,n=t.filters,l=t.onPageChange;return r.a.createElement(dt.a,{celled:!0},r.a.createElement(dt.a.Header,null,r.a.createElement(dt.a.Row,null,r.a.createElement(dt.a.HeaderCell,{colspan:2,rowspan:2},"Actions"),r.a.createElement(dt.a.HeaderCell,null,"ID"),r.a.createElement(dt.a.HeaderCell,null,"Titulo"),r.a.createElement(dt.a.HeaderCell,null,"Category"),r.a.createElement(dt.a.HeaderCell,null,"Descri\xe7\xe3o"))),r.a.createElement(dt.a.Body,null,this.props.subcategories.map((function(t){return e.createSubcategoryRow(t)}))),r.a.createElement(dt.a.Footer,null,r.a.createElement(dt.a.Row,null,r.a.createElement(dt.a.HeaderCell,{colSpan:"20",style:{textAlign:"right"}},r.a.createElement(Et.a,{activePage:n.currentPage,totalPages:a,onPageChange:function(e,t){var a=t.activePage;return l(a)}})))))}}]),a}(n.Component);var an=function(e){var t=ne("/api/subcategories","*"),a=Object(d.a)(t,8),l=a[0],c=a[1],o=c.total,i=c.pages,u=a[2],s=a[3],m=(a[4],a[5]),p=(a[6],a[7]),E=M("/api/categories"),f=Object(d.a)(E,1)[0],v=(f=void 0===f?{data:[]}:f).data,g=Object(n.useContext)(N),b=v.map((function(e){return{value:e._id,text:e.title}}));return r.a.createElement("div",{className:"categories-container container"},r.a.createElement("h2",null,"Subcategories"),r.a.createElement(Ga,{componentName:"Create",categoryOptions:b,addToast:e.addToast,loadSubcategories:p,submit:function(e){return Qa(e,g)}}),r.a.createElement("div",null,r.a.createElement("span",null,"Total subcategories: ",o),r.a.createElement("div",{class:"ui action input",style:{marginLeft:16}},r.a.createElement(mt.a,{type:"text",placeholder:"Search...",onChange:function(e){u(e.target.value)},value:m.searchText}),r.a.createElement("button",{class:"ui icon button",onClick:function(){u("")}},r.a.createElement("i",{class:"delete icon"})))),r.a.createElement(tn,{addToast:e.addToast,categoryOptions:b,subcategories:l,filters:m,loadSubcategories:p,onPageChange:s,pages:i}))},nn=(a(770),function(e){var t=e.category,a=void 0===t?{}:t,l=e.departmentOptions,c=e.submit,o=e.addToast,i=e.componentName,u=e.loadCategories,s=Object(n.useState)(!1),m=Object(d.a)(s,2),p=m[0],E=m[1],f=Object(n.useState)(a.title),v=Object(d.a)(f,2),g=v[0],b=v[1],h=Object(n.useState)(!0),y=Object(d.a)(h,2),j=y[0],S=y[1],w=Object(n.useState)(a.description),k=Object(d.a)(w,2),N=k[0],T=k[1],P=Object(n.useState)(a.departmentId),D=Object(d.a)(P,2),R=D[0],A=D[1],F=Object(n.useState)(!0),L=Object(d.a)(F,2),V=L[0],z=L[1],M=Object(n.useState)(!1),B=Object(d.a)(M,2),H=B[0],_=B[1],U=function(){var e=Object(O.a)(C.a.mark((function e(){return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(V&&j&&""!==R&&!H){e.next=3;break}return e.abrupt("return");case 3:return _(!0),e.next=6,c({title:g,description:N,departmentId:R}).then((function(e){o("Category ".concat(a.title?"updated":"created"," successfully"),{appearance:"success"}),b(""),T(""),A("")})).catch((function(e){o(e.message,{appearance:"error"})}));case 6:_(!1),Y();case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),q=function(){E(!p)},Y=function(){u(),q()};return r.a.createElement(ft.a,{trigger:r.a.createElement(x.a,{className:"Edit"===i?"table-action-btn":"generic-create-btn",onClick:q},"Edit"===i?r.a.createElement(pt.a,{name:"pencil"}):r.a.createElement("span",null,i)),closeIcon:!0,open:p,onClose:Y},r.a.createElement(ft.a.Header,null,i," a category"),r.a.createElement(ft.a.Content,null,r.a.createElement(I.a,{name:"createDepForm",size:"large",onSubmit:U},r.a.createElement(I.a.Input,{fluid:!0,placeholder:"Titulo",value:g,error:!j,onChange:function(e){return b(e.target.value)},onBlur:function(){return S(Ya(g,3,0))}}),r.a.createElement(I.a.TextArea,{fluid:!0,placeholder:"Descri\xe7\xe3o",value:N,error:!V,onChange:function(e){return T(e.target.value)},onBlur:function(){return z(Ya(N,5,0))}}),r.a.createElement(I.a.Select,{fluid:!0,label:"Departamento",options:l,placeholder:"Departamento",onChange:function(e,t){var a=t.value;return A(a)},value:R}),r.a.createElement(x.a,{type:"submit",color:"teal",fluid:!0,loading:H,primary:!0},"Submit"))))});nn.defaultProps={department:{}};var rn=nn,ln=function(){var e=Object(O.a)(C.a.mark((function e(t,a){var n;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ct({endpoint:"/api/categories",type:"POST",request:t,organizationId:a});case 2:return n=e.sent,e.abrupt("return",n.json());case 4:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),cn=function(){var e=Object(O.a)(C.a.mark((function e(t,a){var n;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ct({endpoint:"/api/categories/".concat(t),type:"PUT",request:a});case 2:return n=e.sent,e.abrupt("return",n.json());case 4:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),on=function(){var e=Object(O.a)(C.a.mark((function e(t){var a;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ct({endpoint:"/api/categories/".concat(t),type:"DELETE"});case 2:return a=e.sent,e.abrupt("return",a.json());case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),un=(a(771),function(e){var t=e.title,a=e.id,l=e.addToast,c=e.loadCategories,o=Object(n.useState)(!1),i=Object(d.a)(o,2),u=i[0],s=i[1],m=function(){s(!u)};return r.a.createElement(ft.a,{trigger:r.a.createElement(x.a,{className:"cat-delete-btn cat-btn",onClick:m},r.a.createElement(pt.a,{name:"trash"})),open:u,closeIcon:!0},r.a.createElement(ft.a.Header,null,"Delete a category"),r.a.createElement(ft.a.Content,null,r.a.createElement("h4",null,"Are you sure you want to delete category ",'"'.concat(t,'"'),"?"),r.a.createElement(x.a,{color:"red",inverted:!0,onClick:function(){on(a).then((function(e){l("Category deleted successfully",{appearance:"success"})})).catch((function(e){""!==e.message?l("Could not delete category: "+e.message,{appearance:"error"}):l("Something went wrong",{appearance:"error"})})).finally((function(){m(),c()}))}},r.a.createElement(pt.a,{name:"remove"})," Delete"),r.a.createElement(x.a,{color:"blue",inverted:!0,onClick:m},r.a.createElement(pt.a,{name:"checkmark"})," Cancel")))}),sn=function(e){Object(Ka.a)(a,e);var t=Object(Xa.a)(a);function a(e){var n;return Object(P.a)(this,a),(n=t.call(this,e)).createCategoryRow=function(e){return r.a.createElement(dt.a.Row,{key:e._id},r.a.createElement(dt.a.Cell,null,r.a.createElement(rn,{category:e,componentName:"Edit",addToast:n.props.addToast,departmentOptions:n.props.departmentOptions,loadCategories:n.props.loadCategories,submit:function(t){return cn(e._id,t)}})),r.a.createElement(dt.a.Cell,null,r.a.createElement(un,{addToast:n.props.addToast,id:e._id,title:e.title,loadCategories:n.props.loadCategories})),r.a.createElement(dt.a.Cell,null,e._id),r.a.createElement(dt.a.Cell,null,e.title),r.a.createElement(dt.a.Cell,null,e.department?e.department.title:""),r.a.createElement(dt.a.Cell,null,e.description))},n.handlePaginationClick=function(e){n.props.updatePageFilter({page:e})},n.createCategoryRow=n.createCategoryRow.bind(Object(Wa.a)(n)),n.handlePaginationClick=n.handlePaginationClick.bind(Object(Wa.a)(n)),n}return Object(D.a)(a,[{key:"render",value:function(){var e=this,t=this.props,a=t.pages,n=t.onPageChange,l=t.filters;return r.a.createElement(dt.a,{celled:!0},r.a.createElement(dt.a.Header,null,r.a.createElement(dt.a.Row,null,r.a.createElement(dt.a.HeaderCell,{colspan:2,rowspan:2},"Actions"),r.a.createElement(dt.a.HeaderCell,null,"ID"),r.a.createElement(dt.a.HeaderCell,null,"Titulo"),r.a.createElement(dt.a.HeaderCell,null,"Departamento"),r.a.createElement(dt.a.HeaderCell,null,"Descri\xe7\xe3o"))),r.a.createElement(dt.a.Body,null,this.props.categories.map((function(t){return e.createCategoryRow(t)}))),r.a.createElement(dt.a.Footer,null,r.a.createElement(dt.a.Row,null,r.a.createElement(dt.a.HeaderCell,{colSpan:"20",style:{textAlign:"right"}},r.a.createElement(Et.a,{activePage:l.currentPage,totalPages:a,onPageChange:function(e,t){var a=t.activePage;return n(a)}})))))}}]),a}(n.Component);a(772);var mn=function(e){var t=Te(),a=t.data,l=t.total,c=t.pages,o=t.search,i=t.goto,u=t.filters,s=t.refresh,m=M("/api/departments","*"),p=Object(d.a)(m,8)[0],E=(p=void 0===p?{data:[]}:p).data,f=Object(n.useContext)(N),v=E.map((function(e){return{value:e._id,text:e.title}}));return r.a.createElement("div",{className:"categories-container container"},r.a.createElement("h2",null,"Categories"),r.a.createElement(rn,{componentName:"Create",departmentOptions:v,addToast:e.addToast,loadCategories:s,submit:function(e){return ln(e,f)}}),r.a.createElement("div",null,r.a.createElement("strong",null,"Total categories: ",l),r.a.createElement("div",{class:"ui action input",style:{marginLeft:16}},r.a.createElement(mt.a,{type:"text",placeholder:"Search...",onChange:function(e){return o(e.target.value)},value:u.searchText}),r.a.createElement("button",{class:"ui icon button",onClick:function(){return o("")}},r.a.createElement("i",{class:"delete icon"})))),r.a.createElement(sn,{addToast:e.addToast,departmentOptions:v,categories:a,loadCategories:s,onPageChange:i,filters:u,pages:c}))},dn=a(33),pn=a(826),En={required:!0},fn={pattern:"[0-9]+",message:"only digits allowed"},vn=function(e){var t=e.target.value.slice(0,6);return/^([0-9]{1,5}|[0-9]{1,4}([-]{1}[0-9]{0,1})?)$/.test(t)?t.length>4&&!t.endsWith("-")?t.substr(0,4)+"-"+t.substr(-1):t:""},gn=function(e){var t=e.target.value.slice(0,10);return/^([0-9]{1,9}|[0-9]{1,8}([-]{1}[0-9]{0,1})?)$/.test(t)?t.length>8&&!t.endsWith("-")?t.substr(0,8)+"-"+t.substr(-1):t:""},bn={agencyNo:[En,{pattern:"^[0-9]{4}(-[0-9]{1})?$",message:"Should be XXXX or XXXX-X"},{max:6}],no:[En,fn,{max:5}],accountNo:[En,{pattern:"^[0-9]{8}(-[0-9]{1})?$",message:"Should be XXXXXXXX or XXXXXXXX-X"},{max:10}],date:[En],holder:[En],to:[En],destinationName:[En],destinationBank:[fn,{max:4}],destinationDate:[En],depositMode:[En],amount:[En]},hn={depositMode:"cash",accountType:"personal",frontImage:[],backImage:[]},yn=function(e){return{url:"/uploads/".concat(e),name:e,status:"done",uid:e}},Cn=function(e){var t,a,n,r=e.file;if("removed"===r.status)return[];(null===r||void 0===r||null===(t=r.response)||void 0===t?void 0:t.message)&&(r.uid=null===r||void 0===r||null===(a=r.response)||void 0===a?void 0:a.message,r.url="/uploads/".concat(null===r||void 0===r||null===(n=r.response)||void 0===n?void 0:n.message));return[r]};var On=function(e){var t=e.onClose,a=e.okText,l=e.okButtonProps,c=e.onSave,o=e.initialValues,i=Object(pe.a)(["translation"]).t,u=Bt.a.useForm(),s=Object(d.a)(u,1)[0],p=Object(n.useMemo)((function(){return na(i,bn)}),[i]),E=o?Object(m.a)(Object(m.a)({},o),{},{date:W()(1e3*o.date),destinationDate:W()(1e3*o.destinationDate),frontImage:o.frontImageUrl?[yn(o.frontImageUrl)]:[],backImage:o.backImageUrl?[yn(o.backImageUrl)]:[]}):hn;return r.a.createElement(dn.a,null,r.a.createElement(Mt.a,{title:a,onClose:t,visible:!0,okText:a,okButtonProps:Object(m.a)({form:"cheque-add-modal",htmlType:"submit"},l),onCancel:t,width:800,maskClosable:!1,keyboard:!1},r.a.createElement(Bt.a,{layout:"vertical",id:"cheque-add-modal",form:s,initialValues:E,onFinish:function(e){var t,a;c(Object(m.a)(Object(m.a)(Object(m.a)({},o),e),{},{date:e.date.unix(),destinationDate:e.destinationDate.unix(),frontImageUrl:null===(t=e.frontImage[0])||void 0===t?void 0:t.uid,backImageUrl:null===(a=e.backImage[0])||void 0===a?void 0:a.uid}))}},r.a.createElement(_t.a,{gutter:16},r.a.createElement(Ut.a,{span:6},r.a.createElement(Bt.a.Item,{label:i("Cheque No"),name:"no",rules:p.no},r.a.createElement(Ht.a,null))),r.a.createElement(Ut.a,{span:6},r.a.createElement(Bt.a.Item,{label:i("Agency No"),name:"agencyNo",getValueFromEvent:vn,rules:p.agencyNo},r.a.createElement(Ht.a,null))),r.a.createElement(Ut.a,{span:6},r.a.createElement(Bt.a.Item,{label:i("Account No"),name:"accountNo",rules:p.accountNo,getValueFromEvent:gn},r.a.createElement(Ht.a,null))),r.a.createElement(Ut.a,{span:6},r.a.createElement(Bt.a.Item,{label:i("Cheque Date"),name:"date",rules:p.date},r.a.createElement(pn.a,{style:{width:"100%"}})))),r.a.createElement(_t.a,{gutter:16},r.a.createElement(Ut.a,{span:8},r.a.createElement(Bt.a.Item,{label:i("Amount"),name:"amount",rules:p.amount,trigger:"onValueChange",getValueFromEvent:function(e){return e.floatValue}},r.a.createElement(Gt.a,{customInput:Ht.a,thousandSeparator:".",decimalSeparator:","}))),r.a.createElement(Ut.a,{span:8},r.a.createElement(Bt.a.Item,{label:i("Holder"),name:"holder",rules:p.holder},r.a.createElement(Ht.a,null))),r.a.createElement(Ut.a,{span:8},r.a.createElement(Bt.a.Item,{label:i("To"),name:"to",rules:p.to},r.a.createElement(Ht.a,null)))),r.a.createElement(_t.a,{gutter:16},r.a.createElement(Ut.a,{span:8},r.a.createElement(Bt.a.Item,{label:i("Destination Bank Number"),name:"destinationBank",rules:p.destinationBank},r.a.createElement(Ht.a,null))),r.a.createElement(Ut.a,{span:8},r.a.createElement(Bt.a.Item,{label:i("Destination Name (Beneficiary)"),name:"destinationName",rules:p.destinationName},r.a.createElement(Ht.a,null))),r.a.createElement(Ut.a,{span:8},r.a.createElement(Bt.a.Item,{label:i("Destination Date"),name:"destinationDate",rules:p.destinationDate},r.a.createElement(pn.a,{style:{width:"100%"}})))),r.a.createElement(_t.a,null,r.a.createElement(Ut.a,{span:12},r.a.createElement(Bt.a.Item,{name:"depositMode",rules:p.depositMode},r.a.createElement(qt.a.Group,null,r.a.createElement(qt.a,{value:"cash"},i("Cash")),r.a.createElement(qt.a,{value:"deposit"},i("Deposit"))))),r.a.createElement(Ut.a,{span:12},r.a.createElement(Bt.a.Item,{name:"accountType"},r.a.createElement(qt.a.Group,null,r.a.createElement(qt.a,{value:"personal"},i("Personal")),r.a.createElement(qt.a,{value:"business"},i("Business")))))),r.a.createElement(_t.a,null,r.a.createElement(Ut.a,{span:12},r.a.createElement(Bt.a.Item,{label:i("Front Image"),name:"frontImage",rules:p.frontImageUrl,getValueFromEvent:Cn,valuePropName:"fileList",shouldUpdate:!0,help:i("only images (jpeg, png etc..) allowed")},r.a.createElement($t.a,{action:"/api/orgs/logo-upload",accept:"image/*",headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))},listType:"picture-card"},i("upload")))),r.a.createElement(Ut.a,{span:12},r.a.createElement(Bt.a.Item,{label:i("Back Image"),name:"backImage",rules:p.backImageUrl,getValueFromEvent:Cn,valuePropName:"fileList",shouldUpdate:!0,help:i("only images (jpeg, png etc..) allowed")},r.a.createElement($t.a,{action:"/api/orgs/logo-upload",accept:"image/*",headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))},listType:"picture-card"},i("upload"))))))))};var jn=function(e){var t=e.urls,a=e.onClose,l=Object(n.useState)(t[0]),c=Object(d.a)(l,2),o=c[0],i=c[1];return r.a.createElement(Mt.a,{visible:!0,onCancel:a,footer:null,width:1e3},r.a.createElement("div",{style:{display:"grid",gridTemplateColumns:"80px auto",height:450}},r.a.createElement("div",{style:{textAlign:"center",borderRight:"1px solid #aaa",paddingRight:16}},t.map((function(e){return r.a.createElement("div",{style:{borderWidth:o===e?3:0,borderStyle:"solid",marginBottom:16,borderColor:"teal"}},r.a.createElement("img",{key:e,style:{maxWidth:"100%",height:60,objectFit:"contain"},src:e,onClick:function(){return i(e)}}))}))),r.a.createElement("div",{style:{display:"flex",alignItems:"center",minHeight:0,justifyContent:"center",padding:16}},r.a.createElement("img",{style:{maxWidth:"100%",maxHeight:"100%",objectFit:"contain"},src:o}))))},Sn=a(837),In=new Intl.NumberFormat("pt-BR",{maximumFractionDigits:2,minimumFractionDigits:2}),wn=["teal","blue","orange"];function xn(e){var t=e.cheques;return r.a.createElement("ul",null,t.map((function(e,t){return r.a.createElement("li",{style:{fontSize:10,whiteSpace:"nowrap",textOverflow:"ellipsis"},key:e._id},r.a.createElement("i",{style:{color:wn[t%wn.length],marginRight:4}},"\u29bf"),e.no," (",e.status,") (",In.format(e.amount),")")})))}var kn=function(e){var t=e.cheques,a=e.onClose,n=t.reduce((function(e,t){var a=W()(1e3*t.date).format("DD/MM/YYYY"),n=W()(1e3*t.destinationDate).format("DD/MM/YYYY"),r=e[a]||[],l=e[n]||[];return r.push(t),l.push(t),e[a]=r,e[n]=l,e}),{}),l=t.reduce((function(e,t){var a=W()(1e3*t.date).format("MM/YYYY"),n=W()(1e3*t.destinationDate).format("MM/YYYY"),r=e[a]||[],l=e[n]||[];return r.push(t),l.push(t),e[a]=r,e[n]=l,e}),{});return r.a.createElement(Mt.a,{visible:!0,onCancel:a,width:"95%",bodyStyle:{height:"80vh",overflowY:"auto"},footer:null},r.a.createElement(Sn.a,{fullscreen:!0,dateCellRender:function(e){var t=n[e.format("DD/MM/YYYY")];return t?r.a.createElement(xn,{cheques:t}):null},monthCellRender:function(e){var t=l[e.format("MM/YYYY")];return t?r.a.createElement(xn,{cheques:t}):null}}),",")},Nn={new:"teal",canceled:"orange",good:"blue",compensated:void 0,other:void 0,returned:void 0},Tn=[{value:"new",text:"New"},{value:"good",text:"Good"},{value:"compensated",text:"Compensate"},{value:"canceled",text:"Cancel",confirm:!0},{value:"returned",text:"Return"},{value:"other",text:"Other",confirmWithComment:!0}],Pn={SUCCESS:function(e,t){return"".concat(e," ").concat(t).concat(t.endsWith("e")?"":"e","d successfully!")},ERROR:function(e,t){return"status change"===t?"failed to change status of ".concat(e):"failed to ".concat(t," ").concat(e)}};var Dn=function(e){var t=e.addToast,a=Object(pe.a)(["translation"]).t,l=function(){var e=Object(n.useContext)(N);return ne("/api/cheques?organizationId=".concat(e||""),"*")}(),c=Object(d.a)(l,8),o=c[0],i=c[1],u=i.total,s=i.pages,p=c[2],E=c[3],f=c[4],v=c[5],g=c[6],b=c[7],h=function(){var e=Object(n.useState)([]),t=Object(d.a)(e,2),a=Object(d.a)(t[0],3),r=a[0],l=a[1],c=a[2],o=t[1],i=Object(n.useMemo)((function(){return"add"===c&&l?["/api/cheques",{method:"POST",body:JSON.stringify(l)}]:"update"===c&&r&&l?["/api/cheques/".concat(r),{method:"PUT",body:JSON.stringify(l)}]:"delete"===c&&r?["/api/cheques/".concat(r),{method:"DELETE"}]:"status change"===c&&r&&l?["/api/cheques/".concat(r,"/status"),{method:"POST",body:JSON.stringify(l)}]:[void 0,void 0]}),[l,c,r]),u=M.apply(void 0,Object(B.a)(i)),s=Object(d.a)(u,2)[1];return c&&(s.action=c,s.message=Pn[s.code]?Pn[s.code]("cheque",c):""),{add:function(e){return o([void 0,e,"add"])},edit:function(e,t){return o([t,e,"update"])},del:function(e){return o([e,void 0,"delete"])},reset:function(){return o([])},changeStatus:function(e,t){return o([t,e,"status change"])},status:s}}(),y=h.add,C=h.edit,O=h.del,j=h.changeStatus,S=h.reset,I=h.status,w=Object(n.useState)(!1),k=Object(d.a)(w,2),T=k[0],P=k[1],D=Object(n.useState)(!1),R=Object(d.a)(D,2),A=R[0],F=R[1],L=Object(n.useState)(),V=Object(d.a)(L,2),z=V[0],H=V[1],_=Object(n.useState)(),U=Object(d.a)(_,2),q=U[0],Y=U[1],J=Object(n.useState)(),G=Object(d.a)(J,2),K=G[0],X=G[1],Q=function(){return P(!1)},$=function(){return H(void 0)},Z=function(e){return function(){return H(e)}},ee=function(){return Y(void 0)},te=function(e,t){E(t.activePage)},ae=function(e){return function(t,a){j({status:a.value,comment:a.comment},e)}};Object(n.useEffect)((function(){(I.isError||I.isSuccess)&&(t(I.message,{appearance:I.toString().toLowerCase()}),I.isSuccess&&(Q(),$(),ee(),b()))}),[I]),Object(n.useEffect)((function(){!T&&"add"===I.action&&I.isSuccess&&S()}),[T,I.action,I.isSuccess]);var re=Object(n.useMemo)((function(){return Tn.map((function(e){return Object(m.a)(Object(m.a)({},e),{},{text:a(e.text)})}))}),[a]);return r.a.createElement("div",{className:"container"},r.a.createElement("h2",null,a("Cheques")),r.a.createElement("div",{className:"list-actions"},r.a.createElement("span",null,a("Total"),": ",u),r.a.createElement("div",{style:{marginLeft:16,marginRight:16}},r.a.createElement(mt.a,{type:"text",placeholder:a("Search"),onChange:function(e){return p(e.target.value)},value:v.searchText,icon:r.a.createElement(pt.a,{name:"delete",onClick:function(){return p("")},circular:!0,link:!0})})),r.a.createElement(x.a,{onClick:function(){return F(!0)},icon:"calendar alternate outline"}),r.a.createElement(ma,{type:"primary",className:"generic-create-btn",onClick:function(){return P(!0)}},a("Add")," ",a("Cheque"))),r.a.createElement(Ea,{status:g},(function(){return r.a.createElement(dt.a,{sortable:!0},r.a.createElement(dt.a.Header,null,r.a.createElement(dt.a.Row,null,r.a.createElement(dt.a.HeaderCell,null,a("Actions")),r.a.createElement(dt.a.HeaderCell,null,a("Status")),r.a.createElement(dt.a.HeaderCell,null,a("Cheque No")),r.a.createElement(dt.a.HeaderCell,{sorted:"date"===v.sort.by?v.sort.direction:null,onClick:function(){return f("date","descending"===v.sort.direction?"ascending":"descending")}},a("Cheque Date")),r.a.createElement(dt.a.HeaderCell,null,a("Agency No")),r.a.createElement(dt.a.HeaderCell,null,a("Account No")),r.a.createElement(dt.a.HeaderCell,{sorted:"holder"===v.sort.by?v.sort.direction:null,onClick:function(){return f("holder","descending"===v.sort.direction?"ascending":"descending")}},a("Holder")),r.a.createElement(dt.a.HeaderCell,null,a("To")),r.a.createElement(dt.a.HeaderCell,null,a("Amount")),r.a.createElement(dt.a.HeaderCell,null,a("Destination")),r.a.createElement(dt.a.HeaderCell,null,a("Images")))),r.a.createElement(dt.a.Body,null,o.map((function(e){return r.a.createElement(dt.a.Row,{key:e._id},r.a.createElement(dt.a.Cell,null,r.a.createElement(x.a,{icon:"edit",basic:!0,onClick:Z(e),size:"mini"}),r.a.createElement(x.a,{icon:"trash alternate",negative:!0,basic:!0,onClick:(t=e._id,function(){return Y(t)}),size:"mini"})),r.a.createElement(dt.a.Cell,{style:{width:160}},r.a.createElement(At,{options:re,onChange:ae(e._id),defaultValue:e.status,color:Nn[e.status],size:"mini",basic:!0},e.status.toUpperCase()),"other"===e.status&&r.a.createElement(r.a.Fragment,null,r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("strong",null,a("Comment"),": "),e.comment)),r.a.createElement(dt.a.Cell,null,e.no),r.a.createElement(dt.a.Cell,null,W()(1e3*e.date).format("DD/MM/YYYY")),r.a.createElement(dt.a.Cell,null,e.agencyNo),r.a.createElement(dt.a.Cell,null,e.accountNo),r.a.createElement(dt.a.Cell,null,e.holder),r.a.createElement(dt.a.Cell,null,e.to),r.a.createElement(dt.a.Cell,null,Pt.format(e.amount)),r.a.createElement(dt.a.Cell,null,r.a.createElement(pt.a,{name:"user outline"}),e.destinationName,r.a.createElement("br",null),r.a.createElement(pt.a,{name:"building outline"}),e.destinationBank,r.a.createElement("br",null),r.a.createElement(pt.a,{name:"calendar alternate outline"}),W()(1e3*e.destinationDate).format("DD/MM/YYYY")),r.a.createElement(dt.a.Cell,null,(e.frontImageUrl||e.backImageUrl)&&r.a.createElement(x.a,{basic:!0,icon:"images outline",size:"mini",onClick:function(){return X(["/uploads/".concat(e.frontImageUrl),"/uploads/".concat(e.backImageUrl)])}})));var t}))),r.a.createElement(dt.a.Footer,null,r.a.createElement(dt.a.Row,null,r.a.createElement(dt.a.HeaderCell,{colSpan:"20",style:{textAlign:"right"}},r.a.createElement(Et.a,{activePage:v.currentPage,totalPages:s,onPageChange:te})))))})),T&&r.a.createElement(On,{onSave:y,okText:"Add Cheque",okButtonProps:{disabled:I.isLoading},onClose:Q}),z&&r.a.createElement(On,{onSave:function(e){return C(e,z._id)},onClose:$,initialValues:z,okButtonProps:{disabled:I.isLoading},okText:"Update Cheque"}),q&&r.a.createElement(Rt.a,{open:!0,content:"Are you sure you want to DELETE this cheque ?",onCancel:ee,onConfirm:function(){return O(q)},cancelButton:"No",confirmButton:"Yes, Delete"}),K&&r.a.createElement(jn,{urls:K,onClose:function(){return X(void 0)}}),A&&r.a.createElement(kn,{cheques:o,onClose:function(){return F(!1)}}))},Rn=Ht.a.TextArea,An={required:!0},Fn={name:[An],type:[An],frequency:[An],issueDate:[An],dueDate:[An],moneySource:[An],paymentMethod:[An],amount:[An],lateFee:[An],receiptUrl:[An],invoiceUrl:[An],numTimes:[{min:1,type:"number"}],fixedAmount:[An,{min:1,type:"number"}],variableAmount:[{min:1,type:"number"}]},Ln={frequency:"monthly",type:"utility",receipt:[],invoice:[],fixed:!0,chequeIds:[]},Vn=function(e){return{url:e,name:e,status:"done",uid:e}};var zn=function(e){var t=e.onClose,a=e.okText,n=e.okButtonProps,l=e.onSave,c=e.initialValues,o=Object(pe.a)(["translation"]).t,i=Bt.a.useForm(),u=Object(d.a)(i,1)[0],s=function(e){var t=M("/api/departments-with-profits"),a=Object(d.a)(t,3),n=a[0],r=void 0===n?[]:n,l=a[1],c=a[2];return[r.filter((function(t){return!e||t.organizationId===e})),l,c]}(null===c||void 0===c?void 0:c.organizationId),p=Object(d.a)(s,2),E=p[0],f=void 0===E?[]:E,v=p[1],g=c?Object(m.a)(Object(m.a)({},c),{},{amount:c.amount,lateFee:c.lateFee||0,issueDate:c.issueDate?W()(1e3*c.issueDate):void 0,dueDate:c.dueDate?W()(1e3*c.dueDate):void 0,receipts:(c.receipts||[]).map((function(e){var t=e.url;return Vn(t)})),invoices:(c.invoices||[]).map((function(e){var t=e.url;return Vn(t)}))}):Ln,b=f.filter((function(e){return e.profit>0})).map((function(e){return{label:"".concat(e.title," (").concat(Pt.format(e.profit),")"),value:e._id}}));return r.a.createElement(dn.a,{componentSize:"middle"},r.a.createElement(Mt.a,{title:a,onClose:t,visible:!0,okText:a,okButtonProps:Object(m.a)({form:"expense-add-modal",htmlType:"submit"},n),onCancel:t,width:1024,maskClosable:!1,keyboard:!1},r.a.createElement(Bt.a,{layout:"vertical",id:"expense-add-modal",form:u,initialValues:g,onFinish:function(e){l(Object(m.a)(Object(m.a)({},e),{},{numTimes:Number(e.numTimes),moneySourceId:e.moneySourceId||void 0,issueDate:e.issueDate.unix(),dueDate:e.dueDate.unix(),amount:e.amount,lateFee:e.lateFee}))}},r.a.createElement(_t.a,{gutter:16},r.a.createElement(Ut.a,{span:6},r.a.createElement(Bt.a.Item,{label:o("Title"),name:"name",rules:Fn.name},r.a.createElement(Ht.a,null))),r.a.createElement(Ut.a,{span:4},r.a.createElement(Bt.a.Item,{label:o("Type"),name:"type",rules:Fn.type},r.a.createElement(Yt.a,null,r.a.createElement(Yt.a.Option,{value:"utility"},o("Utility")),r.a.createElement(Yt.a.Option,{value:"salary"},o("Salary")),r.a.createElement(Yt.a.Option,{value:"rent"},o("Rent")),r.a.createElement(Yt.a.Option,{value:"purchase"},o("Purchase"))))),r.a.createElement(Ut.a,null,r.a.createElement(Bt.a.Item,{label:o("Frequency"),name:"frequency",rules:Fn.frequency},r.a.createElement(qt.a.Group,null,r.a.createElement(qt.a.Button,{value:"daily"},o("Daily")),r.a.createElement(qt.a.Button,{value:"weekly"},o("Weekly")),r.a.createElement(qt.a.Button,{value:"monthly"},o("Monthly")),r.a.createElement(qt.a.Button,{value:"custom"},o("Custom"))))),r.a.createElement(Ut.a,{span:4},r.a.createElement(Bt.a.Item,{noStyle:!0,shouldUpdate:!0},(function(e){var t=e.getFieldValue;return r.a.createElement(Bt.a.Item,{label:"\u2800",name:"numTimes",rules:Fn.numTimes,trigger:"onValueChange",getValueFromEvent:function(e){return e.floatValue}},r.a.createElement(Gt.a,{customInput:function(e){return r.a.createElement(Ht.a,Object.assign({},e,{suffix:"times"}))},thousandSeparator:".",decimalSeparator:",",disabled:"custom"!==t("frequency")}))})))),r.a.createElement(_t.a,{gutter:16},r.a.createElement(Ut.a,{span:9},r.a.createElement(Bt.a.Item,{label:o("Source of Money"),name:"moneySourceId"},r.a.createElement(Yt.a,{options:b,loading:v.isLoading,allowClear:!0}))),r.a.createElement(Ut.a,{span:5},r.a.createElement(Bt.a.Item,{label:o("Issue Date"),name:"issueDate",rules:Fn.issueDate},r.a.createElement(pn.a,{style:{width:"100%"}}))),r.a.createElement(Ut.a,{span:5},r.a.createElement(Bt.a.Item,{label:o("Due Date"),name:"dueDate",rules:Fn.dueDate},r.a.createElement(pn.a,{style:{width:"100%"}}))),r.a.createElement(Ut.a,{span:5},r.a.createElement(Bt.a.Item,{noStyle:!0,shouldUpdate:!0},(function(e){var t=e.getFieldValue;return r.a.createElement(Bt.a.Item,{label:o("Fixed or Variable"),name:"fixed",rules:Fn.fixed},r.a.createElement(qt.a.Group,{disabled:"1"===t("numTimes")&&"custom"===t("frequency")},r.a.createElement(qt.a.Button,{value:!0},o("Fixed")),r.a.createElement(qt.a.Button,{value:!1},o("Variable"))))})))),r.a.createElement(_t.a,{gutter:16},r.a.createElement(Ut.a,{span:6},r.a.createElement(Bt.a.Item,{dependencies:["fixed"],noStyle:!0},(function(e){var t=e.getFieldValue;return r.a.createElement(Bt.a.Item,{label:o("Amount (single time)"),name:"amount",rules:t("fixed")?Fn.fixedAmount:Fn.variableAmount,trigger:"onValueChange",getValueFromEvent:function(e){return e.floatValue||0}},r.a.createElement(Gt.a,{customInput:Ht.a,thousandSeparator:".",decimalSeparator:","}))}))),r.a.createElement(Ut.a,{span:3},r.a.createElement(Bt.a.Item,{label:o("Late Fee"),name:"lateFee"},r.a.createElement(ua,null)))),r.a.createElement(Bt.a.Item,{name:"description",label:o("Description")},r.a.createElement(Rn,{rows:6})))))},Mn={SUCCESS:function(e,t){return"".concat(e," ").concat(t).concat(t.endsWith("e")?"":"e","d successfully!")},ERROR:function(e,t){return"status change"===t?"failed to change status of ".concat(e):"failed to ".concat(t," ").concat(e)}};var Bn=function(e){var t=e.addToast,a=Object(pe.a)(["translation"]).t,l=be(),c=l.data,o=l.total,i=l.pages,u=l.search,s=l.goto,m=l.sort,E=l.filters,f=l.status,v=l.refresh,g=function(){var e=new URLSearchParams(window.location.search);return e.get("create")?{name:e.get("name"),type:e.get("type"),description:e.get("description"),amount:Number(e.get("amount")),numTimes:Number(e.get("numTimes")),frequency:e.get("frequency"),shouldAdd:!!e.get("create"),fixed:"true"===e.get("fixed")}:void 0}(),b=function(){var e=Object(n.useState)([]),t=Object(d.a)(e,2),a=Object(d.a)(t[0],3),r=a[0],l=a[1],c=a[2],o=t[1],i=Object(n.useMemo)((function(){return"add"===c&&l?["/api/expenses",{method:"POST",body:JSON.stringify(l)}]:"update"===c&&r&&l?["/api/expenses/".concat(r),{method:"PUT",body:JSON.stringify(l)}]:"delete"===c&&r?["/api/expenses/".concat(r),{method:"DELETE"}]:[void 0,void 0]}),[l,c,r]),u=M.apply(void 0,Object(B.a)(i)),s=Object(d.a)(u,2)[1];return s.action=c,s.message=Mn[s.code]?Mn[s.code]("expense",c):"",{add:function(e){return o([void 0,e,"add"])},edit:function(e,t){return o([t,e,"update"])},del:function(e){return o([e,void 0,"delete"])},changeStatus:function(e,t){return o([t,e,"status change"])},status:s}}(),h=b.add,y=b.edit,C=b.del,O=(b.changeStatus,b.status),j=Object(n.useState)(!!(null===g||void 0===g?void 0:g.shouldAdd)),S=Object(d.a)(j,2),I=S[0],w=S[1],k=Object(n.useState)(),N=Object(d.a)(k,2),T=N[0],P=N[1],D=Object(n.useState)(),R=Object(d.a)(D,2),A=R[0],F=R[1],L=function(){return w(!1)},V=function(){return P(void 0)},z=function(){return F(void 0)},H=function(e,t){s(t.activePage)};return Object(n.useEffect)((function(){(O.isError||O.isSuccess)&&(t(O.message,{appearance:O.toString().toLowerCase()}),O.isSuccess&&(L(),V(),z(),v()))}),[O]),r.a.createElement("div",{className:"container"},r.a.createElement("h2",null,a("Expenses")),r.a.createElement("div",{className:"list-actions"},r.a.createElement("span",null,a("Total"),": ",o),r.a.createElement("div",{style:{marginLeft:16}},r.a.createElement(mt.a,{type:"text",placeholder:a("Search"),onChange:function(e){return u(e.target.value)},value:E.searchText,icon:r.a.createElement(pt.a,{name:"delete",onClick:function(){return u("")},circular:!0,link:!0})})),r.a.createElement(ma,{type:"primary",className:"generic-create-btn",onClick:function(){return w(!0)}},a("Add")," ",a("Expense"))),r.a.createElement(Ea,{status:f},(function(){return r.a.createElement(dt.a,{sortable:!0},r.a.createElement(dt.a.Header,null,r.a.createElement(dt.a.Row,null,r.a.createElement(dt.a.HeaderCell,null,a("Actions")),r.a.createElement(dt.a.HeaderCell,null,a("Title")),r.a.createElement(dt.a.HeaderCell,{sorted:"issueDate"===E.sort.by?E.sort.direction:null,onClick:function(){return m("issueDate","descending"===E.sort.direction?"ascending":"descending")}},a("Issue Date")),r.a.createElement(dt.a.HeaderCell,{sorted:"dueDate"===E.sort.by?E.sort.direction:null,onClick:function(){return m("dueDate","descending"===E.sort.direction?"ascending":"descending")}},a("Due Date")),r.a.createElement(dt.a.HeaderCell,null,a("Frequency")),r.a.createElement(dt.a.HeaderCell,null,a("Source")),r.a.createElement(dt.a.HeaderCell,null,a("Cheque")),r.a.createElement(dt.a.HeaderCell,null,"Amount"))),r.a.createElement(dt.a.Body,null,c.map((function(e){var t,n,l;return r.a.createElement(dt.a.Row,{key:e._id},r.a.createElement(dt.a.Cell,null,r.a.createElement(x.a,{icon:"edit",basic:!0,onClick:(l=e,function(){return P(l)}),size:"mini"}),r.a.createElement(x.a,{icon:"trash alternate",negative:!0,basic:!0,onClick:(n=e._id,function(){return F(n)}),size:"mini"})),r.a.createElement(dt.a.Cell,null,r.a.createElement(p.a,{to:"/expenses/".concat(e._id)},"(",e.type,") ",e.name)),r.a.createElement(dt.a.Cell,null,W()(1e3*e.issueDate).format("DD/MM/YYYY")),r.a.createElement(dt.a.Cell,null,W()(1e3*e.dueDate).format("DD/MM/YYYY")),r.a.createElement(dt.a.Cell,null,e.frequency),r.a.createElement(dt.a.Cell,null,null===(t=e.moneySource)||void 0===t?void 0:t.title),r.a.createElement(dt.a.Cell,null,e.cheques.map((function(e){var t=e.no,a=e.amount;return r.a.createElement("a",{key:t,style:{display:"block"},target:"_blank",href:"/cheques"},"(",t,") ",Pt.format(a))}))),r.a.createElement(dt.a.Cell,null,Pt.format(e.amount),r.a.createElement("br",null),a("Late Fee"),": ",Pt.format(e.lateFee),r.a.createElement("br",null),e.fixed?"(".concat(a("Fixed"),")"):"(".concat(a("Variable"),")")))}))),r.a.createElement(dt.a.Footer,null,r.a.createElement(dt.a.Row,null,r.a.createElement(dt.a.HeaderCell,{colSpan:"20",style:{textAlign:"right"}},r.a.createElement(Et.a,{activePage:E.currentPage,totalPages:i,onPageChange:H})))))})),I&&r.a.createElement(zn,{onSave:h,okText:"".concat(a("Add")," ").concat(a("Expense")),okButtonProps:{disabled:O.isLoading},onClose:L,initialValues:g}),T&&r.a.createElement(zn,{onSave:function(e){return y(e,T._id)},onClose:V,initialValues:T,okButtonProps:{disabled:O.isLoading},okText:"".concat(a("Update")," ").concat(a("Expense"))}),A&&r.a.createElement(Rt.a,{open:!0,content:"".concat(a("Are you sure you want to delete")," ?"),onCancel:z,onConfirm:function(){return C(A)},cancelButton:a("No"),confirmButton:a("Delete")}))},Hn=a(818);var _n=function(e){var t=e.className,a=e.revenue,n=e.cost,l=e.collected,c=e.notCollected,o=e.label,i=e.value,u=e.labelLink,s=Object(pe.a)("translation").t;return r.a.createElement("div",{className:"".concat(t," card")},r.a.createElement("div",{className:"main"},Pt.format(a-n)),r.a.createElement("div",{className:"below"},r.a.createElement("span",{style:{fontSize:12,color:"gray"}},s("Revenue"),":",r.a.createElement("br",null),r.a.createElement("span",{className:"revenue"},Pt.format(a))),r.a.createElement("span",{style:{fontSize:12,color:"gray"}},s("Cost"),":",r.a.createElement("br",null),r.a.createElement("span",{className:"cost"},Pt.format(n)))),r.a.createElement("div",{className:"below"},void 0!==l&&r.a.createElement("span",{style:{fontSize:12,color:"gray"}},s("Collected"),":",r.a.createElement("br",null),r.a.createElement("span",{className:"collected"},Pt.format(l))),void 0!==c&&r.a.createElement("span",{style:{fontSize:12,color:"gray"}},s("Yet to collect"),":",r.a.createElement("br",null),r.a.createElement("span",{className:"needtocollect"},Pt.format(c)))),r.a.createElement("div",{className:"side-by-side"},u?r.a.createElement(p.a,{to:u},o,": ",i):"".concat(o,": ").concat(i)))},Un="Partial",qn="Paid",Yn="Not Paid",Jn="Next Month Expense",Gn="Late Payment",Wn=function(e){return e.reduce((function(e,t){return t.payments.reduce((function(e,t){return e+t.amount}),0)+e}),0)},Kn=function(e){return e.reduce((function(e,t){return t.amount+e}),0)};var Xn=function(){var e=Object(pe.a)("translation").t,t=M("/api/expenses/stats"),a=Object(d.a)(t,2),n=a[0],l=void 0===n?{}:n,c=a[1];return r.a.createElement("div",{className:"expense-stats-container"},r.a.createElement("h3",{style:{textTransform:"uppercase"}},e("Expense Stats")),r.a.createElement(Ea,{status:c},(function(){return r.a.createElement("div",{className:"expense-stats"},r.a.createElement("div",{className:"card"},r.a.createElement("div",{className:"main"},l.total),r.a.createElement("div",{className:"side-by-side"},e("Total Expenses"))),r.a.createElement("div",{className:"card"},r.a.createElement("div",{className:"main"},Pt.format(Wn(l.paid))),r.a.createElement("div",{className:"below"}),r.a.createElement("div",{className:"side-by-side"},e(qn),": ",l.paid.length)),r.a.createElement("div",{className:"card"},r.a.createElement("div",{className:"main"},Pt.format(Wn(l.partial))),r.a.createElement("div",{className:"below"}),r.a.createElement("div",{className:"side-by-side"},e(Un),": ",l.partial.length)),r.a.createElement("div",{className:"card"},r.a.createElement("div",{className:"main"},Pt.format(Kn(l.notpaid))),r.a.createElement("div",{className:"below"}),r.a.createElement("div",{className:"side-by-side"},e(Yn),": ",l.notpaid.length)),r.a.createElement("div",{className:"card"},r.a.createElement("div",{className:"main"},Pt.format(Kn(l.nextMonthExpense))),r.a.createElement("div",{className:"below"}),r.a.createElement("div",{className:"side-by-side"},e(Jn),": ",l.nextMonthExpense.length)),r.a.createElement("div",{className:"card"},r.a.createElement("div",{className:"main"},Pt.format(Kn(l.dues))),r.a.createElement("div",{className:"below"}),r.a.createElement("div",{className:"side-by-side"},e(Gn),": ",l.dues.length)))})),r.a.createElement(Hn.a,null))},Qn=a(851),$n=(a(781),pn.a.RangePicker),Zn={organizations:"Organizations",branches:"Branches",products:"Products",brands:"Brands",reps:"Representants",departments:"Departments"},er={open:"future-commission",closed:"paid-commission",partial:"generated-commission",quotations:"potential-commission",canceled:"lost-commission"};function tr(e){var t=e.data,a=e.dashboard,n=t.partial.revenue+t.closed.revenue-t.partial.cost-t.closed.cost,l=n-a.totalexpenses,c=Object(pe.a)("translation").t;return r.a.createElement("div",{className:"card"},r.a.createElement("div",{className:"main",style:{color:l<0?"#d3131d":""}},Pt.format(l)),r.a.createElement("div",{className:"below"},r.a.createElement("span",{style:{fontSize:12,color:"gray"}},c("Profit"),":",r.a.createElement("br",null),r.a.createElement("span",{className:"revenue"},Pt.format(n))),r.a.createElement("span",{style:{fontSize:12,color:"gray"}},c("Expense"),":",r.a.createElement("br",null),r.a.createElement("span",{className:"cost"},Pt.format(a.totalexpenses)))),r.a.createElement("div",{className:"side-by-side"},r.a.createElement("div",null,c("Real Profits"))))}var ar=function(e){e.history;var t=Object(n.useContext)(T).user,a=Object(n.useState)({range:"alltime",value:[void 0,void 0]}),l=Object(d.a)(a,2),c=l[0],o=l[1],i=Object(pe.a)("translation").t,u=new URLSearchParams([["from",c.value[0]?c.value[0].unix():""],["to",c.value[1]?c.value[1].unix():""]]),s=M("/api/orders-stats?".concat(u)),E=Object(d.a)(s,2),f=E[0],v=void 0===f?{}:f,g=E[1],b=M("/api/dashboard?".concat(u)),h=Object(d.a)(b,2),y=h[0],C=void 0===y?{}:y,O=h[1],j=M("/api/products-stats?".concat(u)),S=Object(d.a)(j,2),I=S[0],w=void 0===I?[]:I,x=S[1],k=M("/api/orders/aggregations/process-status?".concat(u)),N=Object(d.a)(k,2),P=N[0],D=void 0===P?[]:P,R=N[1],A=Object(n.useState)(!1),F=Object(d.a)(A,2),L=F[0],V=F[1],z=0,B=0,H=0,_=0,U=0;g.isSuccess&&(z=v.open.revenue+v.closed.revenue+v.partial.revenue,B=v.open.cost+v.closed.cost+v.partial.cost,H=v.open.orders+v.closed.orders+v.partial.orders,_=v.closed.revenue+v.partial.collected,U=v.open.revenue+(v.partial.revenue-v.partial.collected)),g.isSuccess&&O.isSuccess&&(v.partial.revenue,v.closed.revenue,v.partial.cost,v.closed.cost,C.totalexpenses);var q={products:0,worthPrice:0,worthCost:0};x.isSuccess&&(q=w.reduce((function(e,t){return{products:e.products+t.total,worthPrice:e.worthPrice+t.worthPrice,worthCost:e.worthCost+t.worthCost}}),q));var Y=w.sort((function(e,t){return t.worthPrice-t.worthCost-(e.worthPrice-e.worthCost)})).slice(0,5),J=null===C||void 0===C?void 0:C.allrepearnings;return r.a.createElement("div",{className:"dashboard"},r.a.createElement("div",{className:"filters"},r.a.createElement("div",null,r.a.createElement("span",{style:{marginRight:16}},i("See by date range")),r.a.createElement(qt.a.Group,{onChange:function(e){var t=e.target.value;switch(t){case"alltime":o({range:t,value:[void 0,void 0]});break;case"last30days":o({range:t,value:[W()().subtract(30,"days"),void 0]});break;case"today":o({range:t,value:[W()().startOf("day"),void 0]});break;case"custom":o({range:t,value:[W()().subtract(14,"days"),void 0]})}},defaultValue:c.range},r.a.createElement(qt.a,{value:"alltime"},i("All Time")),r.a.createElement(qt.a,{value:"last30days"},i("Last 30 days")),r.a.createElement(qt.a,{value:"today"},i("Today")),r.a.createElement(qt.a,{value:"custom"},i("Custom"))),r.a.createElement($n,{onChange:function(e){o((function(t){return Object(m.a)(Object(m.a)({},t),{},{value:null===e?[void 0,void 0]:e})}))},defaultValue:[W()().subtract(14,"days"),W()()],disabled:"custom"!==c.range}))),r.a.createElement("div",{className:"dashboard-inner",style:{maxWidth:1e3,margin:"auto"}},g.isLoading&&r.a.createElement(it.a,{active:g.isLoading},r.a.createElement(ut.a,null)),r.a.createElement("div",{className:"space-between margin-bottom"},r.a.createElement("h3",{style:{textTransform:"uppercase"}},i("Dashboard Reports")),r.a.createElement(Qt.a,{icon:r.a.createElement(Qn.a,null),onClick:function(){return V(!0)}},i("Print"))),[1,2].includes(t.roleNumber)&&g.isSuccess&&r.a.createElement("div",{className:"statisticsv2"},r.a.createElement(_n,{className:"open",labelLink:"/orders?paymentStatus=1",revenue:v.open.revenue,cost:v.open.cost,label:i("Open"),value:v.open.orders}),r.a.createElement(_n,{className:"partial",labelLink:"/orders?paymentStatus=2",revenue:v.partial.revenue,cost:v.partial.cost,collected:v.partial.collected,notCollected:v.partial.revenue-v.partial.collected,label:i("Partial"),value:v.partial.orders}),r.a.createElement(_n,{className:"quotations",labelLink:"/orders?paymentStatus=4",revenue:v.quotations.revenue,cost:v.quotations.cost,label:i("Quotations"),value:v.quotations.orders}),r.a.createElement(_n,{className:"closed",labelLink:"/orders?paymentStatus=3",revenue:v.closed.revenue,cost:v.closed.cost,label:i("Closed"),value:v.closed.orders}),r.a.createElement("div",{className:"card org-stats"},O.isSuccess&&r.a.createElement("div",{className:"wrapper"},r.a.createElement("div",{className:"main"},C.clients),r.a.createElement("div",{className:"below"},i("Clients")))),r.a.createElement(_n,{className:"canceled",revenue:v.canceled.revenue,cost:v.canceled.cost,label:i("Canceled"),value:v.canceled.orders,labelLink:"/orders?status=9"}),r.a.createElement(_n,{revenue:z,cost:B,collected:_,notCollected:U,label:i("Placed Orders"),value:H,labelLink:"/orders"}),r.a.createElement("div",{className:"card org-stats"},O.isSuccess&&r.a.createElement("div",{className:"wrapper"},r.a.createElement("div",{className:"main"},C.orders),r.a.createElement("div",{className:"below"},i("Orders")))),r.a.createElement(_n,{revenue:q.worthPrice,cost:q.worthCost,label:i("Products Registered"),value:q.products,labelLink:"/products"}),r.a.createElement("div",{className:"card org-stats"},O.isSuccess&&r.a.createElement("div",{className:"wrapper"},r.a.createElement("div",{className:"main"},Pt.format(C.topreps.reduce((function(e,t){return e+t.earnings}),0))),r.a.createElement("div",{className:"below"},i("Rep Orders"),": ",C.topreps.reduce((function(e,t){return e+t.orders}),0)))),g.isSuccess&&O.isSuccess&&r.a.createElement(tr,{data:v,dashboard:C})),O.isLoading&&r.a.createElement(it.a,{active:O.isLoading},r.a.createElement(ut.a,null)),r.a.createElement(Hn.a,null),[1,2].includes(t.roleNumber)&&O.isSuccess&&r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"org-statsv2"},Object.entries(Zn).filter((function(e){var a=Object(d.a)(e,1)[0];return 2!==t.roleNumber||"organizations"!==a})).map((function(e){var t=Object(d.a)(e,2),a=t[0],n=t[1];return r.a.createElement("div",{className:"wrapper simplecard",key:a},r.a.createElement("div",{className:"main"},C[a]||0),r.a.createElement("div",{className:"below"},i(n)))}))),r.a.createElement(Hn.a,null)),[1,2,3].includes(t.roleNumber)&&R.isSuccess&&r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"order-process-status-counts"},D.filter((function(e){var a=e.id;return!(t.allowedStatuses||[]).length||(t.allowedStatuses||[]).includes(a)})).map((function(e){var t=e.status,a=e.count;return r.a.createElement("div",{className:"wrapper simplecard",key:t,onClick:function(){return Object(p.d)("/orders?status=".concat(t))}},r.a.createElement("div",{className:"main"},a),r.a.createElement("div",{className:"below"},t))}))),r.a.createElement(Hn.a,null)),[1,2].includes(t.roleNumber)&&r.a.createElement(Xn,null),[1,2].includes(t.roleNumber)&&r.a.createElement(r.a.Fragment,null,r.a.createElement("h3",{style:{textTransform:"uppercase"}},i("Top departments")),x.isSuccess&&r.a.createElement("div",{className:"product-statistics"},Y.map((function(e){var t,a,n;return r.a.createElement(_n,{key:null===e||void 0===e||null===(t=e.department)||void 0===t?void 0:t._id,revenue:e.worthPrice,cost:e.worthCost,label:null===e||void 0===e||null===(a=e.department)||void 0===a?void 0:a.title,value:e.total,labelLink:"/products?departmentId=".concat(null===(n=e.department)||void 0===n?void 0:n._id)})}))),r.a.createElement(Hn.a,null)),[1,2].includes(t.roleNumber)&&r.a.createElement(r.a.Fragment,null,r.a.createElement("h3",{style:{textTransform:"uppercase"}},i("Top Representants Earnings")),O.isSuccess&&r.a.createElement("div",{className:"product-statistics"},[0,1,2,3,4,5].map((function(e){return r.a.createElement("div",{className:"card",key:e},C.topreps[e]&&r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"main"},Pt.format(C.topreps[e].earnings)),r.a.createElement("div",{className:"below"}),r.a.createElement("div",{className:"side-by-side"},C.topreps[e].name,": ",C.topreps[e].orders)))}))),r.a.createElement(Hn.a,null)),(3===t.roleNumber&&t.isRep||8===t.roleNumber)&&O.isSuccess&&r.a.createElement("div",{className:"all-rep-earnings"},r.a.createElement("div",{className:"card"},r.a.createElement("div",{className:"wrapper"},r.a.createElement("div",{className:"main"},Pt.format(["open","partial","closed","quotations"].reduce((function(e,t){return(J[er[t]]||0)+e}),0))),r.a.createElement("div",{className:"below"},i("Total"),":"," ",["open","partial","closed","quotations"].reduce((function(e,t){return(J[t]||[]).filter(Boolean).length+e}),0)))),Object.entries(er).map((function(e){var t=Object(d.a)(e,2),a=t[0],n=t[1];return r.a.createElement("div",{className:"card",key:a},r.a.createElement("div",{className:"wrapper"},r.a.createElement("div",{className:"main"},Pt.format(J[n]||0)),r.a.createElement("div",{className:"below"},a,": ",(J[a]||[]).filter(Boolean).length)))})))),L&&r.a.createElement(Mt.a,{onCancel:function(){return V(!1)},visible:!0,width:"95%",bodyStyle:{height:"87vh"},footer:null,centered:!0},r.a.createElement("iframe",{src:"/print-everything?nav=false&".concat(u),width:"100%",height:"100%",title:"Print Everything"})))},nr=a(842),rr=function(){var e=Object(O.a)(C.a.mark((function e(t){var a;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ct({endpoint:"/api/v2/organizations",type:"GET",query:t});case 2:return a=e.sent,e.abrupt("return",a.json());case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),lr=function(){var e=Object(O.a)(C.a.mark((function e(t){var a;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ct({endpoint:"/api/orgs",type:"POST",request:t});case 2:return a=e.sent,e.abrupt("return",a.json());case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),cr=function(){var e=Object(O.a)(C.a.mark((function e(t,a){var n;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ct({endpoint:"/api/orgs/".concat(t),type:"PUT",request:a});case 2:return n=e.sent,e.abrupt("return",n.json());case 4:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),or=(a(782),a(819)),ir=[{value:"pt-BR",label:"Portugu\xeas"},{value:"en-US",label:"English"}],ur=function(e){Object(Ka.a)(a,e);var t=Object(Xa.a)(a);function a(){var e;Object(P.a)(this,a);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(e=t.call.apply(t,[this].concat(r))).state={organizations:[]},e.handleItemClick=function(t,a){var n=a.name;return e.setState({activeItem:n})},e.handleOrganizationChange=function(e){},e}return Object(D.a)(a,[{key:"componentDidMount",value:function(){var e=this;1===this.props.admin.roleNumber?rr().then((function(t){e.setState({organizations:(t.data||[]).filter((function(t){var a=t._id;return!((e.props.admin.organizationIds||[]).length>0)||e.props.admin.organizationIds.includes(a)})).map((function(e){return{value:e._id,label:e.title}}))})})):this.props.onOrganizationChange(this.props.admin.organizationIds[0])}},{key:"render",value:function(){var e=this.props,t=e.logout,a=e.admin,n=e.t,l=e.onLocaleChange,c=e.locale;return r.a.createElement(nr.a,{stackable:!0,className:"custom-menu",inverted:!0},r.a.createElement(nr.a.Item,null,r.a.createElement(p.a,{exact:!0,to:"/",className:"logo-link"},n("Management"))),[1,2,3,4].includes(a.role.roleNumber)&&r.a.createElement(nr.a.Item,null,r.a.createElement(Dt.a,{inverted:!0,text:n("Departament Properties")},r.a.createElement(Dt.a.Menu,null,r.a.createElement(Dt.a.Item,null,r.a.createElement(p.a,{exact:!0,activeClassName:"active",to:"/departments",className:"submenuBtn "},n("Departaments"))),r.a.createElement(Dt.a.Item,null,r.a.createElement(p.a,{exact:!0,activeClassName:"active",to:"/brands",className:"submenuBtn"},n("Brands"))),r.a.createElement(Dt.a.Item,null,r.a.createElement(p.a,{exact:!0,activeClassName:"active",to:"/models",className:"submenuBtn"},n("Models"))),r.a.createElement(Dt.a.Item,null,r.a.createElement(p.a,{exact:!0,activeClassName:"active",to:"/categories",className:"submenuBtn"},n("Categories"))),r.a.createElement(Dt.a.Item,null,r.a.createElement(p.a,{exact:!0,activeClassName:"active",to:"/subcategories",className:"submenuBtn"},n("Subcategories"))),[1,2,3,4].includes(a.role.roleNumber)&&r.a.createElement(Dt.a.Item,{name:n("products"),onClick:this.handleItemClick},r.a.createElement(p.a,{exact:!0,activeClassName:"active",to:"/products",className:"menuBtn"},n("Products")))))),r.a.createElement(nr.a.Item,null,r.a.createElement(Dt.a,{inverted:!0,text:n("Order Properties")},r.a.createElement(Dt.a.Menu,null,r.a.createElement(Dt.a.Item,null,r.a.createElement(p.a,{exact:!0,activeClassName:"active",to:"/orders",className:"menuBtn"},n("Orders"))),[1,2,3,4].includes(a.role.roleNumber)&&r.a.createElement(Dt.a.Item,null,r.a.createElement(p.a,{exact:!0,activeClassName:"active",to:"/clients",className:"menuBtn"},n("Clients"))),[1,2].includes(a.roleNumber)&&r.a.createElement(Dt.a.Item,null,r.a.createElement(p.a,{exact:!0,activeClassName:"active",to:"/tasks",className:"menuBtn"},n("Tasks")))))),[1,2].includes(a.roleNumber)&&r.a.createElement(nr.a.Item,null,r.a.createElement(Dt.a,{inverted:!0,text:n("Administration")},r.a.createElement(Dt.a.Menu,null,[1,2].includes(a.roleNumber)&&r.a.createElement(Dt.a.Item,null,r.a.createElement(p.a,{exact:!0,activeClassName:"active",to:"/orgs",className:"menuBtn"},n("Organizations"))),[1,2].includes(a.roleNumber)&&r.a.createElement(Dt.a.Item,null,r.a.createElement(p.a,{exact:!0,activeClassName:"active",to:"/admins",className:"menuBtn"},n("Admins")))))),[1,2].includes(null===a||void 0===a?void 0:a.roleNumber)&&r.a.createElement(nr.a.Item,null,r.a.createElement(Dt.a,{inverted:!0,text:n("Finance")},r.a.createElement(Dt.a.Menu,null,r.a.createElement(Dt.a.Item,null,r.a.createElement(p.a,{exact:!0,activeClassName:"active",to:"/cheques",className:"menuBtn"},n("Cheque Mgmt"))),r.a.createElement(Dt.a.Item,null,r.a.createElement(p.a,{exact:!0,activeClassName:"active",to:"/expenses",className:"menuBtn"},n("Expense Mgmt")))))),r.a.createElement(nr.a.Item,null,r.a.createElement(Dt.a,{inverted:!0,text:n("Utilities")},r.a.createElement(Dt.a.Menu,null,[1].includes(null===a||void 0===a?void 0:a.roleNumber)&&r.a.createElement(Dt.a.Item,null,r.a.createElement(p.a,{exact:!0,activeClassName:"active",to:"/wood-price-calculator",className:"menuBtn"},n("Wood Price Calculator")))))),[1].includes(null===a||void 0===a?void 0:a.roleNumber)&&r.a.createElement(nr.a.Item,null,r.a.createElement(Yt.a,{style:{width:200},options:this.state.organizations,placeholder:n("Organization"),onChange:this.props.onOrganizationChange,allowClear:!0,value:this.context})),r.a.createElement(nr.a.Item,null,r.a.createElement(Yt.a,{placeholder:"locale",options:ir,onChange:l,defaultValue:c})),r.a.createElement(nr.a.Item,{onClick:t},n("Logout")))}}]),a}(n.Component);ur.contextType=N;var sr=Object(or.a)("translation")(ur),mr=function(){return r.a.createElement(E.a,{as:"h2",icon:!0,textAlign:"center",style:{marginTop:50}},r.a.createElement(pt.a,{name:"frown",circular:!0}),r.a.createElement(E.a.Content,null,r.a.createElement("div",null,"404 Not Found"),"Go to ",r.a.createElement(p.a,{to:"/"},"Home")," page"))},dr=function(){var e=Object(O.a)(C.a.mark((function e(t,a){var n;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ct({endpoint:"/api/models",type:"POST",request:t,organizationId:a});case 2:return n=e.sent,e.abrupt("return",n.json());case 4:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),pr=function(){var e=Object(O.a)(C.a.mark((function e(t,a){var n;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ct({endpoint:"/api/models/".concat(t),type:"PUT",request:a});case 2:return n=e.sent,e.abrupt("return",n.json());case 4:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),Er=function(){var e=Object(O.a)(C.a.mark((function e(t){var a;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ct({endpoint:"/api/models/".concat(t),type:"DELETE"});case 2:return a=e.sent,e.abrupt("return",a.json());case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),fr=function(e){var t=e.model,a=void 0===t?{}:t,l=e.brandOptions,c=e.submit,o=e.addToast,i=e.componentName,u=e.loadModels,s=!!a.title,m=Object(n.useState)(!1),p=Object(d.a)(m,2),E=p[0],f=p[1],v=Object(n.useState)(a.title),g=Object(d.a)(v,2),b=g[0],h=g[1],y=Object(n.useState)(!0),j=Object(d.a)(y,2),S=j[0],w=j[1],k=Object(n.useState)(a.description),N=Object(d.a)(k,2),T=N[0],P=N[1],D=Object(n.useState)(!0),R=Object(d.a)(D,2),A=R[0],F=R[1],L=Object(n.useState)(a.brandId),V=Object(d.a)(L,2),z=V[0],M=V[1],B=Object(n.useState)(!1),H=Object(d.a)(B,2),_=H[0],U=H[1],q=function(){var e=Object(O.a)(C.a.mark((function e(){return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(A&&S&&""!==z&&!_){e.next=3;break}return e.abrupt("return");case 3:return U(!0),e.next=6,c({title:b,description:T,brandId:z}).then((function(e){o("Model ".concat(a.title?"updated":"created"," successfully"),{appearance:"success"}),h(""),P(""),M("")})).catch((function(e){o(e.message,{appearance:"error"})}));case 6:U(!1),J();case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Y=function(){f(!E)},J=function(){u(),Y(),h(""),w(!0),P(""),F(!0),M("")};return r.a.createElement(ft.a,{trigger:r.a.createElement(x.a,{onClick:Y,className:s?"table-action-btn":"generic-create-btn"}," ",s?r.a.createElement(pt.a,{name:"pencil"}):r.a.createElement("span",null,i)),closeIcon:!0,open:E,onClose:J},r.a.createElement(ft.a.Header,null,i," a model"),r.a.createElement(ft.a.Content,null,r.a.createElement(I.a,{name:"createDepForm",size:"large",onSubmit:q},r.a.createElement(I.a.Input,{fluid:!0,placeholder:"Titulo",value:b,error:!S,onChange:function(e){return h(e.target.value)},onBlur:function(){return w(Ya(b,3,0))}}),r.a.createElement(I.a.TextArea,{fluid:!0,placeholder:"Descri\xe7\xe3o",value:T,error:!A,onChange:function(e){return P(e.target.value)},onBlur:function(){return F(Ya(T,5,0))}}),r.a.createElement(I.a.Select,{fluid:!0,label:"Brand",options:l,placeholder:"Brand",onChange:function(e,t){var a=t.value;return M(a)}}),r.a.createElement(x.a,{type:"submit",color:"teal",fluid:!0,size:"small",loading:_,primary:!0},"Submit"))))};fr.defaultProps={model:{},brandsOptions:[]};var vr=fr,gr=function(e){var t=e.title,a=e.id,l=e.addToast,c=e.loadModels,o=Object(n.useState)(!1),i=Object(d.a)(o,2),u=i[0],s=i[1],m=function(){s(!u)};return r.a.createElement(ft.a,{trigger:r.a.createElement(x.a,{className:"table-action-btn",onClick:m},r.a.createElement(pt.a,{name:"trash"})),open:u,onClose:m,closeIcon:!0},r.a.createElement(ft.a.Header,null,"Delete a model"),r.a.createElement(ft.a.Content,null,r.a.createElement("h4",null,"Are you sure you want to delete model ",'"'.concat(t,'"'),"?"),r.a.createElement(x.a,{color:"red",inverted:!0,onClick:function(){Er(a).then((function(e){l("Model deleted successfully",{appearance:"success"})})).catch((function(e){""!==e.message?l("Could not delete model: "+e.message,{appearance:"error"}):l("Something went wrong",{appearance:"error"})})).finally((function(){m(),c()}))}},r.a.createElement(pt.a,{name:"remove"})," Delete"),r.a.createElement(x.a,{color:"blue",inverted:!0,onClick:m},r.a.createElement(pt.a,{name:"checkmark"})," Cancel")))},br=function(e){Object(Ka.a)(a,e);var t=Object(Xa.a)(a);function a(e){var n;return Object(P.a)(this,a),(n=t.call(this,e)).createModelRow=function(e){return r.a.createElement(dt.a.Row,{key:e._id},r.a.createElement(dt.a.Cell,null,r.a.createElement(vr,{model:e,componentName:"Edit",addToast:n.props.addToast,brandOptions:n.props.brandOptions,loadModels:n.props.loadModels,submit:function(t){return pr(e._id,t)}})),r.a.createElement(dt.a.Cell,null,r.a.createElement(gr,{addToast:n.props.addToast,id:e._id,title:e.title,loadModels:n.props.loadModels})),r.a.createElement(dt.a.Cell,null,e._id),r.a.createElement(dt.a.Cell,null,e.brand.title),r.a.createElement(dt.a.Cell,null,e.title),r.a.createElement(dt.a.Cell,null,e.description))},n.handlePaginationClick=function(e){n.props.updatePageFilter({page:e})},n.createModelRow=n.createModelRow.bind(Object(Wa.a)(n)),n.handlePaginationClick=n.handlePaginationClick.bind(Object(Wa.a)(n)),n}return Object(D.a)(a,[{key:"render",value:function(){var e=this,t=this.props,a=t.pages,n=t.onPageChange,l=t.filters;return r.a.createElement(dt.a,{celled:!0},r.a.createElement(dt.a.Header,null,r.a.createElement(dt.a.Row,null,r.a.createElement(dt.a.HeaderCell,{colspan:2,rowspan:2},"Actions"),r.a.createElement(dt.a.HeaderCell,null,"ID"),r.a.createElement(dt.a.HeaderCell,null,"Brand"),r.a.createElement(dt.a.HeaderCell,null,"Titulo"),r.a.createElement(dt.a.HeaderCell,null,"Descri\xe7\xe3o"))),r.a.createElement(dt.a.Body,null,this.props.models.map((function(t){return e.createModelRow(t)}))),r.a.createElement(dt.a.Footer,null,r.a.createElement(dt.a.Row,null,r.a.createElement(dt.a.HeaderCell,{colSpan:"20",style:{textAlign:"right"}},r.a.createElement(Et.a,{activePage:l.currentPage,totalPages:a,onPageChange:n})))))}}]),a}(n.Component);var hr=function(e){var t=ne("/api/models","*"),a=Object(d.a)(t,8),l=a[0],c=a[1],o=c.total,i=c.pages,u=a[2],s=a[3],m=(a[4],a[5]),p=(a[6],a[7]),E=M("/api/brands?showAll=true","*"),f=Object(d.a)(E,8),v=f[0],g=(v=void 0===v?{data:[]}:v).data,b=(f[6],Object(n.useContext)(N)),h=g.map((function(e){var t=e._id;return{text:e.title,value:t}}));return r.a.createElement("div",{className:"container"},r.a.createElement("h2",null,"Models"),r.a.createElement(vr,{componentName:"Create",brandOptions:h,addToast:e.addToast,loadModels:p,submit:function(e){return dr(e,b)}}),r.a.createElement("div",null,r.a.createElement("span",null,"Total models: ",o),r.a.createElement("div",{class:"ui action input",style:{marginLeft:16}},r.a.createElement(mt.a,{type:"text",placeholder:"Search...",onChange:function(e){u(e.target.value)},value:m.searchText}),r.a.createElement("button",{class:"ui icon button",onClick:function(){u("")}},r.a.createElement("i",{class:"delete icon"})))),r.a.createElement(br,{addToast:e.addToast,brandOptions:h,models:l,loadModels:p,onPageChange:function(e,t){s(t.activePage)},pages:i,filters:m}))},yr=a(188),Cr=a(832),Or=a(820),jr=function(e){var t=e.index,a=e.image,l=e.productId,c=e.header,o=e.addToast,i=Object(n.useState)(!1),u=Object(d.a)(i,2),s=u[0],m=u[1],p=function(){return m(!s)};return r.a.createElement(yr.c,{index:t},r.a.createElement("div",null,r.a.createElement(Cr.a,{centered:!0,color:"grey"},r.a.createElement(Cr.a.Content,null,r.a.createElement(ft.a,{trigger:r.a.createElement(x.a,{icon:"delete",style:{position:"float",float:"right"},color:"orange",onClick:p}),open:s,onClose:p,closeIcon:!0},r.a.createElement(ft.a.Header,null,"Delete a model"),r.a.createElement(ft.a.Content,null,r.a.createElement("h4",null,"Are you sure you want to delete this image?"),r.a.createElement(x.a,{color:"red",inverted:!0,onClick:function(){return function(e,t,a,n){It(t,a).then((function(t){window.location.reload(!1),e("Image deleted successfully",{appearance:"success"})})).catch((function(t){""!==t.message?e("Could not delete product image: "+t.message,{appearance:"error"}):e("Something went wrong",{appearance:"error"})})).finally((function(){return n()}))}(o,l,a._id,p)}},r.a.createElement(pt.a,{name:"remove"})," Delete"),r.a.createElement(x.a,{color:"blue",inverted:!0,onClick:p},r.a.createElement(pt.a,{name:"checkmark"})," Cancel")))),r.a.createElement(f.a,{src:a.link,verticalAlign:"middle",centered:!0,size:"small"}),r.a.createElement(Cr.a.Content,null,c,r.a.createElement("br",null)))))},Sr=function(e){var t=e.slides,a=e.size;return r.a.createElement(Or.a,{textAlign:"center"},r.a.createElement(x.a.Group,{size:a},Object(B.a)(Array(t).keys()).map((function(e){return r.a.createElement(x.a,{as:yr.b,key:e,icon:"circle",slide:e})}))))};Sr.defaultProps={size:"mini"};var Ir=function(e){var t=e.productId,a=e.images,n=e.addToast;return 0===a.length?r.a.createElement(r.a.Fragment,null):r.a.createElement(yr.a,{naturalSlideWidth:1,naturalSlideHeight:1.25,totalSlides:a.length,style:{width:"55%"}},r.a.createElement(yr.d,null,a.map((function(e){return r.a.createElement(jr,{key:e._id,addToast:n,image:e,productId:t,index:0,header:e.comment||"-"})}))),r.a.createElement(Sr,{slides:a.length}))};Ir.defaultProps={images:[]};var wr=Ir,xr=(a(783),a(784),function(e){var t=e.uploadHandler,a=Object(pe.a)("translation").t,l=Object(n.useState)(void 0),c=Object(d.a)(l,2),o=c[0],i=c[1];return r.a.createElement("div",null,r.a.createElement("input",{type:"file",onChange:function(e){i(e.target.files[0])}}),r.a.createElement(x.a,{onClick:function(){return t(o)},color:"blue",inverted:!0},r.a.createElement(pt.a,{name:"checkmark"})," ",a("Upload")))}),kr=function(){var e=Object(O.a)(C.a.mark((function e(t,a){var n;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ct({endpoint:"/api/products/".concat(t,"/images"),type:"POST",attachment:a});case 2:return n=e.sent,e.abrupt("return",n.json());case 4:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),Nr=a(157),Tr=a.n(Nr);var Pr,Dr=function(e){var t=e.fileName,a=e.className,l=e.style,c=Object(n.useState)(!1),o=Object(d.a)(c,2),i=o[0],u=o[1],s=Object(pe.a)("translation").t;return r.a.createElement(r.a.Fragment,null,r.a.createElement(x.a,{className:a,style:l,primary:!0,onClick:function(){return u(!0)}},s("Show QR")),i&&r.a.createElement(Mt.a,{visible:!0,onCancel:function(){return u(!1)},width:300,footer:null},r.a.createElement(Tr.a,{id:"qr-canvas",value:window.location.href,size:256,includeMargin:!0}),r.a.createElement(Qt.a,{onClick:function(){var e=document.getElementById("qr-canvas").toDataURL("image/png").replace("image/png","image/octet-stream"),a=document.createElement("a");a.href=e,a.download="".concat(t,".png"),document.body.appendChild(a),a.click(),document.body.removeChild(a)},type:"primary",block:!0},"Download")))},Rr=function(e){Object(Ka.a)(a,e);var t=Object(Xa.a)(a);function a(e){var n;return Object(P.a)(this,a),(n=t.call(this,e)).prepareProdDescriptionTableBody=function(e){var t=n.props.t;return r.a.createElement(dt.a.Body,null,r.a.createElement(dt.a.Row,null,r.a.createElement(dt.a.Cell,null,t("ID")),r.a.createElement(dt.a.Cell,null,e._id)),r.a.createElement(dt.a.Row,null,r.a.createElement(dt.a.Cell,null,t("Title")),r.a.createElement(dt.a.Cell,null,e.title)),r.a.createElement(dt.a.Row,null,r.a.createElement(dt.a.Cell,null,t("BCode")),r.a.createElement(dt.a.Cell,null,e.ISBN)),r.a.createElement(dt.a.Row,null,r.a.createElement(dt.a.Cell,null,t("Cost")),r.a.createElement(dt.a.Cell,null,In.format(e.cost))),r.a.createElement(dt.a.Row,null,r.a.createElement(dt.a.Cell,null,t("Price")),r.a.createElement(dt.a.Cell,null,In.format(e.price))),r.a.createElement(dt.a.Row,null,r.a.createElement(dt.a.Cell,null,t("Total Units")),r.a.createElement(dt.a.Cell,null,e.totalUnits)),r.a.createElement(dt.a.Row,null,r.a.createElement(dt.a.Cell,null,t("Category")),r.a.createElement(dt.a.Cell,null,e.category?e.category.title:"")),r.a.createElement(dt.a.Row,null,r.a.createElement(dt.a.Cell,null,t("Department")),r.a.createElement(dt.a.Cell,null,e.department?e.department.title:"")),r.a.createElement(dt.a.Row,null,r.a.createElement(dt.a.Cell,null,t("Model")),r.a.createElement(dt.a.Cell,null,e.model?e.model.title:"")),r.a.createElement(dt.a.Row,null,r.a.createElement(dt.a.Cell,null,t("Subcategory")),r.a.createElement(dt.a.Cell,null,e.subcategory?e.subcategory.title:"")),r.a.createElement(dt.a.Row,null,r.a.createElement(dt.a.Cell,null,t("Brand")),r.a.createElement(dt.a.Cell,null,e.brand?e.brand.title:"")),r.a.createElement(dt.a.Row,null,r.a.createElement(dt.a.Cell,null,t("Provider")),r.a.createElement(dt.a.Cell,null,e.provider?e.provider.name:"")),r.a.createElement(dt.a.Row,null,r.a.createElement(dt.a.Cell,null,t("Created At")),r.a.createElement(dt.a.Cell,null,W()(1e3*e.createdAt).format("DD/MM/YYYY"))),r.a.createElement(dt.a.Row,null,r.a.createElement(dt.a.Cell,null,t("Comment")),r.a.createElement(dt.a.Cell,null,e.comment)))},n.prepareProductStats=function(e){var t=n.props.t;return r.a.createElement(dt.a.Body,null,r.a.createElement(dt.a.Row,null,r.a.createElement(dt.a.Cell,null,t("Open")," ",t("Orders")),r.a.createElement(dt.a.Cell,null,t("Total")," ",t("Orders"),": ",r.a.createElement("strong",null,n.state.product.stats.openOrders.total)),r.a.createElement(dt.a.Cell,null," ",t("Total")," ",t("Amount"),": ",r.a.createElement("strong",null,n.state.product.stats.openOrders.value)),r.a.createElement(dt.a.Cell,null,t("Total Units"),": ",r.a.createElement("strong",null,xt(n.state.product.stats.openOrders.units)))),r.a.createElement(dt.a.Row,null,r.a.createElement(dt.a.Cell,null,t("Partial")," ",t("Orders")),r.a.createElement(dt.a.Cell,null,t("Total")," ",t("Orders"),":",r.a.createElement("strong",null,n.state.product.stats.partial.total)),r.a.createElement(dt.a.Cell,null,t("Total Amount"),": ",r.a.createElement("strong",null,n.state.product.stats.partial.value)),r.a.createElement(dt.a.Cell,null,t("Total Units"),": ",r.a.createElement("strong",null,xt(n.state.product.stats.partial.units)))),r.a.createElement(dt.a.Row,null,r.a.createElement(dt.a.Cell,null,t("Closed")," ",t("Orders")),r.a.createElement(dt.a.Cell,null," ",t("Total Orders"),": ",r.a.createElement("strong",null,n.state.product.stats.closed.total)),r.a.createElement(dt.a.Cell,null," ",t("Total Amount"),": ",r.a.createElement("strong",null,n.state.product.stats.closed.value)),r.a.createElement(dt.a.Cell,null,t("Total Units"),": ",r.a.createElement("strong",null,xt(n.state.product.stats.closed.units)))),r.a.createElement(dt.a.Row,null,r.a.createElement(dt.a.Cell,null,t("Quotations")),r.a.createElement(dt.a.Cell,null," ",t("Total Orders"),": ",r.a.createElement("strong",null,n.state.product.stats.quotations.total)),r.a.createElement(dt.a.Cell,null," ",t("Total Amount"),": ",r.a.createElement("strong",null,n.state.product.stats.quotations.value)),r.a.createElement(dt.a.Cell,null,t("Total Units"),": ",r.a.createElement("strong",null,xt(n.state.product.stats.quotations.units)))))},n.toggleModal=function(){n.setState({modalOpen:!n.state.modalOpen})},n.fileChangedHandler=function(e){n.setState({selectedFile:e.target.files[0]})},n.uploadHandler=function(e){kr(n.props.id,e).then(n.props.addToast(n.props.t("image added"),{appearance:"success"})).catch(n.props.addToast(n.props.t("Something went wrong"))),window.location.reload()},n.state={product:{stats:{openOrders:{},quotations:{},closed:{},partial:{}}},images:[]},n}return Object(D.a)(a,[{key:"componentDidMount",value:function(){var e=this,t=this.props.t;jt(this.props.id).then((function(t){return e.setState({product:t},(function(){return console.log(e.state)}))})).catch((function(a){return e.props.addToast(t("Could not fetch")+" "+t("product"),{appearance:"error"})}))}},{key:"render",value:function(){var e,t=this.props.t;return r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"product-block product-descr"},r.a.createElement("div",{style:{display:"flex",justifyContent:"flex-end"}},r.a.createElement(Dr,{fileName:null===(e=this.state.product)||void 0===e?void 0:e._id})),r.a.createElement(dt.a,{celled:!0,striped:!0},r.a.createElement(dt.a.Header,null,r.a.createElement(dt.a.Row,null,r.a.createElement(dt.a.HeaderCell,{colSpan:"3"},t("Product")," ",t("Description")))),this.prepareProdDescriptionTableBody(this.state.product),r.a.createElement(dt.a.Footer,null)),r.a.createElement(dt.a,{celled:!0,striped:!0},r.a.createElement(dt.a.Header,null,r.a.createElement(dt.a.Row,null,r.a.createElement(dt.a.HeaderCell,{colSpan:"4"},t("Product")," ",t("Stats")))),this.prepareProductStats(this.state.product))),r.a.createElement("div",{className:"product-block product-images"},r.a.createElement(wr,{images:this.state.product.imageUrls,addToast:this.props.addToast,productId:this.state.product._id}),r.a.createElement(ft.a,{trigger:r.a.createElement(x.a,{onClick:this.toggleModal,color:"teal",style:{position:"float",float:"center"},className:"menuBtn'"},r.a.createElement(pt.a,{name:"picture"})," ",t("Add an image")),open:this.state.modalOpen,onClose:this.toggleModal,closeIcon:!0},r.a.createElement(ft.a.Header,null,t("Upload a picture")),r.a.createElement(ft.a.Content,null,r.a.createElement(xr,{uploadHandler:this.uploadHandler})))))}}]),a}(r.a.Component),Ar=Object(or.a)("translation")(Rr),Fr=function(){var e=Object(O.a)(C.a.mark((function e(){var t;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ct({endpoint:"/api/orders/statuses",type:"GET"});case 2:return t=e.sent,e.abrupt("return",t.json());case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Lr=function(){var e=Object(O.a)(C.a.mark((function e(t){var a;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ct({endpoint:"/api/orders/".concat(t),type:"GET"});case 2:return a=e.sent,e.abrupt("return",a.json());case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Vr=function(){var e=Object(O.a)(C.a.mark((function e(t,a){var n;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ct({endpoint:"/api/orders/".concat(t,"/payment/").concat(a),type:"DELETE"});case 2:return n=e.sent,e.abrupt("return",n.json());case 4:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),zr=function(){var e=Object(O.a)(C.a.mark((function e(t,a){var n;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ct({endpoint:"/api/orders/".concat(t,"/process-status"),type:"POST",request:a});case 2:return n=e.sent,e.abrupt("return",n.json());case 4:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),Mr=function(){var e=Object(O.a)(C.a.mark((function e(t,a){var n;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ct({endpoint:"/api/orders/".concat(t),type:"DELETE",request:a});case 2:return n=e.sent,e.abrupt("return",n.text().then((function(e){return e?JSON.parse(e):void 0})));case 4:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),Br=function(){var e=Object(O.a)(C.a.mark((function e(t,a){var n;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ct({endpoint:"/api/orders/".concat(t,"/payment-upload"),type:"POST",attachment:a});case 2:return n=e.sent,e.abrupt("return",n.json());case 4:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),Hr=function(){var e=Object(O.a)(C.a.mark((function e(t,a,n){var r;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ct({endpoint:"/api/orders/".concat(t,"/payment"),type:"POST",request:a,organizationId:n});case 2:return r=e.sent,e.abrupt("return",r.json());case 4:case"end":return e.stop()}}),e)})));return function(t,a,n){return e.apply(this,arguments)}}(),_r=function(){var e=Object(O.a)(C.a.mark((function e(t,a,n){var r;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ct({endpoint:"/api/orders/".concat(t,"/payment/").concat(a),type:"PUT",request:n});case 2:return r=e.sent,e.abrupt("return",r.json());case 4:case"end":return e.stop()}}),e)})));return function(t,a,n){return e.apply(this,arguments)}}(),Ur=function(){var e=Object(O.a)(C.a.mark((function e(t){var a;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ct({endpoint:"/api/orders/".concat(t,"/payment"),type:"GET"});case 2:return a=e.sent,e.abrupt("return",a.json());case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),qr=function(e){var t=e.id,a=e.addToast,l=(e.hasPayments,e.loadOrders),c=Object(n.useState)(!1),o=Object(d.a)(c,2),i=o[0],u=o[1],s=function(){u(!i)};return r.a.createElement(ft.a,{trigger:r.a.createElement(x.a,{onClick:s,icon:"trash alternate",negative:!0,basic:!0,size:"mini",style:{height:32}}),open:i,onClose:s,closeIcon:!0},r.a.createElement(ft.a.Header,null,"Delete Order"),r.a.createElement(ft.a.Content,null,r.a.createElement("h4",null,"Are you sure you want to delete an order with id ",'"'.concat(t,'"'),"?"),r.a.createElement("div",{style:{textAlign:"right",paddingTop:16}},r.a.createElement(x.a,{onClick:s},"Close"),r.a.createElement(x.a,{color:"red",onClick:function(){Mr(t,{deleteTrxs:!0}).then((function(e){a("Order deleted successfully",{appearance:"success"})})).catch((function(e){""!==e.message?a("Could not delete order: "+e.message,{appearance:"error"}):a("Something went wrong",{appearance:"error"})})).finally((function(){s(),l()}))}},r.a.createElement(pt.a,{name:"trash"})," Delete"))))};function Yr(){return(Yr=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function Jr(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},l=Object.keys(e);for(n=0;n<l.length;n++)a=l[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(n=0;n<l.length;n++)a=l[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}function Gr(e,t){var a=e.title,r=e.titleId,l=Jr(e,["title","titleId"]);return n.createElement("svg",Yr({xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",viewBox:"0 0 490.996 490.996",width:"1em",height:"1em",fill:"currentColor",ref:t,"aria-labelledby":r},l),a?n.createElement("title",{id:r},a):null,Pr||(Pr=n.createElement("g",null,n.createElement("path",{d:"M484.058,112.28c-7.247-10.404-19.144-16.614-31.816-16.614h-94.624c13.291,2.775,24.603,11.714,29.943,24.615 c1.063,2.569,1.761,5.212,2.283,7.869h62.396c2.063,0,3.997,1.015,5.155,2.67c1.175,1.698,1.444,3.862,0.73,5.791 l-44.992,121.107c-0.905,2.451-3.267,4.102-5.887,4.102H154.939L114.734,90.314c-5.01-21.286-23.772-36.153-45.631-36.153H24.361 C10.912,54.161,0,65.065,0,78.522s10.912,24.362,24.361,24.362h43.286l54.131,230.919c4.914,20.864,23.058,35.479,44.36,36.042 c-12.532,9.103-20.764,23.765-20.764,40.436c0,27.662,22.429,50.078,50.09,50.078c27.662,0,50.072-22.416,50.072-50.078 c0-16.605-8.17-31.212-20.623-40.326h93.421c-12.454,9.114-20.634,23.721-20.634,40.326c0,27.662,22.428,50.078,50.083,50.078 c27.646,0,50.072-22.416,50.072-50.078c0-16.605-8.187-31.212-20.634-40.326h22.714c13.448,0,24.361-10.901,24.361-24.361 c0-13.457-10.913-24.361-24.361-24.361h-231.07l-6.313-26.931h244.693c16.113,0,30.703-10.143,36.338-25.256l44.994-121.118 C492.986,136.046,491.305,122.732,484.058,112.28z"}),n.createElement("path",{d:"M275.701,209.63c1.776,1.785,4.109,2.673,6.437,2.673c2.334,0,4.667-0.888,6.426-2.673l67.007-66.987 c2.621-2.609,3.396-6.525,1.986-9.935c-0.923-2.221-3.986-5.64-8.422-5.64c-6.472,0-25.886,0-25.886,0V95.665v-55.89 c-0.017-5.035-4.094-9.137-9.138-9.137h-63.964c-5.044,0-9.12,4.102-9.12,9.12v55.908v31.412c0,0-19.408,0-25.878,0 c-4.144,0-7.473,3.332-8.424,5.622c-1.41,3.41-0.635,7.334,1.962,9.943L275.701,209.63z"}))))}var Wr=n.forwardRef(Gr),Kr=(a.p,function(e){var t=e.id,a=e.addToast,l=e.loadOrders,c=Object(pe.a)("translation").t,o=Object(n.useState)(!1),i=Object(d.a)(o,2),u=i[0],s=i[1],m=et(t),p=m.convert,E=m.status,f=function(){s(!u)};return Object(n.useEffect)((function(){E.isSuccess&&(a(c("Converted to order successfully!"),{appearance:"success"}),f(),l())}),[E]),r.a.createElement(ft.a,{trigger:r.a.createElement(x.a,{onClick:f,className:"table-action-btn",style:{fontSize:"1.3em",color:"teal"}},r.a.createElement(Wr,null)),style:{width:500},open:u,onClose:f,closeIcon:!0},r.a.createElement(ft.a.Header,null,c("Convert this order into open order ?")),r.a.createElement(ft.a.Content,null,r.a.createElement("div",{style:{textAlign:"right",marginBottom:16}},r.a.createElement(x.a,{onClick:f},c("No")),r.a.createElement(x.a,{primary:!0,onClick:function(){p(t)}},c("Yes"))),E.isError&&r.a.createElement(Jt.a,{type:"error",message:c("Not enough stock")+": ".concat(E.message)})))}),Xr=a(186),Qr={unitOptions:[{key:"unit",text:"Unit",value:"unit"},{key:"size",text:"Size",value:"size"}],volumeOptions:[{key:"l",text:"Liter",value:1},{key:"m",text:"Milliliter",value:2},{key:"o",text:"Ounce",value:3},{key:"g",text:"Gallon",value:4},{key:"b",text:"Barrel",value:5}],sizeOptions:[{key:"ml",text:"Millimeter",value:1},{key:"cm",text:"Centimeter",value:2},{key:"m",text:"Meter",value:3},{key:"sm",text:"SquareMeter",value:4},{key:"cbm",text:"CubicMeter",value:5},{key:"in",text:"Inch",value:6},{key:"ft",text:"Foot",value:7}],sizev2Options:[{key:"linear",text:"linear",value:1},{key:"sqmeter",text:"sq. meter",value:2},{key:"cubicmeter",text:"cubic meter",value:3}],weightOptions:[{key:"mg",text:"Milligram",value:1},{key:"g",text:"Gram",value:2},{key:"kg",text:"Kilogram",value:3},{key:"tn",text:"Tonne",value:4}],paymentOptions:[{key:"cash",text:"Dinheiro",value:1},{key:"debit",text:"Debito",value:2},{key:"credit",text:"Credito",value:3},{key:"check",text:"Cheque",value:4},{key:"bc",text:"Bitcoins",value:5},{key:"dep",text:"Depositos",value:6},{key:"tr",text:"Transferencia",value:7},{key:"other",text:"other",value:8}],statusOptions:[{key:0,text:"All",value:null},{key:1,text:"Open",value:1},{key:2,text:"Partial",value:2},{key:3,text:"Closed",value:3},{key:4,text:"Quotation",value:4}]},$r=function(e){var t=e.order,a=e.loadOrders,l=e.addToast,c=e.onClose,o=e.afterSave,i=e.initialValues,u=Object(pe.a)("translation").t,s=Object(n.useState)(null===i||void 0===i?void 0:i.method),m=Object(d.a)(s,2),p=m[0],E=m[1],f=Object(n.useState)(null===i||void 0===i?void 0:i.amount),v=Object(d.a)(f,2),g=v[0],b=v[1],h=Object(n.useState)(null===i||void 0===i?void 0:i.fileLink),y=Object(d.a)(h,2),j=y[0],S=y[1],w=Object(n.useState)(!1),k=Object(d.a)(w,2),N=k[0],T=k[1],P=Object(n.useState)(!0),D=Object(d.a)(P,2),R=D[0],A=D[1],F=Object(n.useState)(!1),L=Object(d.a)(F,2),V=L[0],z=L[1],M=Object(n.useState)(!1),B=Object(d.a)(M,2),H=B[0],_=B[1],U=Object(n.useState)(null===i||void 0===i?void 0:i.chequeId),q=Object(d.a)(U,2),Y=q[0],J=q[1],G=at(null===t||void 0===t?void 0:t.organizationId),W=Object(d.a)(G,1)[0],K=W.map((function(e){var t=e.no,a=e.amount,n=e._id;return{text:"".concat(t," (").concat(Pt.format(a),")"),value:n}}));(null===i||void 0===i?void 0:i.cheque)&&K.push({text:"".concat(i.cheque.no," (").concat(Pt.format(i.cheque.amount),")"),value:i.cheque._id});var X=function(){var e=Object(O.a)(C.a.mark((function e(){var n,r;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=+g,R&&!(p<=0)&&0!==n){e.next=3;break}return e.abrupt("return");case 3:return r={method:p,amount:+g,fileLink:j,chequeId:Y,orderId:t._id},z(!0),e.next=7,((null===i||void 0===i?void 0:i._id)?_r(t._id,i._id,r):Hr(t._id,r,t.organizationId)).then((function(e){(null===i||void 0===i?void 0:i._id)?l(u("transaction")+" "+u("changed successfully"),{appearance:"success"}):l(u("Payment added"),{appearance:"success"}),o()})).catch((function(e){_("err.error")}));case 7:z(!1),a();case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return r.a.createElement(ft.a,{open:!0,onClose:c,closeIcon:!0},r.a.createElement(ft.a.Header,null,u("Add payment")),r.a.createElement(ft.a.Content,null,r.a.createElement("span",null,r.a.createElement("strong",null,u("Total Cost"),":")," ",xt(t.totalCost)),r.a.createElement("br",null),r.a.createElement("span",null,r.a.createElement("strong",null,u("Total Paid"),":")," ",xt(t.totalPaid)),r.a.createElement("br",null),r.a.createElement("span",null,r.a.createElement("strong",null,u("Left to pay"),":")," ",Pt.format(t.totalCost-t.totalPaid)),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement(I.a,{firstName:"createAdminForm",size:"large",onSubmit:X},r.a.createElement(I.a.Group,{widths:"equal"},r.a.createElement(I.a.Input,{fluid:!0,placeholder:u("Amount"),label:u("Amount"),type:"number",value:g,error:!R&&{content:"".concat(u("Enter amount between 0,1 and")," ").concat((null===i||void 0===i?void 0:i._id)?t.totalCost:t.totalCost-t.totalPaid),pointing:"above"},message:"sdvf",onChange:function(e){return b(e.target.value)},onBlur:function(){return A((e=g,a=(null===i||void 0===i?void 0:i._id)?t.totalCost:t.totalCost-t.totalPaid,e>0&&e<=a));var e,a}}),r.a.createElement(I.a.Select,{fluid:!0,label:u("Payment Type"),options:Qr.paymentOptions,defaultValue:p,placeholder:u("Payment Type"),onChange:function(e,t){var a=t.value;return E(a)},required:!0}),r.a.createElement(I.a.Select,{fluid:!0,label:u("Cheque"),options:K,onChange:function(e,t){var a=t.value;return J(a)},required:4===p,disabled:4!==p,defaultValue:Y}),j?r.a.createElement("div",{className:"field",style:{alignSelf:"center",paddingTop:16}},r.a.createElement("a",{target:"_blank",href:"/assets/".concat(j),style:{marginRight:16}},j),r.a.createElement(x.a,{icon:"delete",onClick:function(){return S(void 0)}})):r.a.createElement(I.a.Input,{style:{width:"200px"},name:"file",label:u("Proof of payment"),type:"file",accept:".jpg, .jpeg, .pdf",onChange:function(e){var a=e.target.files[0];T(!0),Br(t._id,a).then((function(e){S(e.message)})).catch((function(e){l(u("failed to upload proof of payment"),{appearance:"error"})})).finally((function(){T(!1)}))}})),r.a.createElement(I.a.Group,null,H&&r.a.createElement(Xr.a,{color:"red"},H)),r.a.createElement("div",{style:{textAlign:"right"}},r.a.createElement(x.a,{type:"button",onClick:c},u("Cancel")),r.a.createElement(x.a,{type:"submit",loading:V,primary:!0,disabled:N},u("Submit"))))))},Zr=2592e6,el=function(e){var t=e.id,a=e.status,l=e.paymentStatus,c=e.onUpdate,o=e.allowed,i=Object(pe.a)(["translation"]).t,u=Object(n.useState)(!1),s=Object(d.a)(u,2),m=s[0],p=s[1],E=Object(n.useState)([]),f=Object(d.a)(E,2),v=f[0],g=f[1],b=Object(n.useState)(""),h=Object(d.a)(b,2),y=h[0],C=h[1],O=function(){return p(!1)};return r.a.createElement(r.a.Fragment,null,r.a.createElement(Dt.a,{text:i(Ee[a])},r.a.createElement(Dt.a.Menu,null,Ee.map((function(e,n){return r.a.createElement(Dt.a.Item,{key:e,text:i(e),onClick:8===n?function(){return p(!0)}:(u=n,function(){zr(t,{processStatus:u}).then((function(){return c()}))}),disabled:8===n&&(7!==a||3!==l)||0===n||!o.includes(n)});var u})))),m&&r.a.createElement(ft.a,{closeIcon:!0,open:!0,onClose:O},r.a.createElement(ft.a.Header,null,i("Conclude with Review")),r.a.createElement(ft.a.Content,null,r.a.createElement(I.a,null,r.a.createElement("div",{style:{marginBottom:16}},r.a.createElement($t.a,{onChange:function(e){var t=e.fileList;g(t)},fileList:v,action:"/api/assets/upload?entity=order",accept:"image/*,.pdf",headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}},r.a.createElement(x.a,null,i("Add files")))),r.a.createElement(I.a.Group,{widths:"equal"},r.a.createElement(I.a.TextArea,{label:i("Client Review"),onChange:function(e,t){var a=t.value;C(a)}}))),r.a.createElement("div",{style:{display:"flex",justifyContent:"flex-end"}},r.a.createElement(x.a,{onClick:O},"Cancel"),r.a.createElement(x.a,{primary:!0,onClick:function(){zr(t,{processStatus:8,documents:v.map((function(e){var t=e.response;return null===t||void 0===t?void 0:t.message})),comment:y}).then((function(){return c()}))}},i("Conclude")," ",i("Order"))))))},tl=function(e){var t=e.date,a=e.status;if(!t)return"-";var n,l,c=W()(t).format("DD/MM/YYYY"),o=W()(t).diff(W()(),"day");return a<7&&(o<=0?(n="rgba(255, 0, 0, 0.2)",l="\ud83d\udea8"):o>0&&o<=5&&(l=r.a.createElement("span",{style:{fontFamily:"Segoe UI Emoji"}},"\u26a0\ufe0f "),n="rgba(255, 255, 0, 0.2)")),r.a.createElement("span",{style:{backgroundColor:n,padding:8}},l,c)},al=function(e){var t=e.orders,a=e.addToast,l=e.loadOrders,c=e.setSelectedOrders,o=e.selectedOrders,i=e.showOrderUpdateModal,u=e.filters,s=e.pages,m=e.onPageChange,p=Object(pe.a)(["translation"]).t,E=Object(n.useContext)(T).user,f=Object(n.useState)(void 0),v=Object(d.a)(f,2),g=v[0],b=v[1],h=Object(n.useState)(),y=Object(d.a)(h,2),C=y[0],O=y[1],j=(t||[]).filter((function(e){var t=e.processStatus,a=e.client,n=!((E.allowedStatuses||[]).length>0)||E.allowedStatuses.includes(t),r=6!==E.roleNumber||(null===a||void 0===a?void 0:a._id)===E._id;return n&&r})),S=function(){b(void 0)};return r.a.createElement(r.a.Fragment,null,r.a.createElement(dt.a,{celled:!0},r.a.createElement(dt.a.Header,null,r.a.createElement(dt.a.Row,null,r.a.createElement(dt.a.HeaderCell,{colSpan:"2",rowSpan:"2"},p("Actions")),r.a.createElement(dt.a.HeaderCell,null,p("ID")),r.a.createElement(dt.a.HeaderCell,null,p("Client")),r.a.createElement(dt.a.HeaderCell,null,p("Status")),r.a.createElement(dt.a.HeaderCell,null,p("Process Status")),r.a.createElement(dt.a.HeaderCell,null,p("Total Units")),r.a.createElement(dt.a.HeaderCell,null,p("Total Cost")),r.a.createElement(dt.a.HeaderCell,null,p("Total Paid")),r.a.createElement(dt.a.HeaderCell,null,p("Est. Conlusion")),r.a.createElement(dt.a.HeaderCell,null,p("Created At")),r.a.createElement(dt.a.HeaderCell,null,p("Last Pay date")))),r.a.createElement(dt.a.Body,null,j.map((function(e){var t,n=4===e.status&&Date.now()-1e3*e.createdAt>Zr;return r.a.createElement(dt.a.Row,{key:e._id},r.a.createElement(dt.a.Cell,null,r.a.createElement("div",{style:{display:"flex",gridAutoFlow:"column",columnGap:16}},([1].includes(E.roleNumber)||n)&&r.a.createElement(qr,{hasPayments:0!==e.totalPaid,id:e._id,addToast:a,loadOrders:l}),e.totalCost>e.totalPaid&&4!==e.status&&r.a.createElement("button",{onClick:function(){return function(e){b(e)}(e)},className:"table-action-btn"},r.a.createElement(pt.a,{name:"money bill alternate"})),4===e.status&&r.a.createElement(Kr,{id:e._id,addToast:a,loadOrders:l}),(4===e.status||1===E.roleNumber)&&r.a.createElement(x.a,{className:"table-action-btn",onClick:function(){return i(e._id)}},r.a.createElement(pt.a,{name:"pencil alternate"})))),r.a.createElement(dt.a.Cell,null,4===e.status&&r.a.createElement("input",{type:"checkbox",onChange:(t=e._id,function(e){e.target.checked?c([].concat(Object(B.a)(o),[t])):c(o.filter((function(e){return e!==t})))})})),r.a.createElement(dt.a.Cell,null,r.a.createElement("a",{href:"/orders/view/".concat(e._id)},e.orderId)),r.a.createElement(dt.a.Cell,null,(e.client||{}).firstName," ",(e.client||{}).lastName),r.a.createElement(dt.a.Cell,null,Tt(p,e.status,n||function(e){var t,a=(null===(t=(e.transactions||[]).sort((function(e,t){return t.createdAt-e.createdAt}))[0])||void 0===t?void 0:t.createdAt)||e.createdAt;return[1,2].includes(e.status)&&Date.now()-1e3*a>Zr}(e))),r.a.createElement(dt.a.Cell,null,4!==e.status&&r.a.createElement(el,{id:e._id,status:e.processStatus,onUpdate:l,paymentStatus:e.status,allowed:[1,2].includes(E.roleNumber)?Object(B.a)(Ee.keys()):Ee.map((function(e,t){return t})).filter((function(t){return e.processStatus+1===t}))})),r.a.createElement(dt.a.Cell,null,xt(e.totalUnits)),r.a.createElement(dt.a.Cell,null,Pt.format(e.totalCost)),r.a.createElement(dt.a.Cell,null,Pt.format(e.totalPaid)),r.a.createElement(dt.a.Cell,{style:{padding:16,width:160}},r.a.createElement(tl,{date:e.estConclusionDate,status:e.processStatus})),r.a.createElement(dt.a.Cell,null,W()(1e3*e.createdAt).format("DD/MM/YYYY")),r.a.createElement(dt.a.Cell,null,e.transactions.length>0?W()(1e3*e.transactions.sort((function(e,t){return t.createdAt-e.createdAt}))[0].createdAt).format("DD/MM/YYYY"):"-"))}))),r.a.createElement(dt.a.Footer,null,r.a.createElement(dt.a.Row,null,r.a.createElement(dt.a.HeaderCell,{colSpan:"20",style:{textAlign:"right"}},r.a.createElement(Et.a,{activePage:u.currentPage,totalPages:s,onPageChange:function(e,t){var a=t.activePage;return m(a)}}))))),g&&r.a.createElement($r,{addToast:a,order:g,onClose:S,afterSave:function(){S(),l()},loadOrders:l}),C&&r.a.createElement(Rt.a,{open:!0,onCancel:function(){return O(void 0)},onConfirm:function(){}}))};al.defaultProps={orders:[],isLoading:!0};var nl=al,rl={firstName:[oa],lastName:[oa],email:[oa],address:[oa],cpf:[{type:"string",len:11}],cnpj:[{type:"string",len:14}],zipCode:[oa,{type:"string",len:8}]},ll={costContribution:[{name:"cost",value:0}],profitInPercentage:!1,identificationType:"pf",unitType:"unit",images:[]};var cl=function(e){var t=e.onClose,a=e.afterSave,l=e.okText,c=e.initialValue,o=Object(pe.a)(["translation"]).t,i=na(o,rl),u=qe(),s=u.insertedId,p=u.save,E=u.status,f=Bt.a.useForm(),v=Object(d.a)(f,1)[0];Object(n.useEffect)((function(){E.isSuccess&&(ct.b.success(E.message),a(s))}),[E,s]);var g=c?Object(m.a)(Object(m.a)(Object(m.a)({},ll),c),{},{identificationType:c.identificationType||"pf"}):ll;return r.a.createElement(da,{formID:"client-add-modal",onClose:t,okText:l,submitButtonProps:{loading:E.isLoading},width:800,organizationId:null===g||void 0===g?void 0:g.organizationId},r.a.createElement(Bt.a,{form:v,layout:"vertical",id:"client-add-modal",initialValues:g,onFinish:function(e){var t=Object(m.a)(Object(m.a)({},e),{},{identificationType:e.identificationNumber?e.identificationType:void 0});p(t,null===c||void 0===c?void 0:c._id)},validateTrigger:"onFinish"},r.a.createElement(_t.a,{gutter:16},r.a.createElement(Ut.a,{span:12},r.a.createElement(Bt.a.Item,{name:"firstName",label:o("First Name"),rules:i.firstName},r.a.createElement(Ht.a,null))),r.a.createElement(Ut.a,{span:12},r.a.createElement(Bt.a.Item,{name:"lastName",label:o("Last Name"),rules:i.lastName},r.a.createElement(Ht.a,null)))),r.a.createElement(Bt.a.Item,{name:"address",label:o("Address"),rules:i.address},r.a.createElement(Ht.a.TextArea,{rows:5,placeholder:"Sr. Luis Carvalho\nBoulevard das Flores 255\nSALVADOR-BA\nBRAZIL\n"})),r.a.createElement(_t.a,{gutter:16},r.a.createElement(Ut.a,{span:4},r.a.createElement(Bt.a.Item,{name:"identificationType",label:"\u2800",rules:i.identificationType},r.a.createElement(qt.a.Group,null,r.a.createElement(qt.a.Button,{value:"pf"},o("PF")),r.a.createElement(qt.a.Button,{value:"pj"},o("PJ"))))),r.a.createElement(Ut.a,{span:8},r.a.createElement(Bt.a.Item,{dependencies:["identificationType"],noStyle:!0},(function(e){var t="pj"===(0,e.getFieldValue)("identificationType");return r.a.createElement(Bt.a.Item,{name:"identificationNumber",label:o(t?"CNPJ":"CPF"),rules:t?i.cnpj:i.cpf},r.a.createElement(ua,{format:t?"##.###.###/####-##":"###.###.###-##",placeholder:t?"00.000.000/0001-00":"000.000.000-00",valuePropName:"value"}))}))),r.a.createElement(Ut.a,{span:8},r.a.createElement(Bt.a.Item,{name:"zipCode",label:o("Zip Code"),rules:i.zipCode},r.a.createElement(ua,{format:"#####-###",placeholder:"00000-000",valuePropName:"value"})))),r.a.createElement(_t.a,{gutter:16},r.a.createElement(Ut.a,{span:8},r.a.createElement(Bt.a.Item,{label:o("Email"),name:"email",rules:i.email},r.a.createElement(Ht.a,null))),r.a.createElement(Ut.a,{span:8},r.a.createElement(Bt.a.Item,{label:o("Landline Number"),name:"landlineNumber",rules:i.landlineNumber,trigger:"onValueChange",getValueFromEvent:function(e){return e.value}},r.a.createElement(Gt.a,{customInput:Ht.a,format:"(##) ##### - ####",placeholder:"(00) 00000 - 0000"}))),r.a.createElement(Ut.a,{span:8},r.a.createElement(Bt.a.Item,{label:o("Mobile Number"),name:"mobileNumber",rules:i.mobileNumber,trigger:"onValueChange",getValueFromEvent:function(e){return e.value}},r.a.createElement(Gt.a,{customInput:Ht.a,format:"(##) #### - ####",placeholder:"(00) 0000 - 0000"})))),r.a.createElement(_t.a,{gutter:16},r.a.createElement(Ut.a,{span:8},r.a.createElement(Bt.a.Item,{name:"password",label:o("Password"),rules:i.password},r.a.createElement(Ht.a.Password,null))),r.a.createElement(Ut.a,{span:8},r.a.createElement(Bt.a.Item,{name:"confirmPassword",label:o("Confirm Password"),dependencies:["password"],rules:[function(e){var t=e.getFieldValue;return{validator:function(e,a){return t("password")&&t("password")!==a?Promise.reject(new Error(o("passwords do not match"))):Promise.resolve()}}}]},r.a.createElement(Ht.a.Password,null))))),E.isError&&r.a.createElement(Jt.a,{message:E.message,type:"error"}))},ol=(a(790),Qr.paymentOptions.map((function(e){var t=e.value;return{label:e.text,value:t}}))),il=function(e){var t,a,n,r=e.file;if("removed"===r.status)return[];(null===r||void 0===r||null===(t=r.response)||void 0===t?void 0:t.message)&&(r.uid=null===r||void 0===r||null===(a=r.response)||void 0===a?void 0:a.message,r.url="/uploads/".concat(null===r||void 0===r||null===(n=r.response)||void 0===n?void 0:n.message));return[r]},ul={required:!0},sl=[ul],ml={discount:[ul,{max:10,min:0,type:"number"}]},dl={products:[],discount:0};var pl=function(e){var t=e.onClose,a=e.afterPlace,l=e.initialValue,c=e.isQuotation,o=void 0!==c&&c,i=e.okText,u=Object(pe.a)(["translation"]).t,s=Object(n.useState)(!1),p=Object(d.a)(s,2),E=p[0],f=p[1],v=me(),g=v.save,b=v.status,h=le(),y=h.all,C=h.status,O=ce(),j=O.options,S=O.status,I=O.refresh,w=Bt.a.useForm(),x=Object(d.a)(w,1)[0],k=Object(n.useState)(""),N=Object(d.a)(k,2),T=N[0],P=N[1],D=function(e){return function(){var t=x.getFieldValue("products"),a=t.findIndex((function(t){return t._id===e._id})),n=(null===a||void 0===a?void 0:a.totalUnits)||0;if(e.isService||o||n!==e.totalUnits)if(-1===a){var r={_id:e._id,__id:e._id,title:e.title,price:e.price,cost:e.cost,totalUnits:1};x.setFieldsValue({products:[r].concat(Object(B.a)(t))})}else t[a].totalUnits+=1,x.setFieldsValue({products:t})}},R=function(e){return function(){var t,a=x.getFieldValue("products"),n=(null===(t=a[e._id])||void 0===t?void 0:t.totalUnits)||0;if(e.isService||o||e.totalUnits!==n){var r={_id:Symbol(e._id),__id:e._id,title:e.title,price:e.price,cost:e.cost,totalUnits:1};x.setFieldsValue({products:[r].concat(Object(B.a)(a))})}}},A=function(){f(!0)},F=function(e){return function(){var t=x.getFieldValue("products"),a=t.findIndex((function(t){return t._id===e}));x.setFieldsValue({products:null}),x.setFieldsValue({products:[].concat(Object(B.a)(t.slice(0,a)),Object(B.a)(t.slice(a+1)))})}};Object(n.useEffect)((function(){b.isSuccess&&(ct.b.success("New order placed successfully!"),a()),b.isError&&ct.b.error(b.message)}),[b,a]),Object(n.useEffect)((function(){var e="",t=!1,a=function(a){if("Enter"===a.key){if(e.length>=13){var n=y.find((function(t){var a=t.ISBN;return e===a}));e="",n&&D(n)()}}else e+=a.key;t||(t=!0,setTimeout((function(){e="",t=!1}),200))};return document.addEventListener("keydown",a),function(){document.removeEventListener("keydown",a)}}),[y]);var L=$(y,"*",T),V=new Set,z=l?{products:l.items.map((function(e){var t=e.productId,a=e.amount,n=Object(ia.a)(e,["productId","amount"]),r=V.has(t)?Symbol(t):t;return V.add(t),Object(m.a)({_id:r,__id:t,totalUnits:a},n)})),clientId:(l.client||{})._id,comment:l.comment,discount:l.discount,isQuotation:4===l.status,estConclusionDate:l.estConclusionDate?W()(l.estConclusionDate):void 0}:dl;return r.a.createElement(da,{className:"order-place-form-modal",formID:"order-place-form",okText:i,onClose:t,submitButtonProps:{loading:b.isLoading},width:"100%",style:{top:16},organizationId:null===z||void 0===z?void 0:z.organizationId},r.a.createElement(Bt.a,{id:"order-place-form",layout:"vertical",form:x,onFinish:function(e){var t=[],a=x.getFieldValue("products");for(var n in console.log("selectedProducts :>> ",a),a){var r=a[n];r.totalUnits&&t.push({productId:r.__id,amount:r.totalUnits,title:r.title,price:r.price,cost:r.cost,comment:r.comment})}g(null===l||void 0===l?void 0:l._id,Object(m.a)(Object(m.a)(Object(m.a)({},l),e),{},{isQuotation:o,estConclusionDate:e.estConclusionDate&&1e3*e.estConclusionDate.unix(),items:t}))},initialValues:z,preserve:!1,onValuesChange:console.log},r.a.createElement(_t.a,{gutter:16},r.a.createElement(Ut.a,{span:12,style:{height:"100%"}},r.a.createElement("div",{style:{display:"grid",gridTemplateRows:"minmax(min-content, max-content) auto",minHeight:0,height:"100%"}},r.a.createElement(Ht.a.Search,{onChange:function(e){return P(e.target.value)},allowClear:!0}),r.a.createElement(Zt.b,{className:"product-list-form",itemLayout:"horizontal",dataSource:L,loading:C.isLoading,renderItem:function(e){var t;return r.a.createElement(Zt.b.Item,{className:0!==e.totalUnits||e.isService||o?void 0:"disabled",actions:[r.a.createElement(Qt.a,{onClick:R(e),size:"small",disabled:0===e.totalUnits&&!e.isService&&!o},"+ ",u("Add as Another")),r.a.createElement(Qt.a,{onClick:D(e),size:"small",disabled:0===e.totalUnits&&!e.isService&&!o},"+ ",u("Add"))]},r.a.createElement(Zt.b.Item.Meta,{avatar:r.a.createElement("img",{src:"/assets/".concat(null===(t=(e.images||[])[0])||void 0===t?void 0:t.link)}),title:r.a.createElement(r.a.Fragment,null,r.a.createElement("div",null,e.title),!e.isService&&r.a.createElement("span",{style:{color:0===e.totalUnits?"red":"inherit"}},u("In Stock"),": ",e.totalUnits))}))}}))),r.a.createElement(Ut.a,{span:12,style:{height:"100%"}},r.a.createElement(Bt.a.Item,{className:"products-form-item",wrapperCol:{span:24},rules:sl,shouldUpdate:!0},(function(e){var t=e.getFieldValue;return r.a.createElement(Ea,{status:C},(function(){return r.a.createElement(Zt.b,{className:"product-list-form",itemLayout:"horizontal",dataSource:t("products"),renderItem:function(e){var t,a,n=e._id,l=y.find((function(t){return e._id===t._id})),c=(null===l||void 0===l?void 0:l.images)||[],o=e.totalUnits,i=(null===l||void 0===l?void 0:l.chargeDuration)||"";return r.a.createElement(Zt.b.Item,{style:{display:"block"}},r.a.createElement(Zt.b.Item.Meta,{className:"selected-product-meta",avatar:r.a.createElement("img",{src:"/assets/".concat(null===(t=c[0])||void 0===t?void 0:t.link)}),title:(null===e||void 0===e?void 0:e.title)+(i?" (per ".concat(i,")"):"")}),r.a.createElement("div",{className:"sel-product"},r.a.createElement("div",{className:"action-group"},r.a.createElement(Ht.a,{style:{height:24},size:"small",placeholder:u("Comment"),onChange:function(t){return e.comment=t.target.value}}),r.a.createElement(ua,{value:o,onChange:(a=n,function(e){var t=x.getFieldValue("products");t.find((function(e){return e._id===a})).totalUnits=e,x.setFieldsValue({products:null}),x.setFieldsValue({products:t})}),size:"small",step:.01}),r.a.createElement(Qt.a,{icon:r.a.createElement(ea.a,null),onClick:F(n),size:"small",danger:!0})),r.a.createElement("div",{className:"price"},Pt.format((null===e||void 0===e?void 0:e.price)*o))))}})}))})))),r.a.createElement(Bt.a.Item,{wrapperCol:{span:24},shouldUpdate:!0},(function(e){var t=e.getFieldValue;return r.a.createElement("div",{style:{textAlign:"right",fontSize:"1.2em"}},u("Total"),": ",Pt.format(function(e,t){var a=0;for(var n in e){var r=e[n];a+=(r.totalUnits||0)*r.price}return 0===t?a:a-Number((a*t/100).toFixed(2))}(t("products"),t("discount"))))})),r.a.createElement(_t.a,{gutter:16},r.a.createElement(Ut.a,{span:4},r.a.createElement(Bt.a.Item,{name:"clientId",label:u("Client"),rules:sl},r.a.createElement(Yt.a,{options:j,loading:S.isLoading,dropdownRender:function(e){return r.a.createElement("div",null,e,r.a.createElement(Qt.a,{onClick:A,block:!0},"+ Add Client"))},filterOption:function(e,t){return t.label.toLowerCase().indexOf(e.toLowerCase())>=0},showSearch:!0}))),r.a.createElement(Ut.a,{span:3},r.a.createElement(Bt.a.Item,{label:u("% Discount"),name:"discount",trigger:"onValueChange",getValueFromEvent:function(e){return e.floatValue},rules:ml.discount},r.a.createElement(Gt.a,{customInput:Ht.a,thousandSeparator:".",decimalSeparator:",",disabled:(null===l||void 0===l?void 0:l._id)&&!o}))),r.a.createElement(Ut.a,{span:4},r.a.createElement(Bt.a.Item,{label:u("Conclude By"),name:"estConclusionDate"},r.a.createElement(pn.a,{format:"DD/MM/YYYY",style:{width:"100%"}}))),!o&&!(null===l||void 0===l?void 0:l._id)&&r.a.createElement(Bt.a.Item,{dependencies:["isQuotation"],noStyle:!0},(function(e){var t=e.getFieldValue;return r.a.createElement(r.a.Fragment,null,r.a.createElement(Ut.a,{span:3},r.a.createElement(Bt.a.Item,{name:"paid",label:u("Paid Amount")},r.a.createElement(ua,{disabled:!!t("isQuotation")}))),r.a.createElement(Ut.a,{span:3},r.a.createElement(Bt.a.Item,{name:"paymentMethod",label:u("Payment Method")},r.a.createElement(Yt.a,{options:ol,disabled:!!t("isQuotation")}))),r.a.createElement(Ut.a,{span:3},r.a.createElement(Bt.a.Item,{label:"\u2800",name:"proofOfPayment",getValueFromEvent:il,valuePropName:"fileList",shouldUpdate:!0},r.a.createElement($t.a,{action:"/api/assets/upload?entity=transaction",accept:"image/*, .pdf",headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}},r.a.createElement(Qt.a,{disabled:!!t("isQuotation")},u("Upload Proof"))))))}))),r.a.createElement(Bt.a.Item,{labelCol:{span:4},label:u("Comment"),name:"comment"},r.a.createElement(Ht.a.TextArea,{placeholder:u("Comment"),style:{width:"100%"},rows:1}))),b.isError&&r.a.createElement(Jt.a,{message:b.message,type:"error"}),E&&r.a.createElement(cl,{afterSave:function(e){f(!1),I(),x.setFieldsValue({clientId:e})},onClose:function(){return f(!1)},okText:"".concat(u("Add")," ").concat(u("Client"))}))},El=(a(791),2592e6),fl=function(e){var t,a=(null===(t=(e.transactions||[]).sort((function(e,t){return t.createdAt-e.createdAt}))[0])||void 0===t?void 0:t.createdAt)||e.createdAt;return[1,2].includes(e.status)&&Date.now()-1e3*a>El},vl=function(e){return 4===e.status&&Date.now()-1e3*e.createdAt>El},gl=function(e){return 1e3*e.createdAt>W()().subtract(7,"days").unix()&&1===e.status};function bl(e){var t=this,a=Object(pe.a)("translation").t,l=Object(n.useContext)(T).user,c=e.addToast,o=e.location,i=ge(),u=i.data,s=i.total,m=i.pages,p=i.all,E=i.search,f=i.goto,v=i.filters,g=i.status,b=i.refresh,h=Object(n.useState)(!1),y=Object(d.a)(h,2),C=y[0],O=y[1],j=Object(n.useState)(!1),S=Object(d.a)(j,2),I=S[0],w=S[1],x=Object(n.useState)(!1),k=Object(d.a)(x,2),N=k[0],P=k[1],D=Object(n.useState)(!1),R=Object(d.a)(D,2),A=R[0],F=R[1],L=Object(n.useState)(!1),V=Object(d.a)(L,2),z=V[0],M=V[1],B=Object(n.useState)([]),H=Object(d.a)(B,2),_=H[0],U=H[1],q=Object(n.useState)(!1),Y=Object(d.a)(q,2),J=Y[0],G=Y[1],K=Object(n.useState)(void 0),X=Object(d.a)(K,2),Q=X[0],$=X[1],Z=new URLSearchParams(o.search),ee=Number(Z.get("status")),te=Number(Z.get("paymentStatus")),ae=Object(n.useState)(ee>-1?ee:void 0),ne=Object(d.a)(ae,2),re=ne[0],le=ne[1],ce=Object(n.useState)(te>-1?te:void 0),oe=Object(d.a)(ce,2),ie=oe[0],ue=oe[1],se=function(){$(void 0),G(!1),w(!1)},me=function(){se(),b()};Object(n.useEffect)((function(){g.isSuccess&&(re>0||ie>0?v.setPredicate((function(e){var t=e.processStatus,a=e.status;return(!(re>0)||t===re)&&(!(ie>0)||a===ie)})):v.setPredicate(void 0))}),[re,ie,g]),Object(n.useEffect)((function(){C||p.some(vl)&&(c(a("You have quotations older than 30 days"),{appearance:"warning",autoDismissTimeout:1e4}),O(!0))}),[p]),Object(n.useEffect)((function(){N||p.some(fl)&&(c(a("You have orders haven't received payment since 30 days"),{appearance:"warning",autoDismissTimeout:1e4}),P(!0))}),[p]),Object(n.useEffect)((function(){if(!z||!A){for(var e=!1,t=!1,n=0;n<p.length;n++){var r=p[n];if(r.estConclusionDate&&![8].includes(r.processStatus)){var l=W()(r.estConclusionDate).diff(W()(),"day");l<=0&&(e=!0),l<=5&&l>0&&(t=!0)}}e&&(c(a("You are due to conclude order(s)"),{appearance:"error",autoDismissTimeout:1e4}),M(!0)),t&&(c(a("You are near due to conclude order(s)"),{appearance:"warning",autoDismissTimeout:1e4}),F(!0))}}),[p]);var de=!(!l.isRep&&8!==l.roleNumber||!(l.maxOrders>0))&&p.filter(gl).length===l.maxOrders,ve=u.find((function(e){return e._id===Q})),be=ve?I?a("Update")+" "+a("Quotation"):a("Update")+" "+a("Order"):I?a("Create")+" "+a("Quotation"):a("Place")+" "+a("Order");return g.isLoading?r.a.createElement(st,null):r.a.createElement("div",{className:"container"},r.a.createElement("h2",null,a("Orders")),(J||ve&&4!==ve.status)&&r.a.createElement(pl,{addToast:e.addToast,onClose:se,afterPlace:me,initialValue:ve,okText:be}),(I||4===(null===ve||void 0===ve?void 0:ve.status))&&r.a.createElement(pl,{addToast:e.addToast,onClose:se,afterPlace:me,initialValue:ve,okText:be,isQuotation:I||4===ve.status}),r.a.createElement("div",{style:{display:"flex",justifyContent:"space-between"}},r.a.createElement("div",null,r.a.createElement("span",{style:{marginRight:16}},a("Total"),": ",s),r.a.createElement(Ht.a.Search,{style:{marginRight:16,width:200},placeholder:a("Search"),onChange:function(e){E(e.target.value)},value:v.searchText,allowClear:!0}),r.a.createElement(qt.a.Group,{onChange:function(e){switch(e.target.value){case"latePayments":v.setPredicate(fl);break;case"expiredQuotes":v.setPredicate(vl);break;default:v.setPredicate(void 0)}},defaultValue:"",style:{marginRight:16}},r.a.createElement(qt.a.Button,{value:""},a("All")),r.a.createElement(qt.a.Button,{value:"latePayments"},a("Late Payments")),r.a.createElement(qt.a.Button,{value:"expiredQuotes"},a("Exp. Quotations"))),r.a.createElement(Yt.a,{defaultValue:re,onChange:le,style:{width:200,marginRight:16},placeholder:a("Status"),allowClear:!0},Ee.map((function(e,t){return r.a.createElement(Yt.a.Option,{value:t},a(e))}))),r.a.createElement(Yt.a,{defaultValue:ie,onChange:ue,style:{width:200},allowClear:!0,placeholder:a("Payment Status")},fe.map((function(e,t){return r.a.createElement(Yt.a.Option,{value:t},a(e))})))),r.a.createElement("div",null,_.length>0&&r.a.createElement(Qt.a,{style:{marginLeft:16},onClick:function(){Promise.all(_.map((function(e){return Mr(e,{deleteTrxs:!1})}))).then((function(e){t.props.addToast(a("Orders deleted successfully"),{appearance:"success"})})).catch((function(e){""!==e.message?t.props.addToast(a("Could not delete orders")+": "+e.message,{appearance:"error"}):t.props.addToast(a("Something went wrong"),{appearance:"error"})})).finally((function(){U([]),b()}))},className:"negative"},a("Delete Selected")),[1,2,3,4,8].includes(l.roleNumber)&&r.a.createElement(r.a.Fragment,null,r.a.createElement(ma,{style:{marginRight:16},onClick:function(){return w(!0)},type:"primary",disabled:de},de?a("you reached limit"):a("Create")+" "+a("Quotation")),r.a.createElement(ma,{onClick:function(){return G(!0)},type:"primary",disabled:de},de?a("you reached limit"):a("Create")+" "+a("Order"))))),r.a.createElement(nl,{loadOrders:b,filters:v,addToast:e.addToast,orders:u,selectedOrders:_,setSelectedOrders:U,showOrderUpdateModal:$,admin:e.admin,pages:m,onPageChange:f}))}bl.defaultProps={orders:[],isLoading:!0};var hl=bl;var yl=function(e){var t=e.addToast,a=Object(pe.a)(["translation"]).t,l=_e(),c=l.data,o=l.total,i=l.pages,u=l.search,s=l.goto,m=(l.sort,l.filters),p=(l.status,l.refresh),E=Ye();console.log("roles :>> ",E);var f=qe(),v=f.del,g=f.status,b=Object(n.useState)(!1),h=Object(d.a)(b,2),y=h[0],C=h[1],O=Object(n.useState)(),j=Object(d.a)(O,2),S=j[0],I=j[1],w=Object(n.useState)(),x=Object(d.a)(w,2),k=x[0],N=x[1],T=function(){return C(!1)},P=function(){return I(void 0)},D=function(){return N()};return Object(n.useEffect)((function(){(g.isError||g.isSuccess)&&(t(g.message,{appearance:g.toString().toLowerCase()}),g.isSuccess&&(P(),D(),p()))}),[g]),r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"list-actions"},r.a.createElement("span",null,a("Total"),": ",o),r.a.createElement("div",{style:{marginLeft:16,marginRight:16}},r.a.createElement(Ht.a.Search,{placeholder:a("Search"),onChange:function(e){u(e.target.value)},value:m.searchText,allowClear:!0})),r.a.createElement(ma,{type:"primary",onClick:function(){return C(!0)}},a("Add")," ",a("Client"))),r.a.createElement(dt.a,{celled:!0},r.a.createElement(dt.a.Header,null,r.a.createElement(dt.a.Row,null,r.a.createElement(dt.a.HeaderCell,null,a("Actions")),r.a.createElement(dt.a.HeaderCell,null,a("ID")),r.a.createElement(dt.a.HeaderCell,null,a("First Name")),r.a.createElement(dt.a.HeaderCell,null,a("Last Name")),r.a.createElement(dt.a.HeaderCell,null,a("Email")),r.a.createElement(dt.a.HeaderCell,null,a("Mobile Number")),r.a.createElement(dt.a.HeaderCell,null,a("CPF")," / ",a("CNPJ")),r.a.createElement(dt.a.HeaderCell,null,a("Address")),r.a.createElement(dt.a.HeaderCell,null,a("Zip Code")))),r.a.createElement(dt.a.Body,null,c.map((function(e){return r.a.createElement(dt.a.Row,{key:e._id},r.a.createElement(dt.a.Cell,null,r.a.createElement(r.a.Fragment,null,r.a.createElement(Qt.a,{className:"margin-right",icon:r.a.createElement(ea.a,null),type:"danger",onClick:(a=e._id,function(){return N(a)}),size:"small",ghost:!0}),r.a.createElement(Qt.a,{className:"margin-right",icon:r.a.createElement(ra.a,null),onClick:(t=e,function(){return I(t)}),size:"small"}))),r.a.createElement(dt.a.Cell,null,e._id),r.a.createElement(dt.a.Cell,null,e.firstName),r.a.createElement(dt.a.Cell,null,e.lastName),r.a.createElement(dt.a.Cell,null,e.email),r.a.createElement(dt.a.Cell,null,r.a.createElement(Gt.a,{customInput:wa,defaultValue:e.mobileNumber,format:"(##) #### - ####",readOnly:!0})),r.a.createElement(dt.a.Cell,null,r.a.createElement(Gt.a,{customInput:wa,defaultValue:e.identificationNumber,format:"pj"===e.identificationType?"##.###.###/####-##":"###.###.###-##",readOnly:!0})),r.a.createElement(dt.a.Cell,{style:{whiteSpace:"pre"}},e.address),r.a.createElement(dt.a.Cell,null,r.a.createElement(Gt.a,{customInput:wa,defaultValue:e.zipCode,format:"#####\u2013###",readOnly:!0})));var t,a}))),r.a.createElement(dt.a.Footer,null,r.a.createElement(dt.a.Row,null,r.a.createElement(dt.a.HeaderCell,{colSpan:"20",style:{textAlign:"right"}},r.a.createElement(Et.a,{activePage:m.currentPage,totalPages:i,onPageChange:function(e,t){var a=t.activePage;return s(a)}}))))),(y||S)&&r.a.createElement(cl,{afterSave:function(){T(),P(),p()},onClose:function(){T(),P()},okText:"".concat(a(S?"Update":"Add")," ").concat(a("Client")),initialValue:S}),k&&r.a.createElement(Rt.a,{open:!0,content:a("Are you sure you want to delete")+" ?",onCancel:D,onConfirm:function(){return v(k)},cancelButton:a("No"),confirmButton:a("Delete")}))},Cl=a(185),Ol={required:!0},jl={name:[Ol],email:[Ol,{type:"email"}],password:[Ol],organizationId:[Ol],phoneNumber:[Ol,{len:11}],role:[Ol]},Sl={documents:[{name:"",url:""}],departmentIds:[],salary:{"13thDates":[]},organizationIds:[]},Il=function(e){var t,a,n,r=e.file;if("removed"===r.status)return[];(null===r||void 0===r||null===(t=r.response)||void 0===t?void 0:t.message)&&(r.uid=null===r||void 0===r||null===(a=r.response)||void 0===a?void 0:a.message,r.url="/uploads/".concat(null===r||void 0===r||null===(n=r.response)||void 0===n?void 0:n.message));return[r]};var wl=function(e,t){return 1!==t.length?Promise.reject("non-superadmins can only have one org"):Promise.resolve()};var xl=function(e){var t=e.onClose,a=e.okText,l=e.okButtonProps,c=e.onSave,o=e.initialValues,i=Bt.a.useForm(),u=Object(d.a)(i,1)[0],s=Object(n.useState)([]),p=Object(d.a)(s,2),E=p[0],f=p[1],v=z("/api/admins/roles"),g=Object(d.a)(v,1)[0],b=(g=void 0===g?{data:[]}:g).data,h=Ve().options,y=function(){var e=M("/api/v2/organizations",tt),t=Object(d.a)(e,3),a=t[0];return[(a=void 0===a?{data:[]}:a).data,t[1],t[2]]}(),C=Object(d.a)(y,1)[0],O=b.map((function(e){var t=e.roleNumber;return{label:e.name,value:t}})),j=C.map((function(e){var t=e._id;return{label:e.title,value:t}}));Object(n.useEffect)((function(){Fr().then((function(e){f(Object.entries(e).map((function(e){var t=Object(d.a)(e,2),a=t[0],n=t[1];return{value:Number(a),label:n}})))}))}),[]);var S=o?Object(m.a)(Object(m.a)({},o),{},{password:"",departmentIds:o.departmentIds||[],allowedStatuses:o.allowedStatuses||[],organizationIds:o.organizationIds||[],branchIds:o.branchIds||[],documents:o.documents||[],salary:Object(m.a)(Object(m.a)({},o.salary),{},{"13thDates":((o.salary||{})["13thDates"]||[]).map((function(e){return W()(e).format("DD/MM/YYYY")}))})}):Sl,I=C.reduce((function(e,t){var a=t.branches,n=t._id;return e.concat((a||[]).map((function(e){return{value:e._id,label:e.title,organizationId:n}})))}),[]);return console.log("organizationId :>> ",u.getFieldValue("organizationIds")),r.a.createElement(dn.a,{componentSize:"middle"},r.a.createElement(Mt.a,{title:a,onClose:t,visible:!0,okText:a,okButtonProps:Object(m.a)({form:"user-add-modal",htmlType:"submit"},l),onCancel:t,width:1124,maskClosable:!1,keyboard:!1},r.a.createElement(Bt.a,{layout:"vertical",id:"user-add-modal",form:u,onValuesChange:function(e){e.salary13thDate&&(console.log(u.getFieldValue(["salary","13thDates"])),u.setFieldsValue({salary13thDate:"",salary:{"13thDates":[].concat(Object(B.a)(u.getFieldValue(["salary","13thDates"])),[e.salary13thDate.format("DD/MM/YYYY")])}})),e.organizationIds&&u.setFieldsValue({branchIds:[]})},initialValues:S,onFinish:function(e){c(Object(m.a)(Object(m.a)({},e),{},{salary:Object(m.a)(Object(m.a)({},e.salary),{},{"13thDates":e.salary["13thDates"].map((function(e){return W()(e,"DD/MM/YYYY").unix()}))}),documents:e.documents.map((function(e){var t;return{name:e.name,url:null===(t=e.url[0])||void 0===t?void 0:t.uid}}))}))},size:"middle"},r.a.createElement(_t.a,{gutter:16},r.a.createElement(Ut.a,{span:4},r.a.createElement(Bt.a.Item,{label:"First Name",name:"firstName",rules:jl.firstName},r.a.createElement(Ht.a,null))),r.a.createElement(Ut.a,{span:4},r.a.createElement(Bt.a.Item,{label:"Last Name",name:"lastName",rules:jl.lastName},r.a.createElement(Ht.a,null))),r.a.createElement(Ut.a,{span:6},r.a.createElement(Bt.a.Item,{label:"Email",name:"email",rules:jl.email},r.a.createElement(Ht.a,{type:"email"}))),r.a.createElement(Ut.a,{span:6},r.a.createElement(Bt.a.Item,{label:"Password",name:"password",rules:o?void 0:jl.password},r.a.createElement(Ht.a.Password,null))),r.a.createElement(Ut.a,{span:4},r.a.createElement(Bt.a.Item,{label:"Phone No",name:"landlineNumber",rules:jl.landlineNumber,trigger:"onValueChange",getValueFromEvent:function(e){return e.value}},r.a.createElement(Gt.a,{customInput:Ht.a,format:"(##) ##### - ####",placeholder:"(00) 00000 - 0000"})))),r.a.createElement(_t.a,{gutter:16},r.a.createElement(Ut.a,{span:4},r.a.createElement(Bt.a.Item,{label:"Role",name:"roleNumber",rules:jl.role},r.a.createElement(Yt.a,{options:O}))),r.a.createElement(Ut.a,{span:10},r.a.createElement(Bt.a.Item,{noStyle:!0,dependencies:["roleNumber"]},(function(e){var t=e.getFieldValue;return r.a.createElement(Bt.a.Item,{label:"Organization",name:"organizationIds",rules:[].concat(Object(B.a)(1===t("roleNumber")?[]:[Ol]),Object(B.a)(1!==t("roleNumber")?[{validator:wl,message:"non-superadmin must have only one org"}]:[]))},r.a.createElement(Yt.a,{mode:"multiple",options:j}))}))),r.a.createElement(Ut.a,{span:10},r.a.createElement(Bt.a.Item,{dependencies:["organizationIds","roleNumber"],noStyle:!0},(function(e){var t=e.getFieldValue;return r.a.createElement(Bt.a.Item,{name:"branchIds",label:"Branches",rules:3===t("roleNumber")?[Ol]:void 0},r.a.createElement(Yt.a,{mode:"multiple",options:I.filter((function(e){var a=e.organizationId;return t("organizationIds").includes(a)})),disabled:3!==t("roleNumber")}))})))),r.a.createElement(_t.a,{gutter:16},r.a.createElement(Ut.a,{span:3},r.a.createElement(Bt.a.Item,{dependencies:["roleNumber"],noStyle:!0},(function(e){var t=e.getFieldValue;return r.a.createElement(Bt.a.Item,{className:"ant-form-item-inline",label:"Is Rep ?",name:"isRep",rules:jl.isRep,valuePropName:"checked"},r.a.createElement(Cl.a,{disabled:3!==t("roleNumber")}))}))),r.a.createElement(Ut.a,{span:5},r.a.createElement(Bt.a.Item,{dependencies:["roleNumber","isRep"],noStyle:!0},(function(e){var t=e.getFieldValue;return r.a.createElement(_t.a,{gutter:16},r.a.createElement(Ut.a,{span:12},r.a.createElement(Bt.a.Item,{label:"Commission",name:"commission",rules:jl.commission,trigger:"onValueChange",getValueFromEvent:function(e){return e.floatValue}},r.a.createElement(Gt.a,{customInput:Ht.a,thousandSeparator:".",decimalSeparator:",",disabled:!(8===t("roleNumber")||t("isRep"))}))),r.a.createElement(Ut.a,{span:12},r.a.createElement(Bt.a.Item,{label:"Max Orders",name:"maxOrders",rules:jl.commission,trigger:"onValueChange",getValueFromEvent:function(e){return e.floatValue}},r.a.createElement(Gt.a,{customInput:Ht.a,thousandSeparator:".",decimalSeparator:",",disabled:!(8===t("roleNumber")||t("isRep"))}))))}))),r.a.createElement(Ut.a,{span:8},r.a.createElement(Bt.a.Item,{dependencies:["roleNumber","organizationIds"],noStyle:!0},(function(e){var t=e.getFieldValue;return r.a.createElement(Bt.a.Item,{label:"Deparments",name:"departmentIds",rules:jl.departmentIds},r.a.createElement(Yt.a,{mode:"multiple",options:h.filter((function(e){return e.organizationId===t("organizationIds")[0]})),disabled:3!==t("roleNumber")}))}))),r.a.createElement(Ut.a,{span:8},r.a.createElement(Bt.a.Item,{dependencies:["roleNumber"],noStyle:!0},(function(e){var t=e.getFieldValue;return r.a.createElement(Bt.a.Item,{label:"Allowed Orders",name:"allowedStatuses",rules:jl.allowedStatuses},r.a.createElement(Yt.a,{mode:"multiple",options:E,disabled:3!==t("roleNumber")}))})))),r.a.createElement(_t.a,{gutter:16},r.a.createElement(Ut.a,{span:4},r.a.createElement(Bt.a.Item,{label:"Salary",name:["salary","salary"],rules:jl.salary,trigger:"onValueChange",getValueFromEvent:function(e){return e.floatValue}},r.a.createElement(Gt.a,{customInput:Ht.a,thousandSeparator:".",decimalSeparator:","}))),r.a.createElement(Ut.a,{span:8},r.a.createElement(Bt.a.Item,{label:"Frequency",name:["salary","frequency"],rules:jl.frequency},r.a.createElement(qt.a.Group,null,r.a.createElement(qt.a.Button,{value:"daily"},"Daily"),r.a.createElement(qt.a.Button,{value:"weekly"},"Weekly"),r.a.createElement(qt.a.Button,{value:"monthly"},"Monthly"),r.a.createElement(qt.a.Button,{value:"15days"},"15 days")))),r.a.createElement(Ut.a,{span:3},r.a.createElement(Bt.a.Item,{className:"ant-form-item-inline",label:"13th Salary ?",name:["salary","13th"],rules:jl["13thSalary"],valuePropName:"checked"},r.a.createElement(Cl.a,null))),r.a.createElement(Ut.a,{span:9},r.a.createElement(Bt.a.Item,{dependencies:[["salary","13th"]],noStyle:!0},(function(e){var t=e.getFieldValue;return r.a.createElement(_t.a,null,r.a.createElement(Ut.a,{span:18},r.a.createElement(Bt.a.Item,{label:"13th Salary Dates",name:["salary","13thDates"]},r.a.createElement(Yt.a,{mode:"tags",disabled:!0!==t(["salary","13th"])}))),r.a.createElement(Ut.a,{span:6},r.a.createElement(Bt.a.Item,{label:"\u2800",name:"salary13thDate"},r.a.createElement(pn.a,{disabled:!0!==t(["salary","13th"])}))))})))),r.a.createElement(ga,{label:"Documents",name:"documents"},(function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement(Bt.a.Item,{name:[e.name,"name"],fieldKey:[e.fieldKey,"name"],rules:[Ol]},r.a.createElement(Ht.a,{placeholder:"File Name"})),r.a.createElement(Bt.a.Item,{name:[e.name,"url"],fieldKey:[e.fieldKey,"url"],rules:jl.frontImageUrl,getValueFromEvent:Il,valuePropName:"fileList"},r.a.createElement($t.a,{action:"/assets/upload?entity=user",accept:"image/*,.pdf",headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}},r.a.createElement(Qt.a,null,"upload"))))})))))},kl=function(e){var t=e.value;return r.a.createElement("span",null,t)},Nl={SUCCESS:function(e,t){return"".concat(e," ").concat(t).concat(t.endsWith("e")?"":"e","d successfully!")},ERROR:function(e,t){return"status change"===t?"failed to change status of ".concat(e):"failed to ".concat(t," ").concat(e)}};var Tl=function(e){var t=function(){var e=Object(n.useState)([]),t=Object(d.a)(e,2),a=Object(d.a)(t[0],3),r=a[0],l=a[1],c=a[2],o=t[1],i=Object(n.useMemo)((function(){return"add"===c&&l?["/api/admins",{method:"POST",body:JSON.stringify(l)}]:"update"===c&&r&&l?["/api/admins/".concat(r),{method:"PUT",body:JSON.stringify(l)}]:"delete"===c&&r?["/api/admins/".concat(r),{method:"DELETE"}]:"status change"===c&&r&&l?["/api/admins/".concat(r,"/status"),{method:"POST",body:JSON.stringify(l)}]:[void 0,void 0]}),[l,c,r]),u=z.apply(void 0,Object(B.a)(i)),s=Object(d.a)(u,2)[1];return s.action=c,s.message=Nl[s.code]?Nl[s.code]("user",c):"",[function(e){return o([void 0,e,"add"])},function(e,t){return o([t,e,"update"])},function(e){return o([e,void 0,"delete"])},s]}(),a=Object(d.a)(t,4),l=a[0],c=a[1],o=a[2],i=a[3],u=ne("/api/admins","*"),s=Object(d.a)(u,8),m=s[0],p=s[1],E=p.total,f=p.pages,v=s[2],g=s[3],b=s[5],h=s[7],y=Object(n.useState)(!1),C=Object(d.a)(y,2),O=C[0],j=C[1],S=Object(n.useState)(),I=Object(d.a)(S,2),w=I[0],k=I[1],N=Object(n.useState)(),T=Object(d.a)(N,2),P=T[0],D=T[1],R=function(){return k(void 0)},A=function(){return D(void 0)};Object(n.useEffect)((function(){(i.isError||i.isSuccess)&&(e.addToast(i.message,{appearance:i.toString().toLowerCase()}),i.isSuccess&&(F(),R(),A(),h()))}),[i]);var F=function(){return j(!1)};return r.a.createElement("div",{className:"container"},r.a.createElement("div",null,r.a.createElement("h2",{style:{display:"inline",marginRight:16}},"Admins"),r.a.createElement("span",null,"Total admins: ",E),r.a.createElement("div",{class:"ui action input",style:{marginLeft:16}},r.a.createElement(mt.a,{type:"text",placeholder:"Search...",onChange:function(e){v(e.target.value)},value:b.searchText}),r.a.createElement("button",{class:"ui icon button",onClick:function(){v("")}},r.a.createElement("i",{class:"delete icon"}))),r.a.createElement("div",{style:{float:"right"}},r.a.createElement(x.a,{onClick:function(){return j(!0)},primary:!0},"Add User"))),r.a.createElement(dt.a,{celled:!0},r.a.createElement(dt.a.Header,null,r.a.createElement(dt.a.Row,null,r.a.createElement(dt.a.HeaderCell,null,"Actions"),r.a.createElement(dt.a.HeaderCell,null,"ID"),r.a.createElement(dt.a.HeaderCell,null,"First Name"),r.a.createElement(dt.a.HeaderCell,null,"Last Name"),r.a.createElement(dt.a.HeaderCell,null,"Email"),r.a.createElement(dt.a.HeaderCell,null,"Landline Number"),r.a.createElement(dt.a.HeaderCell,null,"Role"),r.a.createElement(dt.a.HeaderCell,null,"Organization"),r.a.createElement(dt.a.HeaderCell,null,"Documents"))),r.a.createElement(dt.a.Body,null,m.map((function(e){return r.a.createElement(dt.a.Row,{key:e._id},r.a.createElement(dt.a.Cell,null,r.a.createElement(x.a,{icon:"edit",basic:!0,onClick:(a=e,function(){return k(a)}),size:"mini"}),r.a.createElement(x.a,{icon:"trash alternate",negative:!0,basic:!0,onClick:(t=e._id,function(){return D(t)}),size:"mini"})),r.a.createElement(dt.a.Cell,null,e._id),r.a.createElement(dt.a.Cell,null,e.firstName),r.a.createElement(dt.a.Cell,null,e.lastName),r.a.createElement(dt.a.Cell,null,e.email),r.a.createElement(dt.a.Cell,null,r.a.createElement(Gt.a,{customInput:kl,defaultValue:e.landlineNumber,format:"(##) ##### - ####",readOnly:!0})),r.a.createElement(dt.a.Cell,null,(e.role||{}).name),r.a.createElement(dt.a.Cell,null,e.organizations.map((function(e){return e.title})).join(",")),r.a.createElement(dt.a.Cell,null,(e.documents||[]).map((function(e){var t=e.name,a=e.url;return r.a.createElement(r.a.Fragment,null,r.a.createElement("a",{href:a,target:"_blank"},t),r.a.createElement("br",null))}))));var t,a}))),r.a.createElement(dt.a.Footer,null,r.a.createElement(dt.a.Row,null,r.a.createElement(dt.a.HeaderCell,{colSpan:"20",style:{textAlign:"right"}},r.a.createElement(Et.a,{activePage:b.currentPage,totalPages:f,onPageChange:function(e,t){var a=t.activePage;return g(a)}}))))),O&&r.a.createElement(xl,{okText:"Add User",onClose:F,onSave:l}),w&&r.a.createElement(xl,{onSave:function(e){return c(e,w._id)},onClose:R,initialValues:w,okButtonProps:{disabled:i.isLoading},okText:"Update Cheque"}),P&&r.a.createElement(Rt.a,{open:!0,content:"Are you sure you want to DELETE this cheque ?",onCancel:A,onConfirm:function(){return o(P)},cancelButton:"No",confirmButton:"Yes, Delete"}))},Pl=function(e){Object(Ka.a)(a,e);var t=Object(Xa.a)(a);function a(e){var n;return Object(P.a)(this,a),(n=t.call(this,e)).fetchTransactions=function(){Ur(n.props.id).then((function(e){return n.setState({trxs:e.data},(function(){return console.log(n.state)}))})).catch((function(e){return n.props.addToast("Could not fetch related transactions",{appearance:"error"})}))},n.fetchOrderAndTransactions=function(){Lr(n.props.id).then((function(e){return n.setState({order:e})})).catch((function(e){return n.props.addToast("Could not fetch order",{appearance:"error"})})),n.fetchTransactions()},n.handleEdit=function(e){return function(){n.setState({transactionToEdit:e})}},n.handleDelete=function(e){return function(){n.setState({transactionToDelete:e})}},n.handleConfirmDelete=function(){var e=n.props.t;Vr(n.state.order._id,n.state.transactionToDelete).then((function(t){n.props.addToast(e("Transaction")+" "+e("deleted successfully"),{appearance:"success"}),n.closeDeleteConfirmation(),n.fetchOrderAndTransactions()})).catch((function(t){n.props.addToast(e("Could not delete")+" "+e("transaction"),{appearance:"error"}),n.closeDeleteConfirmation()}))},n.closeTransactionEditModal=function(){n.setState({transactionToEdit:void 0})},n.handleAfterTransactionSave=function(){n.setState({transactionToEdit:void 0},n.fetchOrderAndTransactions)},n.closeDeleteConfirmation=function(){n.setState({transactionToDelete:void 0})},n.showQR=function(){n.setState({shouldShowQR:!0})},n.hideQR=function(){n.setState({shouldShowQR:!1})},n.prepareTransactionsTable=function(e){var t=n.props.t;return r.a.createElement(dt.a.Body,null,e.map((function(e){var a;return r.a.createElement(dt.a.Row,{key:e._id},r.a.createElement(dt.a.Cell,{className:"noprint"},[1,2].includes(n.props.admin.roleNumber)&&r.a.createElement(r.a.Fragment,null,r.a.createElement(x.a,{icon:"edit",basic:!0,onClick:n.handleEdit(e),size:"mini"}),r.a.createElement(x.a,{icon:"trash alternate",negative:!0,basic:!0,onClick:n.handleDelete(e._id),size:"mini"}))),r.a.createElement(dt.a.Cell,null,W()(1e3*e.createdAt).format("DD/MM/YYYY")),r.a.createElement(dt.a.Cell,null,null===(a=Qr.paymentOptions.find((function(t){return t.value===e.method})))||void 0===a?void 0:a.text,r.a.createElement("br",null),4===e.method&&e.chequeId&&r.a.createElement(p.a,{to:"/cheques"},"(",e.chequeId,")")),r.a.createElement(dt.a.Cell,null,Pt.format(e.amount)),r.a.createElement(dt.a.Cell,null,e.fileLink&&r.a.createElement("a",{target:"_blank",href:"/assets/".concat(e.fileLink)},"\ud83d\udcce ",t("attachment"))),r.a.createElement(dt.a.Cell,null,e.comment))})))},n.state={order:{items:[]},trxs:[],transactionToEdit:void 0,transactionToDelete:void 0,shouldShowQR:!1},n}return Object(D.a)(a,[{key:"componentDidMount",value:function(){this.fetchOrderAndTransactions()}},{key:"render",value:function(){var e,t,a,n,l,c,o,i,u,s,m,d=this.state.order,p=d.items,E=this.props.t,f=p.reduce((function(e,t){return t.price*t.amount+e}),0);return r.a.createElement("div",{style:{display:"grid",gridTemplateColumns:"5fr 1fr"}},r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"printonly printonly-flex",style:{justifyContent:"space-between",marginBottom:16}},r.a.createElement(ba,{organization:this.state.order.organization}),r.a.createElement("div",null,E("Bill To"),":",r.a.createElement("div",null,r.a.createElement("strong",null,(null===(e=this.state.order.client)||void 0===e?void 0:e.firstName)+" "+(null===(t=this.state.order.client)||void 0===t?void 0:t.lastName))),r.a.createElement("div",null,null===(a=this.state.order.client)||void 0===a?void 0:a.address),r.a.createElement("div",null,null===(n=this.state.order.client)||void 0===n?void 0:n.cellNumber))),r.a.createElement(x.a,{primary:!0,className:"noprint",style:{marginBottom:16,float:"right"},onClick:function(){return window.print()}},r.a.createElement("i",{class:"print icon"}),E("Print")),r.a.createElement(Dr,{className:"noprint",style:{marginBottom:16,float:"right"},fileName:null===(l=this.state.order)||void 0===l?void 0:l._id}),r.a.createElement(Tr.a,{className:"printonly",id:"qr-canvas",value:window.location.href,size:100}),r.a.createElement(dt.a,{celled:!0},r.a.createElement(dt.a.Header,{className:"noprint"},r.a.createElement(dt.a.Row,null,r.a.createElement(dt.a.HeaderCell,null,E("Property")),r.a.createElement(dt.a.HeaderCell,null,E("Value")))),r.a.createElement(dt.a.Body,null,r.a.createElement(dt.a.Row,null,r.a.createElement(dt.a.Cell,null,E("Order ID")),r.a.createElement(dt.a.Cell,null,d.orderId)),r.a.createElement(dt.a.Row,null,r.a.createElement(dt.a.Cell,null,E("Created At")),r.a.createElement(dt.a.Cell,null,kt(d.createdAt))),r.a.createElement(dt.a.Row,null,r.a.createElement(dt.a.Cell,null,E("Created By")),r.a.createElement(dt.a.Cell,null,(null===(c=d.user)||void 0===c?void 0:c.firstName)+" "+(null===(o=d.user)||void 0===o?void 0:o.lastName))),r.a.createElement(dt.a.Row,null,r.a.createElement(dt.a.Cell,null,E("Total Items")),r.a.createElement(dt.a.Cell,null,xt(d.totalUnits))),r.a.createElement(dt.a.Row,{className:"noprint"},r.a.createElement(dt.a.Cell,null,E("Total Cost")),r.a.createElement(dt.a.Cell,null,Pt.format(d.totalCost))),r.a.createElement(dt.a.Row,{className:"noprint"},r.a.createElement(dt.a.Cell,null,E("Total Paid")),r.a.createElement(dt.a.Cell,null,Pt.format(d.totalPaid))),r.a.createElement(dt.a.Row,null,r.a.createElement(dt.a.Cell,null,E("Last Pay date")),r.a.createElement(dt.a.Cell,null,this.state.trxs.length>0?W()(1e3*this.state.trxs.sort((function(e,t){return t.createdAt-e.createdAt}))[0].createdAt).format("DD/MM/YYYY"):"-")),r.a.createElement(dt.a.Row,{className:"noprint"},r.a.createElement(dt.a.Cell,null,E("Status")),r.a.createElement(dt.a.Cell,null,Tt(E,d.status))),r.a.createElement(dt.a.Row,{className:"noprint"},r.a.createElement(dt.a.Cell,null,E("Comment")),r.a.createElement(dt.a.Cell,null,d.comment)),r.a.createElement(dt.a.Row,{className:"noprint"},r.a.createElement(dt.a.Cell,null,E("Est. Conclusion Date")),r.a.createElement(dt.a.Cell,null,d.estConclusionDate?W()(d.estConclusionDate).format("DD/MM/YYYY"):"-")),r.a.createElement(dt.a.Row,{className:"noprint"},r.a.createElement(dt.a.Cell,null,E("Client")),r.a.createElement(dt.a.Cell,null,d.client&&d.client.firstName+" "+d.client.lastName)),r.a.createElement(dt.a.Row,{className:"noprint"},r.a.createElement(dt.a.Cell,null,E("Documents")),r.a.createElement(dt.a.Cell,null,(d.documents||[]).map((function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement("a",{href:e,target:"_blank"},e),r.a.createElement("br",null))})))))),r.a.createElement("h4",null,E("Products")),r.a.createElement(dt.a,{celled:!0},r.a.createElement(dt.a.Header,null,r.a.createElement(dt.a.Row,null,r.a.createElement(dt.a.HeaderCell,null,E("Title")),r.a.createElement(dt.a.HeaderCell,null,E("Comment")),r.a.createElement(dt.a.HeaderCell,null,E("Unit Price")),r.a.createElement(dt.a.HeaderCell,null,E("Quantity")),r.a.createElement(dt.a.HeaderCell,null,E("Total")))),r.a.createElement(dt.a.Body,null,this.state.order.items.map((function(e){return r.a.createElement(dt.a.Row,{key:e.productId},r.a.createElement(dt.a.Cell,null,e.title),r.a.createElement(dt.a.Cell,null,e.comment),r.a.createElement(dt.a.Cell,null,Pt.format(e.price)),r.a.createElement(dt.a.Cell,null,e.amount),r.a.createElement(dt.a.Cell,null,Pt.format(e.amount*e.price)))})),r.a.createElement(dt.a.Row,null,r.a.createElement(dt.a.Cell,{colspan:"4",textAlign:"right"},r.a.createElement("strong",null,E("Gross Total"))),r.a.createElement(dt.a.Cell,null,r.a.createElement("strong",null,Pt.format(f)))),r.a.createElement(dt.a.Row,null,r.a.createElement(dt.a.Cell,{colspan:"4",textAlign:"right"},E("Discount")),r.a.createElement(dt.a.Cell,null,"- ",Pt.format(f-d.totalCost)," (",this.state.order.discount,"%)")),r.a.createElement(dt.a.Row,null,r.a.createElement(dt.a.Cell,{colspan:"4",textAlign:"right"},r.a.createElement("strong",null,E("Total"))),r.a.createElement(dt.a.Cell,null,r.a.createElement("strong",null,Pt.format(this.state.order.totalCost)))))),r.a.createElement("h4",null,E("Transactions")),r.a.createElement(dt.a,{celled:!0},r.a.createElement(dt.a.Header,null,r.a.createElement(dt.a.Row,null,r.a.createElement(dt.a.HeaderCell,{className:"noprint"},E("Actions")),r.a.createElement(dt.a.HeaderCell,null,E("Date")),r.a.createElement(dt.a.HeaderCell,null,E("Method")),r.a.createElement(dt.a.HeaderCell,null,E("Amount")),r.a.createElement(dt.a.HeaderCell,null,E("Proof")),r.a.createElement(dt.a.HeaderCell,null,E("Comment")))),this.prepareTransactionsTable(this.state.trxs)),this.state.transactionToEdit&&r.a.createElement($r,{order:this.state.order,addToast:this.props.addToast,initialValues:this.state.transactionToEdit,loadOrders:this.fetchTransactions,onClose:this.closeTransactionEditModal,afterSave:this.handleAfterTransactionSave}),this.state.transactionToDelete&&r.a.createElement(Rt.a,{open:!0,content:E("Are you sure you want to delete")+" "+E("transaction")+" ?",onCancel:this.closeDeleteConfirmation,onConfirm:this.handleConfirmDelete,cancelButton:E("No"),confirmButton:E("Yes")})),r.a.createElement("div",{className:"noprint",style:{padding:"20px 5%"}},this.props.admin._id===(null===(i=this.state.order.user)||void 0===i?void 0:i._id)&&8===(null===(u=this.state.order.user)||void 0===u?void 0:u.roleNumber)&&[2,3].includes(this.state.order.status)&&r.a.createElement(Cr.a,null,r.a.createElement(Cr.a.Content,null,r.a.createElement(Cr.a.Header,{content:E("Your Commission")}),r.a.createElement(Cr.a.Description,{content:r.a.createElement("div",{style:{textAlign:"center",marginTop:16}},r.a.createElement("span",{style:{color:"#508cfe",fontSize:24,fontWeight:"bold",marginRight:8}},Pt.format((null===(s=this.state.order.user)||void 0===s?void 0:s.commission)*this.state.order.totalCost/100)),r.a.createElement("span",null,"(","".concat(null===(m=this.state.order.user)||void 0===m?void 0:m.commission," %"),")"))})))))}}]),a}(r.a.Component),Dl=Object(or.a)("translation")(Pl),Rl=a(830),Al=function(e){var t=e.keyCode;return!0===e.shiftKey||35===t||36===t||8===t||9===t||13===t||46===t||t>36&&t<41||(!0===e.ctrlKey||!0===e.metaKey)&&(65===t||67===t||86===t||88===t||90===t)},Fl=function(e){(function(e){var t=e.keyCode;return t>=48&&t<=57||t>=96&&t<=105})(e)||Al(e)||e.preventDefault()},Ll=function(e){Al(e)||(e.target.value=Vl(e.target.value))},Vl=function(e){var t=e.replace(/\D/g,"").substring(0,11),a=t.substring(0,2),n=t.substring(2,7),r=t.substring(7,11);return t.length>7?"(".concat(a,") ").concat(n," - ").concat(r):t.length>2?"(".concat(a,") ").concat(n):t.length>0?"(".concat(a):void 0},zl=function(e){var t=e.onChange,a=e.defaultValue,n=Object(ia.a)(e,["onChange","defaultValue"]);return r.a.createElement(I.a.Input,Object.assign({placeholder:"(00) 00000 - 0000",onKeyDown:Fl,onKeyUp:Ll,onChange:function(e){t(Number(e.target.value.replace(/\D/g,"").substring(0,11)))},maxLength:17,defaultValue:a?Vl(a.toString()):void 0},n))};var Ml=function(e){var t=e.onUpload,a=e.fileList,l=Object(ia.a)(e,["onUpload","fileList"]),c=Object(n.useState)([]),o=Object(d.a)(c,2),i=o[0],u=o[1];return Object(n.useEffect)((function(){u(a)}),[a]),r.a.createElement($t.a,Object.assign({accept:".jpg, .jpeg, .png",listType:"picture-card",fileList:i,onChange:function(e){var a=e.fileList,n=e.file;u(a),"done"===n.status&&t(n.response)},headers:{Authorization:"Bearer "+localStorage.getItem("token")}},l),0===i.length&&r.a.createElement("div",null,r.a.createElement(ta.a,null),r.a.createElement("div",{style:{marginTop:8}},"Upload logo")))},Bl=function(e){var t=e.org,a=void 0===t?{}:t,l=e.submit,c=e.addToast,o=e.componentName,i=e.loadOrgs,u=Object(n.useState)(!1),s=Object(d.a)(u,2),m=s[0],p=s[1],E=Object(n.useState)(a.title),f=Object(d.a)(E,2),v=f[0],g=f[1],b=Object(n.useState)(!0),h=Object(d.a)(b,2),y=h[0],j=h[1],S=Object(n.useState)(null===a||void 0===a?void 0:a.logoUrl),w=Object(d.a)(S,2),k=w[0],N=w[1],T=Object(n.useState)(a.description),P=Object(d.a)(T,2),D=P[0],R=P[1],A=Object(n.useState)(!0),F=Object(d.a)(A,2),L=F[0],V=F[1],z=Object(n.useState)(a.branches||[]),M=Object(d.a)(z,2),H=M[0],_=M[1],U=Object(n.useState)(!1),q=Object(d.a)(U,2),Y=q[0],J=q[1],G=function(){var e=Object(O.a)(C.a.mark((function e(){return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(L&&y&&!Y){e.next=3;break}return e.abrupt("return");case 3:return J(!0),e.next=6,l({title:v,description:D,branches:H,logoUrl:k}).then((function(e){c("Organization ".concat(a.title?"updated":"created"," successfully"),{appearance:"success"}),window.location.reload()})).catch((function(e){c(e.message,{appearance:"error"})}));case 6:J(!1),K();case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),W=function(){p(!m)},K=function(){i(),W(),g(""),j(!0),R(""),V(!0)},X=function(e,t,a){var n=H;n[a][t]=e,console.log("newBranches :>> ",n),_(n)};Object(n.useEffect)((function(){V(Ya(D,5,0))}),[D]);var Q=Object(n.useMemo)((function(){return k?[{uid:"0",name:"logo.png",status:"done",headers:{Authorization:"Bearer "+localStorage.getItem("token")},url:k}]:[]}),[k]);return r.a.createElement(ft.a,{trigger:r.a.createElement(x.a,{onClick:W,className:"Edit"===o?"table-action-btn":"generic-create-btn"}," ","Edit"===o?r.a.createElement(pt.a,{name:"pencil"}):r.a.createElement("span",null,o)),closeIcon:!0,open:m,onClose:K},r.a.createElement(ft.a.Header,null,o," a organization"),r.a.createElement(ft.a.Content,null,r.a.createElement(I.a,{name:"createOrgForm",size:"large"},r.a.createElement(I.a.Input,{fluid:!0,placeholder:"Titulo",label:"Titulo",value:v,error:!y,onChange:function(e){return g(e.target.value)},onBlur:function(){return j(Ya(v,3,0))}}),r.a.createElement(I.a.TextArea,{fluid:!0,placeholder:"Descri\xe7\xe3o",label:"Descri\xe7\xe3o",value:D,error:!L,onChange:function(e){return R(e.target.value)}}),r.a.createElement(Ml,{onUpload:function(e){var t=e.message;return N(t)},action:"/assets/upload?entity=organization",accept:".jpg, .jpeg",name:"file",fileList:Q}),r.a.createElement(Hn.a,null),H.map((function(e,t){return r.a.createElement(r.a.Fragment,{key:e._id},r.a.createElement(I.a.Group,{widths:"equal",key:e._id},r.a.createElement(I.a.Input,{fluid:!0,placeholder:"Titulo",label:"Branch # "+t+" title",value:e.title,error:!Ya(v,3,0),onChange:function(e){return X(e.target.value,"title",t)},onBlur:function(){return j(Ya(v,3,0))}}),r.a.createElement(zl,{label:"Phone Number",onChange:function(e){return X(e,"phoneNumber",t)},defaultValue:e.phoneNumber})),r.a.createElement(I.a.TextArea,{fluid:!0,placeholder:"Descri\xe7\xe3o",label:"Branch # "+t+" description",defaultValue:e.description,error:!Ya(e.description,3,0),onChange:function(e){return X(e.target.value,"description",t)}}))})),r.a.createElement(I.a.Button,{fluid:!0,onClick:function(){_([].concat(Object(B.a)(H),[{id:H.length}]))}},"Add a branch"),r.a.createElement(x.a,{onClick:G,color:"teal",fluid:!0,size:"small",loading:Y,primary:!0},"Submit"))))},Hl=function(e){var t=e.orgs,a=e.filters,n=e.pages,l=e.onPageChange,c=e.addToast,o=e.loadOrgs,i=e.handleDelete;return r.a.createElement(dt.a,{celled:!0},r.a.createElement(dt.a.Header,null,r.a.createElement(dt.a.Row,null,r.a.createElement(dt.a.HeaderCell,null,"Actions"),r.a.createElement(dt.a.HeaderCell,null,"OrganizationID"),r.a.createElement(dt.a.HeaderCell,null,"ID"),r.a.createElement(dt.a.HeaderCell,null,"Titulo"),r.a.createElement(dt.a.HeaderCell,null,"Descri\xe7\xe3o"),r.a.createElement(dt.a.HeaderCell,null,"Branches "))),r.a.createElement(dt.a.Body,null,t.map((function(e){return r.a.createElement(dt.a.Row,null,r.a.createElement(dt.a.Cell,null,r.a.createElement(x.a,{style:{marginRight:16},icon:"trash alternate",negative:!0,basic:!0,onClick:i(e._id),size:"mini"}),r.a.createElement(Bl,{org:e,submit:function(t){return cr(e._id,t)},addToast:c,componentName:"Edit",loadOrgs:o})),r.a.createElement(dt.a.Cell,null,e._id),r.a.createElement(dt.a.Cell,null,e.organizationId),r.a.createElement(dt.a.Cell,null,e.title),r.a.createElement(dt.a.Cell,null,e.description),r.a.createElement(dt.a.Cell,null,r.a.createElement(Rl.a,{bulleted:!0},e.branches&&e.branches.map((function(e){return r.a.createElement(Rl.a.Item,null,e.title)})))))}))),r.a.createElement(dt.a.Footer,null,r.a.createElement(dt.a.Row,null,r.a.createElement(dt.a.HeaderCell,{colSpan:"20",style:{textAlign:"right"}},r.a.createElement(Et.a,{activePage:a.currentPage,totalPages:n,onPageChange:function(e,t){var a=t.activePage;return l(a)}})))))},_l=a(852),Ul=Mt.a.confirm;var ql=function(e,t,a){Ul({title:e,icon:r.a.createElement(_l.a,null),okText:t,cancelText:"No",onOk:function(){a()}})};var Yl=function(e){var t=ne("/api/v2/organizations","*"),a=Object(d.a)(t,8),l=a[0],c=a[1],o=c.total,i=c.pages,u=a[2],s=a[3],m=(a[4],a[5]),p=(a[6],a[7]),E=ke(),f=E.del,v=E.status;return Object(n.useEffect)((function(){(v.isError||v.isSuccess)&&(e.addToast(v.message,{appearance:v.toString().toLowerCase()}),v.isSuccess&&(localStorage.removeItem("organizationId"),window.location.reload()))}),[v]),r.a.createElement("div",{className:"container"},r.a.createElement("h2",null,"Organizations"),r.a.createElement(Bl,{addToast:e.addToast,loadOrgs:p,componentName:"Create",submit:lr}),r.a.createElement("div",null,r.a.createElement("span",null,"Total organizations: ",o),r.a.createElement("div",{class:"ui action input",style:{marginLeft:16}},r.a.createElement(mt.a,{type:"text",placeholder:"Search...",onChange:function(e){u(e.target.value)},value:m.searchText}),r.a.createElement("button",{class:"ui icon button",onClick:function(){u("")}},r.a.createElement("i",{class:"delete icon"})))),r.a.createElement(Hl,{orgs:l,addToast:e.addToast,filters:m,loadOrgs:p,pages:i,onPageChange:s,handleDelete:function(e){return function(){ql("This will delete everything related to organization. Do you want to continue ?","Delete",(function(){return f(e)}))}}}))},Jl=a(835),Gl=a(821),Wl=new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format,Kl={required:!0},Xl={method:[Kl],amount:[Kl,{min:1,type:"number"}]},Ql=function(e){var t,a,n,r,l=e.fileList,c=l.slice(-1)[0];if("removed"===(null===c||void 0===c?void 0:c.status))return l.slice(0,-1);(null===c||void 0===c||null===(t=c.response)||void 0===t?void 0:t.message)&&(c.uid=null===c||void 0===c||null===(a=c.response)||void 0===a?void 0:a.message,c.url=null===c||void 0===c||null===(n=c.response)||void 0===n?void 0:n.message,c.name=null===c||void 0===c||null===(r=c.response)||void 0===r?void 0:r.message);return l};var $l=function(e){var t=e.okText,a=e.onClose,l=e.onSave,c=e.initialValues,o=Object(pe.a)(["translation"]).t,i=Bt.a.useForm(),u=Object(d.a)(i,1)[0],s=at(),p=Object(d.a)(s,2),E=p[0],f=p[1],v=function(e,t){var a=E.reduce((function(e,a){return t.includes(a._id)?e+a.amount:e+0}),0);return u.getFieldValue("amount")>a?Promise.reject(""):Promise.resolve()},g=E.map((function(e){var t=e._id,a=e.no,n=e.amount;return{label:"".concat(a," (").concat(Pt.format(n),")"),value:t}})),b=Object(n.useMemo)((function(){return{amount:null===c||void 0===c?void 0:c.amount}}),[c]);return r.a.createElement(Mt.a,{title:t,onClose:a,visible:!0,okText:t,okButtonProps:{form:"make-payment-modal",htmlType:"submit"},onCancel:a,width:800,maskClosable:!1,keyboard:!1},r.a.createElement(Bt.a,{layout:"vertical",id:"make-payment-modal",onFinish:function(e){l(Object(m.a)(Object(m.a)({},e),{},{chequeIds:e.chequeIds}))},initialValues:b,form:u},r.a.createElement(_t.a,{gutter:16},r.a.createElement(Ut.a,{span:6},r.a.createElement(Bt.a.Item,{label:o("Amount"),name:"amount",rules:Xl.amount,trigger:"onValueChange",getValueFromEvent:function(e){return e.floatValue}},r.a.createElement(Gt.a,{customInput:Ht.a,thousandSeparator:".",decimalSeparator:","}))),r.a.createElement(Ut.a,{span:8},r.a.createElement(Bt.a.Item,{label:o("Method of Payment"),name:"method",rules:Xl.method},r.a.createElement(Yt.a,null,r.a.createElement(Yt.a.Option,{value:"cheque"},o("Cheque")),r.a.createElement(Yt.a.Option,{value:"cash"},o("Cash")),r.a.createElement(Yt.a.Option,{value:"credit card"},o("Credit Card")),r.a.createElement(Yt.a.Option,{value:"debit card"},o("Debit Card")),r.a.createElement(Yt.a.Option,{value:"boleto"},o("Boleto")),r.a.createElement(Yt.a.Option,{value:"deposit"},o("Deposit"))))),r.a.createElement(Ut.a,{span:10},r.a.createElement(Bt.a.Item,{dependencies:["method","amount"],noStyle:!0},(function(e){var t=e.getFieldValue;return r.a.createElement(Bt.a.Item,{label:o("Cheques"),name:"chequeIds",rules:"cheque"===t("method")?[{validator:v,message:o("cheque total should be >= expense amount")}]:void 0},r.a.createElement(Yt.a,{mode:"multiple",options:g,loading:f.isLoading,disabled:"cheque"!==t("method"),allowClear:!0}))})))),r.a.createElement(_t.a,null,r.a.createElement(Ut.a,{span:12},r.a.createElement(Bt.a.Item,{label:o("Receipt"),name:"receipts",getValueFromEvent:Ql,valuePropName:"fileList",shouldUpdate:!0},r.a.createElement($t.a,{action:"/api/assets/upload?entity=expense",accept:"image/*",headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}},r.a.createElement(Qt.a,{size:"small"},o("upload"))))),r.a.createElement(Ut.a,{span:12},r.a.createElement(Bt.a.Item,{label:o("Invoice"),name:"invoices",getValueFromEvent:Ql,valuePropName:"fileList",shouldUpdate:!0},r.a.createElement($t.a,{action:"/api/assets/upload?entity=expense",accept:"image/*",headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}},r.a.createElement(Qt.a,{size:"small"},o("upload"))))))))};var Zl={SUCCESS:function(e,t){return"".concat(e," ").concat(t).concat(t.endsWith("e")?"":"e","d successfully!")},ERROR:function(e,t){return"status change"===t?"failed to change status of ".concat(e):"failed to ".concat(t," ").concat(e)}},ec=function(e){return(e.urls||[]).map((function(e){var t=e.createdAt,a=e.url;return r.a.createElement("a",{key:a,style:{display:"block"},href:a,alt:"invoice",target:"_blank"},kt(t))}))},tc=function(e){var t=e.no,a=e.amount;return r.a.createElement(p.a,{to:"/cheques"},t," (",Pt.format(a),")")},ac=function(e){var t=e.cheques;return(void 0===t?[]:t).map((function(e){var t=e.no,a=e.amount;return r.a.createElement(r.a.Fragment,null,r.a.createElement(tc,{no:t,amount:a}),r.a.createElement("br",null))}))};var nc=function(e){var t=e.addToast,a=e.id,l=Object(pe.a)(["translation"]).t,c=function(e){return M("/api/expenses/".concat(e))}(a),o=Object(d.a)(c,2),i=o[0],u=o[1],s=function(e){var t=M("/api/expenses/".concat(e,"/payments")),a=Object(d.a)(t,3),n=a[0];return[(n=void 0===n?{data:[]}:n).data,a[1],a[2]]}(a),p=Object(d.a)(s,3),E=p[0],f=p[1],v=p[2],g=function(e){var t=Object(n.useState)([]),a=Object(d.a)(t,2),r=Object(d.a)(a[0],3),l=r[0],c=r[1],o=r[2],i=a[1],u=Object(n.useMemo)((function(){return"add"===o&&c?["/api/expenses/".concat(e,"/payments"),{method:"POST",body:JSON.stringify(Object(m.a)(Object(m.a)({},c),{},{expenseId:e}))}]:"update"===o&&e&&l&&c?["/api/expenses/".concat(e,"/payments/").concat(l),{method:"PUT",body:JSON.stringify(c)}]:"delete"===o&&e&&l?["/api/expenses/".concat(e,"/payments/").concat(l),{method:"DELETE"}]:[void 0,void 0]}),[c,e,o,l]),s=M.apply(void 0,Object(B.a)(u)),p=Object(d.a)(s,2)[1];return o&&(p.action=o,p.message=Zl[p.code]?Zl[p.code]("payment",o):""),{add:function(e){return i([void 0,e,"add"])},edit:function(e,t){return i([t,e,"update"])},del:function(e){return i([e,void 0,"delete"])},reset:function(){return i([])},status:p}}(a),b=g.add,h=g.status,y=Object(n.useState)(!1),C=Object(d.a)(y,2),O=C[0],j=C[1],S=function(){return j(!0)},I=function(){return j(!1)};Object(n.useEffect)((function(){(h.isError||h.isSuccess)&&(t(h.message,{appearance:h.toString().toLowerCase()}),h.isSuccess&&(I(),v()))}),[h]);var w=!!(i&&E.length>0)&&("custom"===i.frequency&&i.numTimes<=E.length);return r.a.createElement("div",{className:"container"},r.a.createElement(Ea,{status:u},(function(){return r.a.createElement(Jl.a,{title:i.name,bordered:!0,style:{marginBottom:32}},r.a.createElement(Jl.a.Item,{label:l("Type")},i.type),r.a.createElement(Jl.a.Item,{label:l("Fixed")},i.fixed?"True":"False"),r.a.createElement(Jl.a.Item,{label:l("Issue Date")},kt(i.issueDate)),r.a.createElement(Jl.a.Item,{label:l("Due Date")},kt(i.dueDate)),r.a.createElement(Jl.a.Item,{label:l("Frequency")},i.frequency),"custom"===i.frequency&&r.a.createElement(Jl.a.Item,{label:l("Num Of Times")},i.numTimes),r.a.createElement(Jl.a.Item,{label:l("Amount")},"custom"===i.frequency?"".concat(Wl(i.amount)," * ").concat(i.numTimes," = ").concat(Wl(i.amount*i.numTimes)):Wl(i.amount)),r.a.createElement(Jl.a.Item,{label:l("Late Fee")},Wl(i.lateFee)),i.moneySourceId&&r.a.createElement(Jl.a.Item,{label:l("Source of Money")},i.moneySourceId),r.a.createElement(Jl.a.Item,null),r.a.createElement(Jl.a.Item,{span:3,label:l("Description"),className:"whitespace-pre"},i.description))})),r.a.createElement(Ea,{status:f},(function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:{display:"flex",justifyContent:"flex-end",marginBottom:16}},r.a.createElement(Qt.a,{onClick:S,disabled:w},l("Make Payment"))),r.a.createElement(Gl.a,{dataSource:E,rowKey:"_id"},r.a.createElement(Gl.a.Column,{title:l("Date"),dataIndex:"createdAt",render:kt}),r.a.createElement(Gl.a.Column,{title:l("Method"),dataIndex:"method"}),r.a.createElement(Gl.a.Column,{title:l("Amount"),dataIndex:"amount",render:Pt.format}),r.a.createElement(Gl.a.Column,{title:l("Cheque"),dataIndex:"cheques",render:function(e){return r.a.createElement(ac,{cheques:e})}}),r.a.createElement(Gl.a.Column,{title:l("Invoice"),dataIndex:"invoices",render:function(e){return r.a.createElement(ec,{urls:e})}}),r.a.createElement(Gl.a.Column,{title:l("Receipt"),dataIndex:"receipts",render:function(e){return r.a.createElement(ec,{urls:e})}})))})),O&&r.a.createElement($l,{onSave:b,onClose:I,okText:l("Make Payment"),initialValues:i}))},rc=function(e){return(e.frontLeftHeight+e.frontRightHeight+e.midLeftHeight+e.midRightHeight+e.rearLeftHeight+e.rearRightHeight)/6*((e.leftLength+e.rightLength)/2)*e.width},lc={labelCol:{span:8},wrapperCol:{span:16}},cc={labelCol:{span:4},wrapperCol:{span:8}},oc={frontLeftHeight:0,frontRightHeight:0,midLeftHeight:0,midRightHeight:0,rearLeftHeight:0,rearRightHeight:0,leftLength:0,rightLength:0,width:0,pricePerVolume:0},ic=function(e){var t=e.values,a=Object(pe.a)(["translation"]).t,n="".concat(a("Front Left Height"),": ").concat(xt(t.frontLeftHeight),"\n").concat(a("Front Right Height"),": ").concat(xt(t.frontRightHeight),"\n").concat(a("Mid Left Height"),": ").concat(xt(t.midLeftHeight),"\n").concat(a("Mid Right Height"),": ").concat(xt(t.midRightHeight),"\n").concat(a("Rear Left Height"),": ").concat(xt(t.rearLeftHeight),"\n").concat(a("Rear Right Height"),": ").concat(xt(t.rearRightHeight),"\n").concat(a("Left Length"),": ").concat(xt(t.leftLength),"\n").concat(a("Right Length"),": ").concat(xt(t.rightLength),"\n").concat(a("Width"),": ").concat(xt(t.width),"\n").concat(a("Price Per Volume"),": ").concat(ca(t.pricePerVolume),"\n"),l=new URLSearchParams({create:!0,name:"Woods Buy",description:n,numTimes:1,frequency:"custom",amount:Number((rc(t)*t.pricePerVolume).toFixed(2)),type:"purchase",fixed:!0}),c="/expenses?".concat(l.toString());return r.a.createElement(p.a,{className:"margin-left",to:c,target:"_blank",component:ma},a("Create Expense"))},uc=function(e){var t=e.values;console.log("values :>> ",t);var a=rc(t);return r.a.createElement("div",{style:{fontSize:"1.2em"}},"Total: ",xt(a)," x ",ca(t.pricePerVolume)," = ",ca(a*t.pricePerVolume)," ",r.a.createElement(ic,{values:t}))};var sc=function(){var e=Object(pe.a)(["translation"]).t;return r.a.createElement(Bt.a,Object.assign({},lc,{initialValues:oc,className:"margin"}),r.a.createElement("h2",null,e("Calc. M3")),r.a.createElement(_t.a,{gutter:16},r.a.createElement(Ut.a,{span:12},r.a.createElement(Bt.a.Item,{label:e("Front Left Height"),name:"frontLeftHeight"},r.a.createElement(ua,null))),r.a.createElement(Ut.a,{span:12},r.a.createElement(Bt.a.Item,{label:e("Front Right Height"),name:"frontRightHeight"},r.a.createElement(ua,null)))),r.a.createElement(_t.a,{gutter:16},r.a.createElement(Ut.a,{span:12},r.a.createElement(Bt.a.Item,{label:e("Mid Left Height"),name:"midLeftHeight"},r.a.createElement(ua,null))),r.a.createElement(Ut.a,{span:12},r.a.createElement(Bt.a.Item,{label:e("Mid Right Height"),name:"midRightHeight"},r.a.createElement(ua,null)))),r.a.createElement(_t.a,{gutter:16},r.a.createElement(Ut.a,{span:12},r.a.createElement(Bt.a.Item,{label:e("Rear Left Height"),name:"rearLeftHeight"},r.a.createElement(ua,null))),r.a.createElement(Ut.a,{span:12},r.a.createElement(Bt.a.Item,{label:e("Rear Right Height"),name:"rearRightHeight"},r.a.createElement(ua,null)))),r.a.createElement(_t.a,{gutter:16},r.a.createElement(Ut.a,{span:12},r.a.createElement(Bt.a.Item,{label:e("Left Length"),name:"leftLength"},r.a.createElement(ua,null))),r.a.createElement(Ut.a,{span:12},r.a.createElement(Bt.a.Item,{label:e("Right Length"),name:"rightLength"},r.a.createElement(ua,null)))),r.a.createElement(Bt.a.Item,Object.assign({label:e("Width"),name:"width"},cc),r.a.createElement(ua,null)),r.a.createElement(Bt.a.Item,Object.assign({label:e("Price Per Volume"),name:"pricePerVolume"},cc),r.a.createElement(ua,null)),r.a.createElement(Bt.a.Item,{wrapperCol:{offset:4},shouldUpdate:!0},(function(e){var t=e.getFieldsValue;return r.a.createElement(uc,{values:t()})})))},mc={required:!0},dc={title:[mc],estConclusionDate:[mc],startDate:[mc],assigneeId:[mc],leaderId:[mc]};var pc=function(e){var t=e.onClose,a=e.okText,l=e.okButtonProps,c=e.afterSave,o=e.initialValue,i=Object(pe.a)(["translation"]).t,u=je(null===o||void 0===o?void 0:o._id),s=u.save,p=u.status,E=Object(n.useContext)(N),f=Ne((null===o||void 0===o?void 0:o.organizationId)||E).data,v=Bt.a.useForm(),g=Object(d.a)(v,1)[0];Object(n.useEffect)((function(){p.isSuccess&&(t(),c())}),[p,c,t]);var b=o?Object(m.a)(Object(m.a)({},o),{},{startDate:W.a.unix(o.startDate),estConclusionDate:W.a.unix(o.estConclusionDate)}):void 0;return r.a.createElement(Mt.a,{visible:!0,onCancel:t,title:a,onClose:t,okText:a,okButtonProps:Object(m.a)({form:"task-create-modal",htmlType:"submit"},l),width:800,maskClosable:!1,keyboard:!1},r.a.createElement(Bt.a,{form:g,layout:"vertical",id:"task-create-modal",initialValues:b,onFinish:function(e){var t=Object(m.a)(Object(m.a)(Object(m.a)({},o),e),{},{startDate:e.startDate.unix(),estConclusionDate:e.estConclusionDate.unix()});s(null===o||void 0===o?void 0:o._id,t)},onValuesChange:function(e){e.leaderId&&g.setFieldsValue({helperIds:[]})}},r.a.createElement(Bt.a.Item,{label:i("Title"),name:"title",rules:dc.name},r.a.createElement(Ht.a,null)),r.a.createElement(_t.a,{gutter:16},r.a.createElement(Ut.a,{span:8},r.a.createElement(Bt.a.Item,{label:i("Start Date"),name:"startDate",rules:dc.startDate},r.a.createElement(pn.a,{format:"DD/MM/YYYY"}))),r.a.createElement(Ut.a,{span:8},r.a.createElement(Bt.a.Item,{label:i("Est. Conclusion Date"),name:"estConclusionDate",rules:dc.estConclusionDate},r.a.createElement(pn.a,{format:"DD/MM/YYYY"})))),r.a.createElement(_t.a,{gutter:16},r.a.createElement(Ut.a,{span:8},r.a.createElement(Bt.a.Item,{label:i("Leader"),name:"leaderId",rules:dc.leaderId},r.a.createElement(Yt.a,{options:f})))),r.a.createElement(Bt.a.Item,{noStyle:!0,dependencies:["leaderId"]},(function(e){var t=e.getFieldValue;return r.a.createElement(Bt.a.Item,{label:i("Helpers"),name:"helperIds",rules:dc.helperIds},r.a.createElement(Yt.a,{options:f.filter((function(e){return e.value!==t("leaderId")})),mode:"multiple"}))})),r.a.createElement(Bt.a.Item,{label:i("Description"),name:"description",rules:dc.description},r.a.createElement(Ht.a.TextArea,{rows:4}))),p.isError&&r.a.createElement(Jt.a,{message:p.message,type:"error"}))},Ec=function(e){return e?W.a.unix(e).format("DD/MM/YYYY"):void 0};var fc=function(e){var t=e.addToast,a=Object(pe.a)(["translation"]).t,l=je(),c=(l.edit,l.changeStatus,l.status),o=de(),i=o.data,u=o.total,s=(o.pages,o.goto,o.search),m=o.filters,E=o.status,f=o.refresh,v=Object(n.useState)(),g=Object(d.a)(v,2),b=g[0],h=g[1],y=Object(n.useState)(),C=Object(d.a)(y,2),O=(C[0],C[1]),j=Object(n.useState)(!1),S=Object(d.a)(j,2),I=S[0],w=S[1],x=function(){return h(void 0)};return Object(n.useEffect)((function(){(c.isError||c.isSuccess)&&(t(c.message,{appearance:c.toString().toLowerCase()}),c.isSuccess&&(x(),f()))}),[c]),r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"list-actions"},r.a.createElement("span",null,a("Total"),": ",u),r.a.createElement("div",{style:{marginLeft:16,marginRight:16}},r.a.createElement(Ht.a.Search,{placeholder:a("Search"),onChange:function(e){return s(e.target.value)},value:m.searchText,allowClear:!0})),r.a.createElement(ma,{type:"primary",onClick:function(){return w(!0)}},a("Create Task"))),r.a.createElement(Ea,{status:E},(function(){return r.a.createElement(Gl.a,{dataSource:i,rowKey:"_id"},r.a.createElement(Gl.a.Column,{title:a("Action"),key:"action",render:function(e,t){return r.a.createElement(r.a.Fragment,null,r.a.createElement(Qt.a,{className:"margin-right",icon:r.a.createElement(ea.a,null),type:"danger",onClick:(n=t._id,function(){return O(n)}),size:"small",ghost:!0}),r.a.createElement(Qt.a,{className:"margin-right",icon:r.a.createElement(ra.a,null),onClick:(a=t,function(){return h(a)}),size:"small"}));var a,n}}),r.a.createElement(Gl.a.Column,{key:"title",dataIndex:"",title:a("Title"),render:function(e){return r.a.createElement(p.a,{to:"/tasks/".concat(e._id)},e.title)}}),r.a.createElement(Gl.a.Column,{key:"description",dataIndex:"description",title:a("Description")}),r.a.createElement(Gl.a.Column,{key:"startDate",dataIndex:"startDate",title:a("Start Date"),render:Ec}),r.a.createElement(Gl.a.Column,{key:"estConclusionDate",dataIndex:"estConclusionDate",title:a("Est. Conclusion Date"),render:Ec}),r.a.createElement(Gl.a.Column,{key:"assignee",dataIndex:"assignee",render:function(e){var t=e.firstName,a=e.lastName;return"".concat(t," ").concat(a)},title:a("Assignee")}),r.a.createElement(Gl.a.Column,{key:"leader",title:a("Leader"),dataIndex:"leader",render:function(e){var t=e.firstName,a=e.lastName;return"".concat(t," ").concat(a)}}),r.a.createElement(Gl.a.Column,{key:"helpers",dataIndex:"helpers",title:a("Helpers"),render:function(e){return e.map((function(e){var t=e.firstName,a=e.lastName;return"".concat(t," ").concat(a)})).join(",")}}))})),(I||b)&&r.a.createElement(pc,{afterSave:function(){f()},onClose:function(){w(!1),x()},initialValue:b,okText:"".concat(a(b?"Update":"Create")," ").concat(a("Task"))}))};function vc(e){var t=e.task;return r.a.createElement("div",{className:"printonly printonly-flex space-between"},r.a.createElement(ba,{organization:t.organization}),r.a.createElement(Tr.a,{id:"qr-canvas",value:window.location.href,size:100}))}var gc=function(e){var t=e.id,a=Object(pe.a)(["translation"]).t,n=je(t),l=n.data,c=n.getStatus;return r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"text-right margin-bottom noprint"},r.a.createElement(Qt.a,{icon:r.a.createElement(Qn.a,null),onClick:function(){return window.print()}},"Print")),r.a.createElement(Ea,{status:c},(function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(vc,{task:l}),r.a.createElement(Jl.a,{bordered:!0,style:{marginBottom:32}},r.a.createElement(Jl.a.Item,{label:a("Title"),span:3},l.title),r.a.createElement(Jl.a.Item,{label:a("Description"),span:3},l.description),r.a.createElement(Jl.a.Item,{label:a("Start Date"),span:1.5},W.a.unix(l.startDate).format("DD/MM/YYYY")),r.a.createElement(Jl.a.Item,{label:a("Est. Conlusion"),span:1.5},W.a.unix(l.estConclusionDate).format("DD/MM/YYYY")),r.a.createElement(Jl.a.Item,{label:a("Assignee"),span:1.5},l.assignee.name),r.a.createElement(Jl.a.Item,{label:a("Leader"),span:1.5},l.leader.name),r.a.createElement(Jl.a.Item,{label:a("Helpers"),span:3},l.helpers.map((function(e){return e.name})).join(","))))})))},bc=Pt.format;function hc(e){var t=e.products,a=Object(pe.a)(["translation"]).t;return r.a.createElement(Gl.a,{dataSource:t,showHeader:!1,size:"small",pagination:!1},r.a.createElement(Gl.a.Column,{dataIndex:"title",title:a("Title"),width:"50%"}),r.a.createElement(Gl.a.Column,{render:function(e){return"(".concat(e.amount," x ").concat(bc(e.price),")")}}))}var yc=function(e){return bc(e.reduce((function(e,t){return e+t.amount*t.price}),0))};var Cc=function(){var e=Object(pe.a)(["translation"]).t,t=ge(aa()),a=t.all,n=t.status;return r.a.createElement(Ea,{status:n},(function(){return r.a.createElement(Gl.a,{dataSource:a,pagination:!1,bordered:!0,size:"small"},r.a.createElement(Gl.a.Column,{dataIndex:"orderId",title:e("ID")}),r.a.createElement(Gl.a.Column,{dataIndex:"createdAt",title:e("Created At"),render:function(e){return W()(1e3*e).format("DD/MM/YY")}}),r.a.createElement(Gl.a.Column,{dataIndex:"items",title:e("Products"),render:function(e){return r.a.createElement(hc,{products:e})}}),r.a.createElement(Gl.a.Column,{dataIndex:"items",title:e("Total"),render:yc}),r.a.createElement(Gl.a.Column,{dataIndex:["client","name"],title:e("Client")}),r.a.createElement(Gl.a.Column,{dataIndex:"_status",title:e("Status")}),r.a.createElement(Gl.a.Column,{dataIndex:"_processStatus",title:e("Process Status")}))}))},Oc=function(e){return e.isService?void 0:e.totalUnits},jc=Pt.format;var Sc=function(){var e=Object(pe.a)(["translation"]).t,t=le(aa()),a=t.all,n=t.status;return r.a.createElement(Ea,{status:n},(function(){return r.a.createElement(Gl.a,{dataSource:a,pagination:!1,bordered:!0,size:"small"},r.a.createElement(Gl.a.Column,{dataIndex:"title",title:e("Title")}),r.a.createElement(Gl.a.Column,{dataIndex:"description",title:e("Description")}),r.a.createElement(Gl.a.Column,{title:e("Total Units"),render:Oc}),r.a.createElement(Gl.a.Column,{dataIndex:"cost",title:e("Cost"),render:jc}),r.a.createElement(Gl.a.Column,{dataIndex:"price",title:e("Price"),render:jc}),r.a.createElement(Gl.a.Column,{dataIndex:"status",title:e("Status")}))}))};var Ic=function(){var e=Object(pe.a)(["translation"]).t,t=de(aa()),a=t.all,n=t.status;return r.a.createElement(Ea,{status:n},(function(){return r.a.createElement(Gl.a,{dataSource:a,pagination:!1,bordered:!0,size:"small"},r.a.createElement(Gl.a.Column,{dataIndex:"title",title:e("Title")}),r.a.createElement(Gl.a.Column,{dataIndex:"description",title:e("Description")}),r.a.createElement(Gl.a.Column,{dataIndex:"startDate",title:e("Start Date"),render:function(e){return W.a.unix(e).format("DD/MM/YYYY")}}),r.a.createElement(Gl.a.Column,{dataIndex:"estConclusionDate",title:e("Est. Conclusion Date"),render:function(e){return W.a.unix(e).format("DD/MM/YYYY")}}),r.a.createElement(Gl.a.Column,{dataIndex:["assignee","name"],title:e("Assignee")}),r.a.createElement(Gl.a.Column,{dataIndex:["leader","name"],title:e("Leader")}),r.a.createElement(Gl.a.Column,{dataIndex:"helpers",title:e("Helpers"),render:function(e){return e.map((function(e){return e.name})).join(",")}}))}))};var wc=function(){var e=Object(pe.a)(["translation"]).t,t=be(aa()),a=t.all,n=t.status;return r.a.createElement(Ea,{status:n},(function(){return r.a.createElement(Gl.a,{dataSource:a,pagination:!1,bordered:!0,size:"small"},r.a.createElement(Gl.a.Column,{dataIndex:"name",title:e("Title")}),r.a.createElement(Gl.a.Column,{dataIndex:"type",title:e("Type")}),r.a.createElement(Gl.a.Column,{dataIndex:"issueDate",title:e("Issue Date"),render:function(e){return W.a.unix(e).format("DD/MM/YYYY")}}),r.a.createElement(Gl.a.Column,{dataIndex:"dueDate",title:e("Due Date"),render:function(e){return W.a.unix(e).format("DD/MM/YYYY")}}),r.a.createElement(Gl.a.Column,{dataIndex:"frequency",title:e("Frequency")}),r.a.createElement(Gl.a.Column,{dataIndex:"amount",title:e("Amount"),render:ca}))}))};var xc=function(){var e=Object(pe.a)(["translation"]).t,t=M("/api/products-stats".concat(window.location.search)),a=Object(d.a)(t,2),n=a[0],l=void 0===n?[]:n,c=a[1];return r.a.createElement(Ea,{status:c},(function(){return r.a.createElement(Gl.a,{dataSource:l,pagination:!1,bordered:!0,size:"small"},r.a.createElement(Gl.a.Column,{dataIndex:["department","title"],title:e("Title")}),r.a.createElement(Gl.a.Column,{dataIndex:"total",title:e("Products"),render:xt}),r.a.createElement(Gl.a.Column,{dataIndex:"worthCost",title:"".concat(e("Worth")," ").concat(e("Cost")),render:ca}),r.a.createElement(Gl.a.Column,{dataIndex:"worthPrice",title:"".concat(e("Worth")," ").concat(e("Price")),render:ca}))}))};function kc(){var e=Object(pe.a)(["translation"]).t,t=M("/api/orders-stats".concat(window.location.search)),a=Object(d.a)(t,2),n=a[0],l=void 0===n?{}:n,c=a[1],o=M("/api/dashboard".concat(window.location.search)),i=Object(d.a)(o,2),u=i[0],s=void 0===u?{}:u,m=i[1],p=0,E=0,f=0,v=0,g=0,b=0,h=0;return c.isSuccess&&m.isSuccess&&(p=l.open.revenue+l.closed.revenue+l.partial.revenue,E=l.open.cost+l.closed.cost+l.partial.cost,f=l.open.orders+l.closed.orders+l.partial.orders,v=l.closed.revenue+l.partial.collected,g=l.open.revenue+(l.partial.revenue-l.partial.collected),b=l.partial.revenue+l.closed.revenue-l.partial.cost-l.closed.cost,h=b-s.totalexpenses),r.a.createElement(Ea,{status:c},(function(){return r.a.createElement("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",columnGap:16}},r.a.createElement(Jl.a,{title:e("Placed Orders"),bordered:!0,size:"small"},r.a.createElement(Jl.a.Item,{label:e("Profit"),span:3},ca(p-E)),r.a.createElement(Jl.a.Item,{label:e("Placed Orders"),span:3},xt(f)),r.a.createElement(Jl.a.Item,{label:e("Revenue"),span:1.5},ca(p)),r.a.createElement(Jl.a.Item,{label:e("Cost"),span:1.5},ca(E)),r.a.createElement(Jl.a.Item,{label:e("Collected"),span:1.5},ca(v)),r.a.createElement(Jl.a.Item,{label:e("Yet to collect"),span:1.5},ca(g))),r.a.createElement(Jl.a,{title:e("Real Profits"),bordered:!0,size:"small"},r.a.createElement(Jl.a.Item,{label:e("Real Profits"),span:3},ca(h)),r.a.createElement(Jl.a.Item,{label:e("Profit"),span:1.5},ca(b)),r.a.createElement(Jl.a.Item,{label:e("Expense"),span:1.5},ca(s.totalexpenses))))}))}var Nc=function(){var e=Object(pe.a)(["translation"]).t;return r.a.createElement(r.a.Fragment,null,r.a.createElement(kc,null),r.a.createElement("h3",{style:{margin:"16px 0"}},e("Departments")),r.a.createElement(xc,null),r.a.createElement("h3",{style:{margin:"16px 0"}},e("Products")),r.a.createElement(Sc,null),r.a.createElement("h3",{style:{margin:"16px 0"}},e("Orders")),r.a.createElement(Cc,null),r.a.createElement("h3",{style:{margin:"16px 0"}},e("Tasks")),r.a.createElement(Ic,null),r.a.createElement("h3",{style:{margin:"16px 0"}},e("Expenses")),r.a.createElement(wc,null),r.a.createElement(Qt.a,{className:"noprint",icon:r.a.createElement(Qn.a,null),type:"primary",style:{position:"fixed",bottom:16,right:16},onClick:function(){return window.print()}},e("Print")))},Tc=(a(800),{required:!0}),Pc={name:[Tc],password:[Tc],phoneNumber:[Tc,{len:11}],email:[Tc,{type:"email"}]};var Dc=function(e){var t=e.setOnboarded,a=M("/api/check-onboarded"),l=Object(d.a)(a,1)[0],c=(l=void 0===l?{}:l).onboarded,o=function(){var e=Object(n.useState)(),t=Object(d.a)(e,2),a=t[0],r=t[1],l=Object(n.useMemo)((function(){return a?["/api/onboard",{method:"POST",body:JSON.stringify(a)}]:[]}),[a]),c=M.apply(void 0,Object(B.a)(l)),o=Object(d.a)(c,2),i=o[0];return{onboarded:(i=void 0===i?{}:i).onboarded,onboard:r,status:o[1]}}(),i=o.onboarded,u=o.onboard,s=o.status;return Object(n.useEffect)((function(){c&&t(!0)}),[c]),Object(n.useEffect)((function(){i&&t(!0)}),[i]),Object(n.useEffect)((function(){s.isError&&ct.b.error(s.message||"failed to onboard"),s.isSuccess&&(ct.b.success("super admin onboarded successfully"),Object(p.d)("/login"))}),[s]),r.a.createElement("div",{className:"onboard-form-container"},r.a.createElement(Bt.a,{className:"onboard-form",id:"onboard-form",layout:"vertical",size:"large",onFinish:u},r.a.createElement(Bt.a.Item,{label:"Super Admin Name",name:"firstName",rules:Pc.name},r.a.createElement(Ht.a,null)),r.a.createElement(Bt.a.Item,{label:"Email",name:"email",rules:Pc.email},r.a.createElement(Ht.a,null)),r.a.createElement(Bt.a.Item,{label:"Password",name:"password",rules:Pc.password},r.a.createElement(Ht.a.Password,null)),r.a.createElement(Bt.a.Item,{label:"Phone No",name:"landlineNumber",trigger:"onValueChange",getValueFromEvent:function(e){return e.value},rules:Pc.phoneNumber},r.a.createElement(Gt.a,{customInput:Ht.a,format:"(##) ##### - ####",placeholder:"(00) 00000 - 0000"})),r.a.createElement("div",{className:"text-right"},r.a.createElement(Qt.a,{type:"primary",htmlType:"submit"},"Submit"))))},Rc={title:[oa],departments:[oa]};var Ac=function(e){var t=e.initialValue,a=e.afterSave,l=e.onClose,c=e.okText,o=Object(pe.a)(["translation"]).t,i=Le(null===t||void 0===t?void 0:t._id),u=i.save,s=i.status,m=Ve();m.options,m.status,Object(n.useEffect)((function(){s.isSuccess&&(ct.b.success(s.message),a())}),[s,a,l]);var d=na(o,Rc);return r.a.createElement(da,{formID:"brand-add-modal",onClose:l,okText:c},r.a.createElement(Bt.a,{layout:"vertical",id:"brand-add-modal",initialValues:t,onFinish:function(e){u(null===t||void 0===t?void 0:t._id,e)}},r.a.createElement(Bt.a.Item,{name:"title",label:o("Title"),rules:d.title},r.a.createElement(Ht.a,null)),r.a.createElement(Bt.a.Item,{name:"description",label:o("Description"),rules:d.description},r.a.createElement(Ht.a.TextArea,{rows:4}))),s.isError&&r.a.createElement(Jt.a,{message:s.message,type:"error"}))};a(801);var Fc=function(e){var t=Object(pe.a)(["translation"]).t,a=Re(),l=a.all,c=a.total,o=(a.pages,a.search),i=(a.goto,a.sort,a.filters),u=a.status,s=a.refresh,m=Le(),p=m.del,E=m.status,f=Object(n.useState)(!1),v=Object(d.a)(f,2),g=v[0],b=v[1],h=Object(n.useState)(void 0),y=Object(d.a)(h,2),C=y[0],O=y[1],j=Object(n.useState)(void 0),S=Object(d.a)(j,2),I=S[0],w=S[1],x=function(){b(!1),O(void 0)};return Object(n.useEffect)((function(){E.isSuccess&&(w(void 0),s())}),[E,s]),r.a.createElement("div",{className:"container"},r.a.createElement("h2",null,t("Brands")),r.a.createElement("div",{className:"list-actions"},r.a.createElement("span",null,t("Total"),": ",c),r.a.createElement("div",{style:{marginLeft:16,marginRight:16}},r.a.createElement(Ht.a.Search,{placeholder:t("Search"),onChange:function(e){return o(e.target.value)},value:i.searchText,allowClear:!0})),r.a.createElement(ma,{type:"primary",onClick:function(){return b(!0)}},t("Add")," ",t("Brand"))),r.a.createElement(Ea,{status:u},(function(){return r.a.createElement(Gl.a,{dataSource:l,rowKey:"_id",bordered:!0},r.a.createElement(Gl.a.Column,{key:"actions",title:t("Actions"),render:la(O,w)}),r.a.createElement(Gl.a.Column,{dataIndex:"_id",title:t("ID")}),r.a.createElement(Gl.a.Column,{dataIndex:"title",title:t("Title")}),r.a.createElement(Gl.a.Column,{dataIndex:"description",title:t("Description")}))})),(g||C)&&r.a.createElement(Ac,{afterSave:function(){x(),s()},onClose:x,initialValue:C,okText:"".concat(t(C?"Update":"Add")," ").concat(t("Brand"))}),I&&r.a.createElement(Rt.a,{open:!0,content:t("Are you sure you want to delete")+" ?",onCancel:function(){return w()},onConfirm:function(){return p(I)},cancelButton:t("No"),confirmButton:t("Delete")}))},Lc={title:[oa],departments:[oa],categoryTitle:[oa],subCategoryTitle:[oa]};var Vc=function(e){var t=e.initialValue,a=e.afterSave,l=e.onClose,c=e.okText,o=Object(pe.a)(["translation"]).t,i=Be(null===t||void 0===t?void 0:t._id),u=i.save,s=i.status;Object(n.useEffect)((function(){s.isSuccess&&(ct.b.success(s.message),a())}),[s,a,l]);var m=na(o,Lc);return r.a.createElement(da,{formID:"department-form-modal",onClose:l,okText:c,style:{top:16}},r.a.createElement(Bt.a,{layout:"vertical",id:"department-form-modal",initialValues:t,onFinish:function(e){u(e,null===t||void 0===t?void 0:t._id)}},r.a.createElement(Bt.a.Item,{name:"title",label:o("Title"),rules:m.title},r.a.createElement(Ht.a,null)),r.a.createElement(Bt.a.Item,{name:"description",label:o("Description"),rules:m.description},r.a.createElement(Ht.a.TextArea,{rows:4})),!(null===t||void 0===t?void 0:t._id)&&r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:{paddingBottom:8}},o("Categories")),r.a.createElement(Bt.a.List,{name:"categories"},(function(e,t){var a=t.add,n=t.remove;return r.a.createElement(r.a.Fragment,null,e.map((function(e){return r.a.createElement("div",{key:e.key},r.a.createElement("div",{className:"categories-form-item-wrapper"},r.a.createElement(Bt.a.Item,{name:[e.name,"title"],fieldKey:[e.fieldKey,"title"],rules:m.categoryTitle},r.a.createElement(Ht.a,null)),r.a.createElement(Bt.a.Item,{name:[e.name,"description"],fieldKey:[e.fieldKey,"description"],rules:m.categoryDescription},r.a.createElement(Ht.a.TextArea,{rows:1})),r.a.createElement(Qt.a,{type:"danger",ghost:!0,icon:r.a.createElement(fa.a,null),onClick:function(){return n(e.name)}})),r.a.createElement(Bt.a.List,{name:[e.name,"subcategories"]},(function(e,t){var a=t.add,n=t.remove;return r.a.createElement("div",{style:{marginLeft:16,borderBottom:"1px dashed #d9d9d9",borderLeft:"1px dashed #d9d9d9",paddingLeft:16,marginBottom:16}},e.map((function(e){return r.a.createElement("div",{className:"subcategories-form-item-wrapper",key:e.key},r.a.createElement(Bt.a.Item,{name:[e.name,"title"],fieldKey:[e.fieldKey,"title"],rules:m.subCategoryTitle},r.a.createElement(Ht.a,null)),r.a.createElement(Bt.a.Item,{name:[e.name,"description"],fieldKey:[e.fieldKey,"description"],rules:m.subCategoryDescription},r.a.createElement(Ht.a.TextArea,{rows:1})),r.a.createElement(Qt.a,{type:"danger",ghost:!0,icon:r.a.createElement(fa.a,null),onClick:function(){return n(e.name)}}))})),r.a.createElement(Qt.a,{className:"add-btn",type:"link",onClick:function(){return a()}},"+ ",o("Add")," ",o("Sub Category")))})))})),r.a.createElement(Qt.a,{className:"add-btn",type:"link",onClick:function(){return a()}},"+ ",o("Add")," ",o("Category")))})))),s.isError&&r.a.createElement(Jt.a,{message:s.message,type:"error"}))};a(802);var zc=function(){var e=Object(pe.a)(["translation"]).t,t=De(),a=t.all,l=t.total,c=t.search,o=t.filters,i=t.status,u=t.refresh,s=Object(n.useState)(!1),p=Object(d.a)(s,2),E=p[0],f=p[1],v=Object(n.useState)(void 0),g=Object(d.a)(v,2),b=g[0],h=g[1],y=Object(n.useState)(void 0),C=Object(d.a)(y,2),O=C[0],j=C[1],S=Be(),I=S.del,w=S.status,x=function(){f(!1),h(void 0)};Object(n.useEffect)((function(){w.isSuccess&&(j(void 0),u(),ct.b.success(w.message))}),[w]);var k=a.map((function(e){return Object(m.a)(Object(m.a)({},e),{},{categories:(e.categories||[]).map((function(e){return Object(m.a)(Object(m.a)({},e),{},{key:e.title,children:(e.subcategories||[]).map((function(t){return Object(m.a)(Object(m.a)({},t),{},{isLeaf:!0,key:"".concat(e.title," ").concat(t.title)})}))})}))})}));return console.log("departmentsTree :>> ",k),r.a.createElement("div",{className:"container"},r.a.createElement("h2",null,e("Departments")),r.a.createElement("div",{className:"list-actions"},r.a.createElement("span",null,e("Total"),": ",l),r.a.createElement("div",{style:{marginLeft:16,marginRight:16}},r.a.createElement(Ht.a.Search,{placeholder:e("Search"),onChange:function(e){return c(e.target.value)},value:o.searchText,allowClear:!0})),r.a.createElement(ma,{type:"primary",onClick:function(){return f(!0)}},e("Add")," ",e("Department"))),r.a.createElement(Ea,{status:i},(function(){return r.a.createElement(Gl.a,{dataSource:k,rowKey:"_id",bordered:!0},r.a.createElement(Gl.a.Column,{key:"actions",title:e("Actions"),render:la(h,j)}),r.a.createElement(Gl.a.Column,{dataIndex:"_id",title:e("ID")}),r.a.createElement(Gl.a.Column,{dataIndex:"title",title:e("Title")}),r.a.createElement(Gl.a.Column,{dataIndex:"description",title:e("Description")}))})),(E||b)&&r.a.createElement(Vc,{afterSave:function(){x(),u()},onClose:x,initialValue:b,okText:"".concat(e(b?"Update":"Add")," ").concat(e("Department"))}),O&&r.a.createElement(Rt.a,{open:!0,content:e("Are you sure you want to delete")+" ?",onCancel:function(){return j()},onConfirm:function(){return I(O)},cancelButton:e("No"),confirmButton:e("Delete")}))},Mc=a(244),Bc=a(437);function Hc(){return Object(n.useEffect)((function(){localStorage.removeItem("token"),localStorage.removeItem("user"),localStorage.removeItem("onboarded"),localStorage.removeItem("organizationId"),localStorage.removeItem("locale")}),[]),r.a.createElement("div",null,"DONE")}var _c={"en-US":Mc.a,"pt-BR":Bc.a},Uc={validateMessages:{required:"field is required"}},qc=function(){return localStorage.getItem("token")},Yc=function(){return!!localStorage.getItem("onboarded")},Jc=function(){var e,t=Object(pe.a)("translation").t,a=Object(n.useState)(null!==(e=localStorage.getItem("organizationId"))&&void 0!==e?e:void 0),l=Object(d.a)(a,2),c=l[0],i=l[1],u=Object(n.useState)(qc),s=Object(d.a)(u,2),E=s[0],f=s[1],v=Object(n.useState)(localStorage.getItem("locale")||"pt-BR"),g=Object(d.a)(v,2),b=g[0],h=g[1],y=M(Yc()?void 0:"/api/check-onboarded"),C=Object(d.a)(y,2),O=C[0],j=(O=void 0===O?{}:O).onboarded,S=void 0!==j&&j,I=C[1],w=Object(n.useMemo)((function(){return Yc()||S}),[S]),x=Object(n.useCallback)((function(e){localStorage.setItem("token",e),f(e)}),[]),k=function(){localStorage.removeItem("token"),f()},P=Object(n.useMemo)((function(){return E?function(e){try{return JSON.parse(atob(e.split(".")[1]))}catch(t){return void console.error(t)}}(E):{}}),[E]).user,D=Object(n.useMemo)((function(){return Object(m.a)(Object(m.a)({},E?{token:E,user:P}:{}),{},{logout:k})}),[E,P]);Object(n.useEffect)((function(){c?localStorage.setItem("organizationId",c):localStorage.removeItem("organizationId")}),[c]),Object(n.useEffect)((function(){I.isSuccess&&localStorage.setItem("onboarded",S)}),[I,S]),Object(n.useEffect)((function(){!w&&I.isSuccess&&Object(p.d)("/onboard")}),[w,I]),Object(n.useEffect)((function(){o.a.changeLanguage(b),localStorage.setItem("locale",b)}),[b]),Object(n.useEffect)((function(){E||Object(p.d)("/login")}),[E]);var R="false"!==new URLSearchParams(window.location.search).get("nav"),A=Object(n.useMemo)((function(){return Object(m.a)(Object(m.a)({},Uc),{},{validateMessages:Object.fromEntries(Object.entries(Uc.validateMessages).map((function(e){var a=Object(d.a)(e,2),n=a[0],r=a[1];return[n,t(r)]})))})}),[t]);return r.a.createElement(T.Provider,{value:D},r.a.createElement(N.Provider,{value:c},r.a.createElement(dn.a,{form:A,locale:_c[b]},r.a.createElement("div",{className:"fill"},E&&R&&r.a.createElement("header",{className:"noprint"},r.a.createElement(sr,{admin:P,logout:k,onOrganizationChange:i,onLocaleChange:h,locale:b})),r.a.createElement("main",{className:"fill"},r.a.createElement(p.c,{id:"router"},r.a.createElement(ot,{path:"login",onLogin:x}),r.a.createElement(Hc,{path:"reset-cache"}),r.a.createElement(Dc,{path:"/onboard"}),r.a.createElement(ya,{path:"/",component:ar}),r.a.createElement(ya,{path:"/products",component:qa}),r.a.createElement(ya,{path:"/products/view/:id",component:Ar}),r.a.createElement(ya,{path:"/departments",component:zc}),r.a.createElement(ya,{path:"/categories",component:mn}),r.a.createElement(ya,{path:"/subcategories",component:an}),r.a.createElement(ya,{path:"/brands",component:Fc}),r.a.createElement(ya,{path:"/models",component:hr}),r.a.createElement(ya,{path:"/orders",component:hl}),r.a.createElement(ya,{path:"/orders/view/:id",admin:P,component:Dl}),r.a.createElement(ya,{path:"/clients",component:yl}),[1,2].includes(null===P||void 0===P?void 0:P.roleNumber)&&r.a.createElement(r.a.Fragment,null,r.a.createElement(ya,{path:"/cheques",component:Dn}),r.a.createElement(ya,{path:"/expenses",component:Bn}),r.a.createElement(ya,{path:"/expenses/:id",component:nc}),r.a.createElement(ya,{path:"/orgs",component:Yl}),r.a.createElement(ya,{path:"/admins",component:Tl}),r.a.createElement(ya,{path:"/tasks",component:fc}),r.a.createElement(ya,{path:"/tasks/:id",component:gc}),r.a.createElement(ya,{path:"/print-everything",component:Nc}),r.a.createElement(ya,{path:"/wood-price-calculator",component:sc})),[3].includes(null===P||void 0===P?void 0:P.roleNumber)&&r.a.createElement(r.a.Fragment,null,r.a.createElement(ya,{exact:!0,path:"/wood-price-calculator",component:sc})),r.a.createElement(mr,{default:!0})))))))},Gc=(a(803),a(239)),Wc=function(){return r.a.createElement(ha.ToastProvider,null,r.a.createElement(n.Suspense,{fallback:r.a.createElement(Gc.a,null)},r.a.createElement(Jc,null)))};c.a.render(r.a.createElement(Wc,null),document.getElementById("root"))}},[[804,1,2]]]);
//# sourceMappingURL=main.74a10144.chunk.js.map